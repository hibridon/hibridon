#!/bin/csh -f 
# HIBRIDON bin/ftscript $Revision: 2004.1 $  
# ftscript machi [mach2] [mach3] [mach4]: to convert files for machine type {mach}
# convert all .f files to new machine, and then replaces original .f
# files with the converted files
@ items = $#argv
set basedir=`hibriddir`
touch $basedir/src/control.file
if ($items == 0) then
  echo "usage:  ftscript machi [mach2] [mach3] [mach4]"
  goto end
endif
if ($items > 4) then
  echo "usage:  ftscript machi [mach2] [mach3] [mach4]"
  goto end
endif
echo "../bin/ftconv_hib.exe << fin" > $basedir/src/control.file
echo $1 >> $basedir/src/control.file
if ($items == 1) then
  set name = $1
endif
if ($items == 2) then
  set name = $1
  set name1 = $2
  echo $2 >> $basedir/src/control.file
endif
if ($items == 3) then
  set name = $1
  set name1 = $2
  set name2 = $3
  echo $2 >> $basedir/src/control.file
  echo $3 >> $basedir/src/control.file
endif
if ($items == 4) then
  set name = $1
  set name1 = $2
  set name2 = $3
  set name3 = $4
  echo $2 >> $basedir/src/control.file
  echo $3 >> $basedir/src/control.file
  echo $4 >> $basedir/src/control.file
endif
echo '' >> $basedir/src/control.file
ls -1 hi*.f >>$basedir/src/control.file
echo '' >> $basedir/src/control.file
echo "fin" >> $basedir/src/control.file
chmod +x $basedir/src/control.file
$basedir/src/control.file 
echo ""
echo "all hi*.f files converted, copying back ..."
rm $basedir/src/control.file
set existfl = 1
ls -1 *.new > newlist
if (-z newlist) set existfl = 0
  while ($existfl != 0)
    set name = `head -1 newlist`
    mv $name $name:r.f
    sed 1,1d newlist > newcheck
    mv newcheck newlist
    if (-z newlist) set existfl = 0
  end
  rm newlist
end:
exit
