*  System:  O(3P) + H(2S)
*
*   calculation of potential energy curves and spin-orbit matrix
*   elements, taken from m. alexander's notes (2018)
*
*   MRCI+Q calculation with avqz basis (m.alexander, sep-2018)
*
*   two spin-orbit matrix parameters are included:  apar and aperp
*   the atomic spin-orbit splittings are computed from the large-R
*   values of these parameters.
*   here, the atomic values (apar = aperp) are used for all R
*  
*   written by p. dagdigian
*   current revision date:  4-sep-2018
*
      include "common/syusr"
      include "common/bausr"
      include "common/ground"
* --------------------------------------------------------------------------
      subroutine loapot(iunit,filnam)
* --------------------------------------------------------------------------
      character*(*) filnam
      common /coselb/ ibasty
      include "common/parbas"
      include "common/parpot"
      common /conlam/ nlam, nlammx, lamnum(1)
      potnam='O(3P)-H(2S) MHA 2018'
      npot=1
      ibasty=23
      lammin(1)=1
      lammax(1)=6
      mproj(1)=0
      ntv(1)=1
      ivcol(1,1)=0
      ivrow(1,1)=0
*  count number of anisotropic terms
      nlam = 0
      do il = lammin(1), lammax(1)
        nlam = nlam + 1
      enddo
      return
      end
* --------------------------------------------------------------------------
      subroutine driver
      implicit double precision (a-h,o-z)
      common /cosysi/ junk(5), npot
      common /covvl/ vvl(8)
      include "common/parpot"
      potnam='O(3P)-H(2S) MHA 2018'
      econv=219474.6d0
      print *, potnam
1     print *, 'R (bohr):'
      read (5, *, end=99) r
      if (r.le.0.d0) goto 99
      call pot(vv0,r)
      write (6, 100) (econv*vvl(i), i=1,6)
100   format('  ',6(1pe16.8))
      goto 1
99    rr= 1.075d0
      dr=0.2d0
      open (unit=12,file='oh_vlms_avqz_so_const.txt')
      write(12,109)
109   format(' %R/bohr X2Pi  4Pi  2Sig-  4Sig-  apar   aperp')
      do i=1,426
        call pot(vv0,rr)
        write (12,110) rr,(econv*vvl(j),j=1,6)
110     format(f11.5,6(1pe16.8))
        rr = rr + dr
      enddo
      close(12)
      end
* --------------------------------------------------------------------------
      subroutine pot (vv0, r)
*  subroutine to calculate the r-dependent coefficients
*  in atomic units (distance and energy)
* ----------------------------------------------------------------------
*  on entry:
*    r:      interparticle distance
*  on return:
*    vv0        (not used)
*    vvl(1,4)   contains the X2Pi, 4Pi, 2Sig-, 4Sig- energies
*    vvl(5,6)   contains the spin-orbit matrix parameters apar and aperp at R
*  variable in common block /conlam/ used here
*    nlam:      the number of angular coupling terms actually used
*  variable in common block /covvl/
*    vvl:       array to store r-dependence of each
*               angular term in the potential
*  variable in common block /coconv/
*    econv:     conversion factor from cm-1 to hartrees
* 
* author:  paul dagdigian
* latest revision date:  31-aug-2018
* ----------------------------------------------------------------------
      implicit double precision (a-h,o-z)
      include "common/parbas"
      common /covvl/ vvl(6)
      dimension rr(376),v2pi(376),v4pi(376),v2sigm(376),v4sigm(376)
      dimension vl(376), vec(376), v(6)
      data npts / 188 /
*
c  number of r values= 188
      data rr /
     +  0.945,  1.020,  1.096,  1.172,  1.247,
     +  1.323,  1.398,  1.474,  1.550,  1.625,
     +  1.701,  1.776,  1.852,  1.928,  2.003,
     +  2.079,  2.154,  2.230,  2.305,  2.381,
     +  2.457,  2.532,  2.608,  2.683,  2.759,
     +  2.835,  2.910,  2.986,  3.061,  3.137,
     +  3.213,  3.288,  3.364,  3.439,  3.515,
     +  3.590,  3.666,  3.742,  3.817,  3.893,
     +  3.968,  4.044,  4.120,  4.195,  4.271,
     +  4.346,  4.422,  4.498,  4.573,  4.649,
     +  4.724,  4.800,  4.875,  4.951,  5.027,
     +  5.102,  5.178,  5.253,  5.329,  5.405,
     +  5.480,  5.556,  5.631,  5.707,  5.783,
     +  5.858,  5.934,  6.009,  6.085,  6.161,
     +  6.236,  6.312,  6.387,  6.463,  6.538,
     +  6.614,  6.690,  6.765,  6.841,  6.916,
     +  6.992,  7.068,  7.143,  7.219,  7.294,
     +  7.370,  7.446,  7.521,  7.597,  7.672,
     +  7.748,  7.823,  7.899,  7.975,  8.050,
     +  8.126,  8.201,  8.277,  8.353,  8.428,
     +  8.504,  8.579,  8.655,  8.731,  8.806,
     +  8.882,  8.957,  9.033,  9.108,  9.184,
     +  9.260,  9.335,  9.411,  9.486,  9.562,
     +  9.638,  9.713,  9.789,  9.864,  9.940,
     + 10.016, 10.091, 10.167, 10.242, 10.318,
     + 10.393, 10.469, 10.545, 10.620, 10.696,
     + 10.771, 10.847, 10.923, 10.998, 11.074,
     + 11.149, 11.225, 11.301, 11.376, 11.452,
     + 11.527, 11.603, 11.679, 11.754, 11.830,
     + 11.905, 11.981, 12.056, 12.132, 12.208,
     + 12.283, 12.359, 12.434, 12.510, 12.586,
     + 12.661, 12.737, 12.812, 12.888, 12.964,
     + 13.039, 13.115, 13.190, 13.266, 13.341,
     + 13.417, 13.493, 13.568, 13.644, 13.719,
     + 13.795, 13.871, 13.946, 14.022, 14.097,
     + 14.173, 14.249, 14.324, 14.400, 14.475,
     + 14.551, 14.626, 14.702, 14.778, 14.853,
     + 14.929, 15.004, 15.080  /
c  X2Pi
      data v2pi /
     +  1.3282471e+05,  8.5315619e+04,  5.0726532e+04,  2.5089200e+04,
     +  5.7822807e+03, -8.4686667e+03, -1.8807602e+04, -2.6090811e+04,
     + -3.1093476e+04, -3.4379579e+04, -3.6301902e+04, -3.7183738e+04,
     + -3.7267161e+04, -3.6771410e+04, -3.5857569e+04, -3.4628566e+04,
     + -3.3177365e+04, -3.1567193e+04, -2.9853339e+04, -2.8079524e+04,
     + -2.6277900e+04, -2.4478061e+04, -2.2700922e+04, -2.0963426e+04,
     + -1.9279543e+04, -1.7659890e+04, -1.6112899e+04, -1.4644961e+04,
     + -1.3260799e+04, -1.1963618e+04, -1.0755357e+04, -9.6368026e+03,
     + -8.6070954e+03, -7.6649357e+03, -6.8078610e+03, -6.0322462e+03,
     + -5.3341738e+03, -4.7087597e+03, -4.1508713e+03, -3.6552208e+03,
     + -3.2163651e+03, -2.8288880e+03, -2.4875069e+03, -2.1870051e+03,
     + -1.9229158e+03, -1.6915215e+03, -1.4891376e+03, -1.3120792e+03,
     + -1.1566978e+03, -1.0201792e+03, -9.0054308e+02, -7.9584550e+02,
     + -7.0414251e+02, -6.2351012e+02, -5.5248327e+02, -4.9005582e+02,
     + -4.3524158e+02, -3.8705436e+02, -3.4451826e+02, -3.0689404e+02,
     + -2.7367907e+02, -2.4438101e+02, -2.1850754e+02, -1.9557133e+02,
     + -1.7519988e+02, -1.5713554e+02, -1.4112568e+02, -1.2691764e+02,
     + -1.1426136e+02, -1.0296633e+02, -9.2901569e+01, -8.3938694e+01,
     + -7.5949317e+01, -6.8806200e+01, -6.2408489e+01, -5.6681711e+01,
     + -5.1552542e+01, -4.6947657e+01, -4.2794659e+01, -3.9042441e+01,
     + -3.5661190e+01, -3.2622020e+01, -2.9896043e+01, -2.7454373e+01,
     + -2.5268121e+01, -2.3308402e+01, -2.1546328e+01, -1.9953013e+01,
     + -1.8499997e+01, -1.7168700e+01, -1.5950415e+01, -1.4836865e+01,
     + -1.3819772e+01, -1.2890861e+01, -1.2041853e+01, -1.1264471e+01,
     + -1.0550440e+01, -9.8914804e+00, -9.2794378e+00, -8.7089479e+00,
     + -8.1774381e+00, -7.6824572e+00, -7.2215538e+00, -6.7922769e+00,
     + -6.3921753e+00, -6.0187976e+00, -5.6696927e+00, -5.3424094e+00,
     + -5.0345322e+00, -4.7444687e+00, -4.4714496e+00, -4.2147411e+00,
     + -3.9736095e+00, -3.7473213e+00, -3.5351429e+00, -3.3363405e+00,
     + -3.1501805e+00, -2.9759292e+00, -2.8128531e+00, -2.6602185e+00,
     + -2.5172917e+00, -2.3833390e+00, -2.2576270e+00, -2.1394218e+00,
     + -2.0279898e+00, -1.9225975e+00, -1.8225992e+00, -1.7277017e+00,
     + -1.6376999e+00, -1.5523887e+00, -1.4715629e+00, -1.3950173e+00,
     + -1.3225469e+00, -1.2539465e+00, -1.1890109e+00, -1.1275351e+00,
     + -1.0693139e+00, -1.0141421e+00, -9.6181636e-01, -9.1217124e-01,
     + -8.6507957e-01, -8.2041583e-01, -7.7805449e-01, -7.3787002e-01,
     + -6.9973688e-01, -6.6352954e-01, -6.2912248e-01, -5.9639015e-01,
     + -5.6520704e-01, -5.3544761e-01, -5.0698633e-01, -4.7971173e-01,
     + -4.5356861e-01, -4.2851585e-01, -4.0451232e-01, -3.8151689e-01,
     + -3.5948842e-01, -3.3838578e-01, -3.1816785e-01, -2.9879349e-01,
     + -2.8022158e-01, -2.6241098e-01, -2.4532056e-01, -2.2890964e-01,
     + -2.1314759e-01, -1.9801390e-01, -1.8348846e-01, -1.6955119e-01,
     + -1.5618200e-01, -1.4336079e-01, -1.3106748e-01, -1.1928197e-01,
     + -1.0798417e-01, -9.7153984e-02, -8.6771330e-02, -7.6816112e-02,
     + -6.7268238e-02, -5.8107618e-02, -4.9314160e-02, -4.0867773e-02,
     + -3.2748365e-02, -2.4935844e-02, -1.7410120e-02, -1.0151101e-02,
     + -3.1386950e-03,  3.6471887e-03,  1.0226642e-02,  1.6619756e-02 /
c  4Pi
      data v4pi /
     +  2.4957403e+05,  2.0065375e+05,  1.6463332e+05,  1.3749883e+05,
     +  1.1658696e+05,  1.0058499e+05,  8.8308885e+04,  7.8854409e+04,
     +  7.1395721e+04,  6.5300715e+04,  6.0131025e+04,  5.5503538e+04,
     +  5.1222456e+04,  4.7142387e+04,  4.3200177e+04,  3.9414908e+04,
     +  3.5809222e+04,  3.2405697e+04,  2.9226422e+04,  2.6282622e+04,
     +  2.3574658e+04,  2.1100501e+04,  1.8850316e+04,  1.6811773e+04,
     +  1.4971241e+04,  1.3313924e+04,  1.1825051e+04,  1.0490148e+04,
     +  9.2953562e+03,  8.2276292e+03,  7.2747270e+03,  6.4252576e+03,
     +  5.6691421e+03,  4.9966599e+03,  4.3991182e+03,  3.8688522e+03,
     +  3.3985265e+03,  2.9819467e+03,  2.6132334e+03,  2.2871909e+03,
     +  1.9993083e+03,  1.7452519e+03,  1.5212806e+03,  1.3238286e+03,
     +  1.1499516e+03,  9.9732720e+02,  8.6365990e+02,  7.4665434e+02,
     +  6.4403723e+02,  5.5404417e+02,  4.7541959e+02,  4.0693008e+02,
     +  3.4734222e+02,  2.9543398e+02,  2.5024571e+02,  2.1108011e+02,
     +  1.7725130e+02,  1.4807340e+02,  1.2286725e+02,  1.0110904e+02,
     +  8.2430236e+01,  6.6469065e+01,  5.2863753e+01,  4.1256144e+01,
     +  3.1371279e+01,  2.3017395e+01,  1.6006345e+01,  1.0149984e+01,
     +  5.2621032e+00,  1.2010596e+00, -2.1302257e+00, -4.8268942e+00,
     + -6.9840871e+00, -8.6960118e+00, -1.0035395e+01, -1.1053484e+01,
     + -1.1800591e+01, -1.2327030e+01, -1.2682365e+01, -1.2898998e+01,
     + -1.2992159e+01, -1.2976334e+01, -1.2866009e+01, -1.2675669e+01,
     + -1.2419799e+01, -1.2112886e+01, -1.1769414e+01, -1.1403870e+01,
     + -1.1030453e+01, -1.0656813e+01, -1.0284048e+01, -9.9129694e+00,
     + -9.5443909e+00, -9.1791250e+00, -8.8179842e+00, -8.4617814e+00,
     + -8.1113290e+00, -7.7674400e+00, -7.4309171e+00, -7.1023388e+00,
     + -6.7820589e+00, -6.4704213e+00, -6.1677703e+00, -5.8744499e+00,
     + -5.5908040e+00, -5.3171768e+00, -5.0539124e+00, -4.8013547e+00,
     + -4.5598335e+00, -4.3293460e+00, -4.1095571e+00, -3.9001176e+00,
     + -3.7006779e+00, -3.5108886e+00, -3.3304002e+00, -3.1588633e+00,
     + -2.9959285e+00, -2.8412463e+00, -2.6944673e+00, -2.5552420e+00,
     + -2.4232210e+00, -2.2980549e+00, -2.1793941e+00, -2.0668893e+00,
     + -1.9601911e+00, -1.8589499e+00, -1.7628396e+00, -1.6716275e+00,
     + -1.5851038e+00, -1.5030592e+00, -1.4252841e+00, -1.3515689e+00,
     + -1.2817041e+00, -1.2154801e+00, -1.1526874e+00, -1.0931165e+00,
     + -1.0365578e+00, -9.8280175e-01, -9.3164123e-01, -8.8292346e-01,
     + -8.3655012e-01, -7.9242525e-01, -7.5045290e-01, -7.1053709e-01,
     + -6.7258188e-01, -6.3649130e-01, -6.0216940e-01, -5.6952022e-01,
     + -5.3844779e-01, -5.0885616e-01, -4.8064937e-01, -4.5373848e-01,
     + -4.2806259e-01, -4.0356782e-01, -3.8020029e-01, -3.5790612e-01,
     + -3.3663142e-01, -3.1632233e-01, -2.9692495e-01, -2.7838542e-01,
     + -2.6064983e-01, -2.4366433e-01, -2.2737502e-01, -2.1172875e-01,
     + -1.9668915e-01, -1.8223658e-01, -1.6835217e-01, -1.5501701e-01,
     + -1.4221223e-01, -1.2991893e-01, -1.1811821e-01, -1.0679120e-01,
     + -9.5919005e-02, -8.5482728e-02, -7.5463483e-02, -6.5842379e-02,
     + -5.6600528e-02, -4.7719039e-02, -3.9179022e-02, -3.0961588e-02,
     + -2.3047847e-02, -1.5418909e-02, -8.0558837e-03, -9.3988164e-04,
     +  5.9479870e-03,  1.2626612e-02,  1.9114883e-02,  2.5431691e-02 /
c  2Sigma-
      data v2sigm /
     +  2.1292822e+05,  1.6443970e+05,  1.2888441e+05,  1.0226979e+05,
     +  8.1956094e+04,  6.6656424e+04,  5.5213433e+04,  4.6752700e+04,
     +  4.0479490e+04,  3.5804912e+04,  3.2345921e+04,  2.9748825e+04,
     +  2.7741549e+04,  2.6075759e+04,  2.4579902e+04,  2.3159210e+04,
     +  2.1739250e+04,  2.0313587e+04,  1.8892942e+04,  1.7491557e+04,
     +  1.6127202e+04,  1.4816548e+04,  1.3570604e+04,  1.2396430e+04,
     +  1.1298073e+04,  1.0276442e+04,  9.3305870e+03,  8.4583305e+03,
     +  7.6562373e+03,  6.9204797e+03,  6.2471843e+03,  5.6321712e+03,
     +  5.0713622e+03,  4.5607233e+03,  4.0964335e+03,  3.6748849e+03,
     +  3.2925690e+03,  2.9463385e+03,  2.6331472e+03,  2.3502026e+03,
     +  2.0949663e+03,  1.8649670e+03,  1.6579595e+03,  1.4717678e+03,
     +  1.3045136e+03,  1.1546164e+03,  1.0205083e+03,  9.0062168e+02,
     +  7.9340125e+02,  6.9757785e+02,  6.1216843e+02,  5.3620239e+02,
     +  4.6870912e+02,  4.0872583e+02,  3.5546921e+02,  3.0833547e+02,
     +  2.6672864e+02,  2.3005271e+02,  1.9771658e+02,  1.6924097e+02,
     +  1.4425848e+02,  1.2240657e+02,  1.0332270e+02,  8.6647613e+01,
     +  7.2097632e+01,  5.9464654e+01,  4.8543863e+01,  3.9130444e+01,
     +  3.1021356e+01,  2.4054413e+01,  1.8108283e+01,  1.3063409e+01,
     +  8.8002347e+00,  5.2002673e+00,  2.1694737e+00, -3.6171917e-01,
     + -2.4618208e+00, -4.1993407e+00, -5.6418194e+00, -6.8345089e+00,
     + -7.8003731e+00, -8.5614064e+00, -9.1396037e+00, -9.5569594e+00,
     + -9.8354684e+00, -9.9971252e+00, -1.0063924e+01, -1.0057861e+01,
     + -1.0000541e+01, -9.9046470e+00, -9.7739370e+00, -9.6117807e+00,
     + -9.4215479e+00, -9.2066086e+00, -8.9703325e+00, -8.7160895e+00,
     + -8.4472494e+00, -8.1671821e+00, -7.8792293e+00, -7.5860841e+00,
     + -7.2897915e+00, -6.9923679e+00, -6.6958300e+00, -6.4021945e+00,
     + -6.1134779e+00, -5.8316969e+00, -5.5588681e+00, -5.2970081e+00,
     + -5.0480767e+00, -4.8127282e+00, -4.5903111e+00, -4.3801172e+00,
     + -4.1814383e+00, -3.9935661e+00, -3.8157925e+00, -3.6474092e+00,
     + -3.4877079e+00, -3.3359806e+00, -3.1915190e+00, -3.0536148e+00,
     + -2.9215598e+00, -2.7946459e+00, -2.6721647e+00, -2.5534082e+00,
     + -2.4376680e+00, -2.3242360e+00, -2.2125724e+00, -2.1028112e+00,
     + -1.9952548e+00, -1.8902059e+00, -1.7879667e+00, -1.6888399e+00,
     + -1.5931279e+00, -1.5011331e+00, -1.4131581e+00, -1.3295053e+00,
     + -1.2504772e+00, -1.1763762e+00, -1.1074911e+00, -1.0437937e+00,
     + -9.8493895e-01, -9.3056809e-01, -8.8032230e-01, -8.3384279e-01,
     + -7.9077074e-01, -7.5074736e-01, -7.1341384e-01, -6.7841140e-01,
     + -6.4538121e-01, -6.1396449e-01, -5.8380244e-01, -5.5459605e-01,
     + -5.2628555e-01, -4.9887097e-01, -4.7235235e-01, -4.4672970e-01,
     + -4.2200307e-01, -3.9817247e-01, -3.7523794e-01, -3.5319952e-01,
     + -3.3205722e-01, -3.1181108e-01, -2.9246113e-01, -2.7400658e-01,
     + -2.5642790e-01, -2.3968678e-01, -2.2374411e-01, -2.0856079e-01,
     + -1.9409770e-01, -1.8031574e-01, -1.6717579e-01, -1.5463873e-01,
     + -1.4266547e-01, -1.3121688e-01, -1.2025386e-01, -1.0973730e-01,
     + -9.9628081e-02, -8.9887096e-02, -8.0475234e-02, -7.1353384e-02,
     + -6.2482434e-02, -5.3823275e-02, -4.5336793e-02, -3.6983879e-02,
     + -2.8725422e-02, -2.0522310e-02, -1.2335432e-02, -4.1256781e-03 /
c  4Sigma-
      data v4sigm /
     +  2.1064061e+05,  1.6213467e+05,  1.2655126e+05,  9.9894055e+04,
     +  7.9518693e+04,  6.4132813e+04,  5.2573255e+04,  4.3958537e+04,
     +  3.7486542e+04,  3.2560777e+04,  2.8790375e+04,  2.5820640e+04,
     +  2.3405794e+04,  2.1330601e+04,  1.9456003e+04,  1.7719122e+04,
     +  1.6072006e+04,  1.4513172e+04,  1.3052602e+04,  1.1696795e+04,
     +  1.0448762e+04,  9.3104088e+03,  8.2794412e+03,  7.3510897e+03,
     +  6.5191418e+03,  5.7761523e+03,  5.1143188e+03,  4.5258282e+03,
     +  4.0031457e+03,  3.5392213e+03,  3.1275262e+03,  2.7620938e+03,
     +  2.4378319e+03,  2.1498859e+03,  1.8940578e+03,  1.6668064e+03,
     +  1.4647808e+03,  1.2852764e+03,  1.1257654e+03,  9.8406030e+02,
     +  8.5831468e+02,  7.4676144e+02,  6.4789217e+02,  5.6027389e+02,
     +  4.8272181e+02,  4.1429926e+02,  3.5408038e+02,  3.0113932e+02,
     +  2.5455865e+02,  2.1361537e+02,  1.7778089e+02,  1.4653504e+02,
     +  1.1935768e+02,  9.5733130e+01,  7.5248583e+01,  5.7594111e+01,
     +  4.2464256e+01,  2.9553560e+01,  1.8559340e+01,  9.2427205e+00,
     +  1.4286331e+00, -5.0552158e+00, -1.0381120e+01, -1.4719802e+01,
     + -1.8205846e+01, -2.0937700e+01, -2.3012241e+01, -2.4526344e+01,
     + -2.5575969e+01, -2.6236007e+01, -2.6560278e+01, -2.6601687e+01,
     + -2.6413138e+01, -2.6047001e+01, -2.5543354e+01, -2.4929979e+01,
     + -2.4234127e+01, -2.3483047e+01, -2.2703512e+01, -2.1911323e+01,
     + -2.1111316e+01, -2.0307846e+01, -1.9505270e+01, -1.8707945e+01,
     + -1.7920227e+01, -1.7146473e+01, -1.6391039e+01, -1.5658282e+01,
     + -1.4952442e+01, -1.4275063e+01, -1.3624997e+01, -1.3000977e+01,
     + -1.2401737e+01, -1.1826011e+01, -1.1272532e+01, -1.0740035e+01,
     + -1.0227253e+01, -9.7329202e+00, -9.2557975e+00, -8.7952767e+00,
     + -8.3513804e+00, -7.9241584e+00, -7.5136607e+00, -7.1199370e+00,
     + -6.7430372e+00, -6.3830113e+00, -6.0399091e+00, -5.7137805e+00,
     + -5.4046605e+00, -5.1122440e+00, -4.8358854e+00, -4.5749242e+00,
     + -4.3287002e+00, -4.0965530e+00, -3.8778223e+00, -3.6718477e+00,
     + -3.4779688e+00, -3.2955253e+00, -3.1238569e+00, -2.9623031e+00,
     + -2.8102037e+00, -2.6668982e+00, -2.5317264e+00, -2.4040278e+00,
     + -2.2831421e+00, -2.1684090e+00, -2.0592442e+00, -1.9553671e+00,
     + -1.8565734e+00, -1.7626587e+00, -1.6734186e+00, -1.5886487e+00,
     + -1.5081446e+00, -1.4317019e+00, -1.3591162e+00, -1.2901831e+00,
     + -1.2246981e+00, -1.1624570e+00, -1.1032567e+00, -1.0469297e+00,
     + -9.9334342e-01, -9.4236695e-01, -8.9386932e-01, -8.4771960e-01,
     + -8.0378683e-01, -7.6194006e-01, -7.2204834e-01, -6.8398072e-01,
     + -6.4760624e-01, -6.1279397e-01, -5.7941295e-01, -5.4734956e-01,
     + -5.1655953e-01, -4.8701595e-01, -4.5869188e-01, -4.3156039e-01,
     + -4.0559455e-01, -3.8076743e-01, -3.5705210e-01, -3.3442164e-01,
     + -3.1284911e-01, -2.9230759e-01, -2.7277013e-01, -2.5420946e-01,
     + -2.3658985e-01, -2.1986716e-01, -2.0399688e-01, -1.8893450e-01,
     + -1.7463553e-01, -1.6105545e-01, -1.4814976e-01, -1.3587394e-01,
     + -1.2418350e-01, -1.1303392e-01, -1.0238070e-01, -9.2179333e-02,
     + -8.2385311e-02, -7.2954126e-02, -6.3841272e-02, -5.5002243e-02,
     + -4.6392531e-02, -3.7967630e-02, -2.9683032e-02, -2.1494232e-02,
     + -1.3356722e-02, -5.2259947e-03,  2.9424557e-03,  1.1193137e-02 /
*
*  set vv0 term to zero
      vv0 = 0.d0
*
*  spline fits
      if (ifirst .eq. 0) then
*  spline fit of the coefficients for the PE curves
*  evaluate derivative at first point
        der1=(v2pi(2)-v2pi(1))/(rr(2)-rr(1))
        call dspline(rr,v2pi,npts,der1,0d0,cs2p)
*
        der1=(v4pi(2)-v4pi(1))/(rr(2)-rr(1))
        call dspline(rr,v4pi,npts,der1,0d0,cs4p)
*
        der1=(v2sigm(2)-v2sigm(1))/(rr(2)-rr(1))
        call dspline(rr,v2sigm,npts,der1,0d0,cs2s)
*
        der1=(v4sigm(2)-v4sigm(1))/(rr(2)-rr(1))
        call dspline(rr,v4sigm,npts,der1,0d0,cs4s)
        ifirst = 1
      endif
*
*  determine splined coefficients for PE curves at r=R
      call dsplint(rr,v2pi,cs2p,npts,r,vvx)
      v(1) = vvx
*  fix long-range behavior of PE curve as c6/r^6 from last point
      if (r.gt.rr(npts)) then
        c6 = v2pi(npts) * rr(npts)**6
        v(1) = c6 / r**6
      endif
*
      call dsplint(rr,v4pi,cs4p,npts,r,vvx)
      v(2) = vvx
*  fix long-range behavior of PE curve as c6/r^6 from last point
      if (r.gt.rr(npts)) then
        c6 = v4pi(npts) * rr(npts)**6
        v(2) = c6 / r**6
      endif
*
      call dsplint(rr,v2sigm,cs2s,npts,r,vvx)
      v(3) = vvx
*  fix long-range behavior of PE curve as c6/r^6 from last point
      if (r.gt.rr(npts)) then
        c6 = v2sigm(npts) * rr(npts)**6
        v(3) = c6 / r**6
      endif
*
      call dsplint(rr,v4sigm,cs4s,npts,r,vvx)
      v(4) = vvx
*  fix long-range behavior of PE curve as c6/r^6 from last point
      if (r.gt.rr(npts)) then
        c6 = v4sigm(npts) * rr(npts)**6
        v(4) = c6 / r**6
      endif
*
*  IN THIS VERSION, SET SPIN-ORBIT MATRIX ELEMENTS TO THEIR
*  ASYMPTOTIC VALUES AT ALL R
      a = 151.686d0;
      apar = a / 2.0d0
      aperp = a / 2.0d0
      v(5) = apar
      v(6) = aperp
*
      call dcopy(6,v,1,vvl,1)
* convert to hartree
      econv=1.d0/219474.6d0
      call dscal(6,econv,vvl,1)
      return
      end
*===================================eof====================================
