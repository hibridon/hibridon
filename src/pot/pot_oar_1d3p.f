cstart unix-ifort
cdec$ fixedformlinesize:132
cend

*  System:  O(1D,3P) + Ar
*  Theory  Level: MRCISD+Q(Davidson) aug-cc-pvqz-DK BSSE and SC corrected
*   Scalar relativistic effects included by using all-electron
*   Douglas-Kroll Hamiltonian and integrals
*   calculation of potential energy curves and spin-orbit matrix
*   elements by j.klos 
*
*   written by p. dagdigian
*   adapted to O-Ar by j. klos
*   current revision date:  8-oct-2015 by pjd
      include "common/syusr"
      include "common/bausr"
      include "common/ground"
* --------------------------------------------------------------------------
      subroutine loapot(iunit,filnam)
* --------------------------------------------------------------------------
      character*(*) filnam
      common /coselb/ ibasty
      include "common/parbas"
      include "common/parpot"
      potnam='O(1D,3P)-Ar MRCISD+Q'
      ibasty=22
      lammin(1)=1
      lammax(1)=12
      mproj(1)=0
      ntv(1)=1
      ivcol(1,1)=0
      ivrow(1,1)=0
      return
      end
* --------------------------------------------------------------------------
      subroutine driver
      implicit double precision (a-h,o-z)
      common /cosysi/ junk(5), npot
      common /cosysr/ isrcod, junkr, en(4)
      common /covvl/ vvl(19)
      include "common/parpot"
      potnam='O(1D,3P)-Ar MRCISD+Q'
      econv=219474.6d0
      print *, potnam
1     print *, 'R (bohr):'
      read (5, *, end=99) r
      if (r.le.0.d0) goto 99
      call pot(vv0,r)
      write (6, 100) (econv*vvl(i), i=1,19)
100   format('  ',6(1pe16.8)/'  ',6(1pe16.8)/
     +  '  ',7(1pe16.8))
      goto 1
99    rr=2.6d0
      dr=0.25d0
      open (unit=12,file='oar_vlms.txt')
      write(12,109)
109   format(' R/bohr 1Sig  1Pi  1Del  3Sig  3Pi  Axy   Azy',
     :  '  Bss  Byx  Bxs  Bsy  Bxd  Axy(R=inf)   Azy(R=inf)',
     :  '  Bss(R=inf)  Byx(R=inf)  Bxs(R=inf)  Bsy(R=inf)',
     :  '  Bxd(R=inf)')
      do i=1,201
        call pot(vv0,rr)
        write (12,110) rr,(econv*vvl(j),j=1,19)
110     format(f7.2,19(1pe16.8))
        rr = rr + dr
      enddo
      close(12)
      end
* --------------------------------------------------------------------------
      subroutine pot (vv0, r)
*  subroutine to calculate the r-dependent coefficients
*  in atomic units (distance and energy)
* ----------------------------------------------------------------------
*  on entry:
*    r:      interparticle distance
*  on return:
*    vv0        (not used)
*    vvl(1,3)   contains the 1Sigma+, 1Pi, 1Delta energies
*    vvl(4,5)   contains the 3Sigma- and 3Pi PE energies
*    vvl(6,7)   contains Axy and Axz, the spin-orbit matrix elements
*               within the 3P state
*    vvl(8,12)  contains Bss, Byx, Bxs, Bsy, and Bxd, the spin-orbit
*               matrix elements coupling the 1D and 3P states
*    vvl(13,19) values of the Axy, Azy, Bss, Byx, Bxs, Bsy, and Bxd
*               matrix elements at R=inf
**  variable in common block /conlam/ used here
*    nlam:    the number of angular coupling terms actually used
*  variable in common block /covvl/
*    vvl:     array to store r-dependence of each
*             angular term in the potential
*  variable in common block /coconv/
*    econv:     conversion factor from cm-1 to hartrees
*  variables in common /cosysr/
*    isrcod:    number of real parameters
*    en1d:      asymptotic energy of the 1D state (cm-1)
* 
* author:  paul dagdigian
* latest revision date:  8-oct-2015
* ----------------------------------------------------------------------
      implicit double precision (a-h,o-z)
      include "common/parbas"
      common /covvl/ vvl(19)

      dimension rr(85),vl(425),rso(22),somat(154)
      dimension csplel(85,5),csplso(22,12),vecel(85),vecso(22)
      dimension v(19)
*
*  values or R for PE curves
      data rr /
     +  2.600,  2.700,  2.800,  2.900,  3.000,
     +  3.100,  3.200,  3.300,  3.400,  3.500,
     +  3.600,  3.700,  3.800,  3.900,  4.000,
     +  4.100,  4.200,  4.300,  4.400,  4.500,
     +  4.600,  4.700,  4.800,  5.000,  5.100,
     +  5.200,  5.300,  5.400,  5.500,  5.600,
     +  5.700,  5.800,  5.900,  6.000,  6.100,
     +  6.200,  6.300,  6.400,  6.500,  6.600,
     +  6.700,  6.800,  6.900,  7.000,  7.100,
     +  7.200,  7.300,  7.400,  7.500,  7.600,
     +  7.700,  7.800,  7.900,  8.000,  8.250,
     +  8.500,  8.750,  9.000,  9.250,  9.500,
     +  9.750, 10.000, 10.250, 10.500, 10.750,
     + 11.000, 11.250, 11.500, 11.750, 12.000,
     + 12.500, 13.000, 13.500, 14.000, 15.000,
     + 16.000, 17.000, 18.000, 19.000, 20.000,
     + 22.000, 24.000, 26.000, 28.000, 30.000 /
*  values of the 5 PE curves
      data vl /  
C       1Sigma
     +  3.1997364e+04, 2.6663707e+04, 2.2871754e+04, 2.0206518e+04, 1.8374346e+04,
     +  1.7165885e+04, 1.6424468e+04, 1.6026215e+04, 1.5869220e+04, 1.5868620e+04,
     +  1.5955111e+04, 1.6075074e+04, 1.6190752e+04, 1.6279433e+04, 1.6331236e+04,
     +  1.6345812e+04, 1.6328725e+04, 1.6288238e+04, 1.6232980e+04, 1.6170549e+04,
     +  1.6106894e+04, 1.6046221e+04, 1.5991189e+04, 1.5902818e+04, 1.5869875e+04,
     +  1.5843887e+04, 1.5824133e+04, 1.5809794e+04, 1.5800042e+04, 1.5794085e+04,
     +  1.5791197e+04, 1.5790734e+04, 1.5792141e+04, 1.5794945e+04, 1.5798755e+04,
     +  1.5803252e+04, 1.5808184e+04, 1.5813351e+04, 1.5818605e+04, 1.5823833e+04,
     +  1.5828958e+04, 1.5833924e+04, 1.5838697e+04, 1.5843254e+04, 1.5847585e+04,
     +  1.5851684e+04, 1.5855553e+04, 1.5859193e+04, 1.5862610e+04, 1.5865808e+04,
     +  1.5868796e+04, 1.5871581e+04, 1.5874170e+04, 1.5876571e+04, 1.5881815e+04,
     +  1.5886093e+04, 1.5889561e+04, 1.5892365e+04, 1.5894637e+04, 1.5896488e+04,
     +  1.5898005e+04, 1.5899260e+04, 1.5900341e+04, 1.5901233e+04, 1.5901980e+04,
     +  1.5902607e+04, 1.5903136e+04, 1.5903584e+04, 1.5903965e+04, 1.5904290e+04,
     +  1.5904808e+04, 1.5905194e+04, 1.5905485e+04, 1.5905707e+04, 1.5906036e+04,
     +  1.5906239e+04, 1.5906368e+04, 1.5906452e+04, 1.5906508e+04, 1.5906547e+04,
     +  1.5906593e+04, 1.5906617e+04, 1.5906630e+04, 1.5906638e+04, 1.5906641e+04,
C      1Pi  
     +  7.5588884e+04, 6.6965482e+04, 5.9424930e+04, 5.2803896e+04, 4.7024473e+04,
     +  4.2029635e+04, 3.7755913e+04, 3.4129505e+04, 3.1071306e+04, 2.8503091e+04,
     +  2.6352052e+04, 2.4553251e+04, 2.3050416e+04, 2.1795684e+04, 2.0748781e+04,
     +  1.9876003e+04, 1.9149186e+04, 1.8544775e+04, 1.8043040e+04, 1.7627410e+04,
     +  1.7283949e+04, 1.7000915e+04, 1.6768407e+04, 1.6422885e+04, 1.6296900e+04,
     +  1.6195132e+04, 1.6113388e+04, 1.6048151e+04, 1.5996477e+04, 1.5955908e+04,
     +  1.5924396e+04, 1.5900239e+04, 1.5882029e+04, 1.5868602e+04, 1.5858999e+04,
     +  1.5852433e+04, 1.5848263e+04, 1.5845962e+04, 1.5845107e+04, 1.5845354e+04,
     +  1.5846426e+04, 1.5848102e+04, 1.5850206e+04, 1.5852599e+04, 1.5855172e+04,
     +  1.5857840e+04, 1.5860539e+04, 1.5863219e+04, 1.5865844e+04, 1.5868388e+04,
     +  1.5870831e+04, 1.5873163e+04, 1.5875375e+04, 1.5877465e+04, 1.5882153e+04,
     +  1.5886115e+04, 1.5889428e+04, 1.5892182e+04, 1.5894464e+04, 1.5896354e+04,
     +  1.5897922e+04, 1.5899223e+04, 1.5900306e+04, 1.5901211e+04, 1.5901970e+04,
     +  1.5902608e+04, 1.5903146e+04, 1.5903602e+04, 1.5903990e+04, 1.5904321e+04,
     +  1.5904849e+04, 1.5905242e+04, 1.5905538e+04, 1.5905763e+04, 1.5906072e+04,
     +  1.5906261e+04, 1.5906382e+04, 1.5906462e+04, 1.5906515e+04, 1.5906551e+04,
     +  1.5906595e+04, 1.5906618e+04, 1.5906630e+04, 1.5906638e+04, 1.5906641e+04,
C      1Delta 
     +  1.2868347e+05, 1.1683590e+05, 1.0548510e+05, 9.4656236e+04, 8.4489492e+04,
     +  7.5132925e+04, 6.6683733e+04, 5.9175845e+04, 5.2590758e+04, 4.6874507e+04,
     +  4.1952975e+04, 3.7743299e+04, 3.4161488e+04, 3.1127088e+04, 2.8565755e+04,
     +  2.6410444e+04, 2.4601718e+04, 2.3087543e+04, 2.1822787e+04, 2.0768581e+04,
     +  1.9891642e+04, 1.9163590e+04, 1.8560323e+04, 1.7649680e+04, 1.7310552e+04,
     +  1.7031843e+04, 1.6803315e+04, 1.6616396e+04, 1.6463919e+04, 1.6339904e+04,
     +  1.6239367e+04, 1.6158162e+04, 1.6092845e+04, 1.6040558e+04, 1.5998933e+04,
     +  1.5966014e+04, 1.5940184e+04, 1.5920108e+04, 1.5904690e+04, 1.5893027e+04,
     +  1.5884379e+04, 1.5878140e+04, 1.5873816e+04, 1.5871003e+04, 1.5869373e+04,
     +  1.5868660e+04, 1.5868651e+04, 1.5869171e+04, 1.5870082e+04, 1.5871275e+04,
     +  1.5872661e+04, 1.5874173e+04, 1.5875756e+04, 1.5877369e+04, 1.5881345e+04,
     +  1.5885025e+04, 1.5888286e+04, 1.5891101e+04, 1.5893492e+04, 1.5895506e+04,
     +  1.5897194e+04, 1.5898604e+04, 1.5899784e+04, 1.5900771e+04, 1.5901599e+04,
     +  1.5902294e+04, 1.5902881e+04, 1.5903377e+04, 1.5903799e+04, 1.5904157e+04,
     +  1.5904727e+04, 1.5905149e+04, 1.5905466e+04, 1.5905707e+04, 1.5906036e+04,
     +  1.5906239e+04, 1.5906367e+04, 1.5906452e+04, 1.5906508e+04, 1.5906547e+04,
     +  1.5906593e+04, 1.5906617e+04, 1.5906630e+04, 1.5906637e+04, 1.5906641e+04,
C     3Sigma 
     +  1.1920974e+05, 1.0660538e+05, 9.4381304e+04, 8.2678437e+04, 7.1728982e+04,
     +  6.1721234e+04, 5.2753491e+04, 4.4842159e+04, 3.7946248e+04, 3.1990790e+04,
     +  2.6884311e+04, 2.2530434e+04, 1.8834968e+04, 1.5709886e+04, 1.3075264e+04,
     +  1.0859953e+04, 9.0015016e+03, 7.4456471e+03, 6.1456019e+03, 5.0612593e+03,
     +  4.1583958e+03, 3.4079159e+03, 2.7851580e+03, 1.8426724e+03, 1.4905505e+03,
     +  1.2004639e+03, 9.6197323e+02, 7.6633326e+02, 6.0622903e+02, 4.7555016e+02,
     +  3.6919990e+02, 2.8293044e+02, 2.1320867e+02, 1.5709796e+02, 1.1216094e+02,
     +  7.6377140e+01, 4.8073891e+01, 2.5868337e+01, 8.6188730e+00,-4.6156370e+00,
     + -1.4609540e+01,-2.1999077e+01,-2.7305872e+01,-3.0956690e+01,-3.3299834e+01,
     + -3.4618809e+01,-3.5143670e+01,-3.5060487e+01,-3.4519108e+01,-3.3639701e+01,
     + -3.2518113e+01,-3.1230333e+01,-2.9836162e+01,-2.8382255e+01,-2.4701749e+01,
     + -2.1210044e+01,-1.8068454e+01,-1.5326514e+01,-1.2978642e+01,-1.0990828e+01,
     + -9.3192680e+00,-7.9188930e+00,-6.7475920e+00,-5.7679580e+00,-4.9477280e+00,
     + -4.2599690e+00,-3.6811320e+00,-3.1927050e+00,-2.7791460e+00,-2.4277100e+00,
     + -1.8713250e+00,-1.4605800e+00,-1.1528210e+00,-9.1860100e-01,-5.9772000e-01,
     + -3.9879600e-01,-2.7149800e-01,-1.8812900e-01,-1.3230400e-01,-9.4138000e-02,
     + -4.8649000e-02,-2.5020000e-02,-1.2018000e-02,-4.5130000e-03,-9.4452000e-04,
C       3Pi
     +  6.9273192e+04, 5.9831358e+04, 5.1433009e+04, 4.3963440e+04, 3.7371733e+04,
     +  3.1612135e+04, 2.6625168e+04, 2.2339111e+04, 1.8676983e+04, 1.5562656e+04,
     +  1.2924653e+04, 1.0697968e+04, 8.8246151e+03, 7.2534910e+03, 5.9399179e+03,
     +  4.8450608e+03, 3.9353226e+03, 3.1817594e+03, 2.5595352e+03, 2.0474201e+03,
     +  1.6273342e+03, 1.2839353e+03, 1.0042498e+03, 5.9402591e+02, 4.4660447e+02,
     +  3.2865083e+02, 2.3481300e+02, 1.6064503e+02, 1.0246651e+02, 5.7237727e+01,
     +  2.2455652e+01,-3.9350130e+00,-2.3616885e+01,-3.7963324e+01,-4.8091756e+01,
     + -5.4908356e+01,-5.9145436e+01,-6.1392579e+01,-6.2122542e+01,-6.1712802e+01,
     + -6.0463133e+01,-5.8610442e+01,-5.6340702e+01,-5.3798848e+01,-5.1096844e+01,
     + -4.8320261e+01,-4.5533656e+01,-4.2784928e+01,-4.0108790e+01,-3.7529633e+01,
     + -3.5063794e+01,-3.2721388e+01,-3.0507765e+01,-2.8424680e+01,-2.3777268e+01,
     + -1.9877241e+01,-1.6634437e+01,-1.3951491e+01,-1.1736258e+01,-9.9072040e+00,
     + -8.3948160e+00,-7.1412240e+00,-6.0989220e+00,-5.2292350e+00,-4.5008140e+00,
     + -3.8883060e+00,-3.3712140e+00,-2.9329480e+00,-2.5600470e+00,-2.2415690e+00,
     + -1.7337530e+00,-1.3556090e+00,-1.0704290e+00,-8.5283800e-01,-5.5431000e-01,
     + -3.7010600e-01,-2.5267300e-01,-1.7566900e-01,-1.2393200e-01,-8.8415000e-02,
     + -4.5875000e-02,-2.3661000e-02,-1.1389000e-02,-4.2830000e-03,-9.0105000e-04/
*  values or R for spin-orbit matrix elements
      data rso /  
     +  2.500,  2.600,  2.700,  2.800,  2.900,
     +  3.000,  3.250,  3.500,  3.750,  4.000,
     +  4.250,  4.500,  4.750,  5.000,  5.250,
     +  5.500,  6.000,  6.500,  7.000,  7.500,
     +  8.000,  8.500 /
*  values of Axy and Azy - spin-orbit matrix elements within 3P state
*  then values of the B spin-orbit matrix elements, coupling the 1D and 3P states
       data somat /  
C Axy
     +   1.7957297e+02, 1.5936413e+02, 1.4071868e+02, 1.2555362e+02, 1.1405022e+02,
     +   1.0550798e+02, 9.2373385e+01, 8.5554168e+01, 8.1781424e+01, 7.9629375e+01,
     +   7.8390756e+01, 7.7679844e+01, 7.7276049e+01, 7.7049459e+01, 7.6924527e+01,
     +   7.6857153e+01, 7.6804021e+01, 7.6791720e+01, 7.6790160e+01, 7.6791014e+01,
     +   7.6792077e+01, 7.6792832e+01,
C Axz 
     +  -5.6037463e+01,-4.9658136e+01,-4.0210022e+01,-2.9171092e+01,-1.7993150e+01,
     +  -7.5255130e+00, 1.3797519e+01, 2.8431436e+01, 3.7991583e+01, 4.4082379e+01,
     +   4.7913049e+01, 5.0308754e+01, 5.1803221e+01, 5.2736054e+01, 5.3318589e+01,
     +   5.3682831e+01, 5.4054347e+01, 5.4201698e+01, 5.4260578e+01, 5.4284035e+01,
     +   5.4293443e+01, 5.4297439e+01,
C Bss  
     +   1.4055219e+01, 1.3850714e+01, 1.4023482e+01, 1.4694743e+01, 1.5911604e+01,
     +   1.7668881e+01, 2.4288361e+01, 3.3632747e+01, 4.4430759e+01, 5.4779308e+01,
     +   6.3240669e+01, 6.9442008e+01, 7.3709134e+01, 7.6547908e+01, 7.8403136e+01,
     +   7.9602961e+01, 8.0864439e+01, 8.1369561e+01, 8.1563633e+01, 8.1635966e+01,
     +   8.1663148e+01, 8.1673448e+01,
C Byx 
     +   1.7705363e+02, 1.5704630e+02, 1.3839862e+02, 1.2302636e+02, 1.1118172e+02,
     +   1.0224148e+02, 8.8159190e+01, 8.0643949e+01, 7.6422488e+01, 7.3998676e+01,
     +   7.2601601e+01, 7.1800837e+01, 7.1347472e+01, 7.1094337e+01, 7.0955780e+01,
     +   7.0881827e+01, 7.0824800e+01, 7.0812525e+01, 7.0811565e+01, 7.0812885e+01,
     +   7.0814200e+01, 7.0815051e+01,
C Bxs  
     +  -6.0475712e+01,-5.1991842e+01,-4.0874927e+01,-2.8755416e+01,-1.6918944e+01,
     +  -6.0589220e+00, 1.5445523e+01, 2.8829104e+01, 3.5280736e+01, 3.6880779e+01,
     +   3.5973055e+01, 3.4287655e+01, 3.2679943e+01, 3.1426907e+01, 3.0536148e+01,
     +   2.9933826e+01, 2.9284392e+01, 2.9024250e+01, 2.8880500e+01, 2.8892878e+01,
     +   2.8834202e+01, 2.8876470e+01,
C Bsy  
     +  -6.1885414e+01,-5.6180250e+01,-4.7218746e+01,-3.6448264e+01,-2.5365227e+01,
     +  -1.4874870e+01, 6.8081800e+00, 2.2027213e+01, 3.2203249e+01, 3.8812840e+01,
     +   4.3023476e+01, 4.5674034e+01, 4.7330380e+01, 4.8362703e+01, 4.9005182e+01,
     +   4.9405098e+01, 4.9810014e+01, 4.9968824e+01, 5.0031746e+01, 5.0056707e+01,
     +   5.0066620e+01, 5.0070691e+01,
C Bxd  
     +  -5.9619721e+01,-5.4525340e+01,-4.6194224e+01,-3.5872255e+01,-2.4970812e+01,
     +  -1.4442809e+01, 7.6689860e+00, 2.3113507e+01, 3.3204488e+01, 3.9592684e+01,
     +   4.3576767e+01, 4.6046535e+01, 4.7573819e+01, 4.8519191e+01, 4.9104838e+01,
     +   4.9468231e+01, 4.9835236e+01, 4.9978973e+01, 5.0035800e+01, 5.0058198e+01,
     +   5.0067063e+01, 5.0070778e+01/
*
*  set vv0 term to zero
      vv0 = 0.d0
*
*  spline fits
      if (ifirst .eq. 0) then
*  spline fit of the coefficients for the PE curves
        indel=1
        do ilam=1,5
          call dcopy(85,vl(indel),1,vecel,1)
*  evaluate derivative at first point
          der1=(vecel(2)-vecel(1))/(rr(2)-rr(1))
          call dspline(rr,vecel,85,der1,0d0,csplel(1,ilam))
          indel = indel + 85
        enddo
*  spline fit of the coefficients for the spin-orbit matrix elements
        indso=1
        do ilam=6,12
          call dcopy(22,somat(indso),1,vecso,1)
*  evaluate derivative at first point
          der1=(vecso(2)-vecso(1))/(rso(2)-rso(1))
          call dspline(rso,vecso,22,der1,0d0,csplso(1,ilam))
          indso = indso + 22
        enddo
        ifirst = 1
      end if
*  determine splined coefficients for PE curves at r=R
      indel=1
      do ilam=1,5
        call dcopy(85,vl(indel),1,vecel,1)
        call dsplint(rr,vecel,csplel(1,ilam),85,r,vvx)
        v(ilam) = vvx
        call dcopy(85,vl(indel),1,vecel,1)
        indel = indel + 85
*  shift singlet PE curves to E=0 at large R
        if (ilam .le. 3) then
          v(ilam) = v(ilam) - 15906.642d0
*          if (r .gt. 24.d0) v(ilam) = 0.d0
        endif
*  fix long-range behavior of PE curves to go to zero at large R
        if (r.gt.25.d0) then
          switch_lr = 0.5*(tanh(0.5*(r - 30.d0)) + 1.d0)
          v(ilam) = (1.d0 - switch_lr) * v(ilam)
        endif
      enddo
*  determine splined coefficients for spin-orbit matrix elements at r=R
      indso=1
      do ilam=6,12
        call dcopy(22,somat(indso),1,vecso,1)
        call dsplint(rso,vecso,csplso(1,ilam),22,r,vvx)
        v(ilam) = vvx
        call dcopy(22,somat(indso),1,vecso,1)
        indso = indso + 22
*  if r≥8.5 bohr, set equal to SO matrix element at R=8.5
        if (r.ge.8.5d0) v(ilam) = somat(indso-1)
*  get value of spin-orbit parameter at R=inf
        v(ilam+7) = somat(indso-1)
      enddo
      call dcopy(19,v,1,vvl,1)
* convert to hartree
      econv=1.d0/219474.6d0
      call dscal(19,econv,vvl,1)
      return
      end
*===================================eof====================================
