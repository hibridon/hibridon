* System:  CN(A 2Pi,v=2)+Ar
* Ar-CN(A) Doran Bennet's PES
* Averaged for v=2 of CN(A)
* Ref: S. J. McGurk,  K. G. McKendrick,
*  M. L. Costen, D. I. G. Bennett,
*  J. Klos, M. H. Alexander, and
* P. J. Dagdigian
* J. Chem. Phys. 136,164306 (2012)
*
* written by J. Klos (30-nov-2016)
* modified by p. dagdigian to allow outputting table of vlms's
* (1-dec-2016)
*
      subroutine driver
      implicit double precision (a-h,o-z)
      common /covvl/ vvl(10)
      include "common/parpot"
      potnam='Ar-CN(A) D. Bennet PES <v=2>'
      econv=219474.6d0
      print *, potnam
1      print *, ' r (bohr)'
      read (5, *, end=99) r
      if (r.le.0.d0) goto 99
      call pot(vv0,r)
*  potential is returned in atomic units (hartree)
*  convert from atomic units for printout
      write (6, 100) vv0*econv,vvl*econv
100   format(' vsum',/,6(1pe16.8),/,
     :    '  vdif',/,5e16.8)
      goto 1
99    rr=3.5d0
      dr=0.5d0
      open (unit=12,file='cnar_Av2aver_dbennett_vlms.txt')
      write(12,109)
109   format('%R/bohr v00 v10 v20 v30 v40 v50 ',
     :  'v22 v32 v42 v52 v62')
      do i=1,60
        call pot(vv0,rr)
        write (12,110) rr,vv0*econv, (econv*vvl(j),j=1,10)
110     format(f7.2,11(1pe16.8))
        rr = rr + dr
      enddo
      close(12)
      end

      include "common/syusr"
      include "common/bausr"
      include "common/ground"
      subroutine loapot(iunit,filnam)
* ------------------------------------------------------------------------
      character*(*) filnam
      include "common/parbas"
      include "common/parpot"
      potnam='Ar-CN(A) D. Bennet PES <v=2>'
      lammin(1)=1
      lammax(1)=6
      lammin(2)=2
      lammax(2)=5
      mproj(1)=0
      mproj(2)=2
      ntv(1)=1
      ivcol(1,1)=0
      ivrow(1,1)=0
      return
      end
* ----------------------------------------------------------------------
      subroutine pot (vv0, r)
*  subroutine to calculate the r-dependent coefficients
*  in atomic units (distance and energy)
* ----------------------------------------------------------------------
*  on entry:
*    r:      interparticle distance
*  on return:
*  vv0        contains isotropic term (d00 term in vsum)
*  variable in common block /covvl/
*    vvl:     vector of length 10 to store r-dependence of each term
*             in potential expansion for vl0 and vl2
* ----------------------------------------------------------------------

      implicit double precision (a-h,o-z)

      common /covvl/ vvl(10)
      data half, zero, one, alph /0.5d0, 0.d0, 1.d0, 1.2d0/
      call dscal(10,zero,vvl,1)
* convert to hartree
      conv=1.d0/219474.6435D0
      vv0=VL0_v2_0(r)*conv
      vvl(1)=VL0_v2_1(r)*conv
      vvl(2)=VL0_v2_2(r)*conv
      vvl(3)=VL0_v2_3(r)*conv
      vvl(4)=VL0_v2_4(r)*conv
      vvl(5)=VL0_v2_5(r)*conv
      vvl(6)=VL0_v2_6(r)*conv
      vvl(7)=VL2_v2_2(r)*conv
      vvl(8)=VL2_v2_3(r)*conv
      vvl(9)=VL2_v2_4(r)*conv
      vvl(10)=VL2_v2_5(r)*conv
      end

C PROGRAM TO GENERATE 1-D RKHS FITS OF Vl0
C COEFFICIENTS IN LEGENDRE
C ANGULAR EXPANSION OF Ar-CN(A,v=2) 
C DISTANCE IS IN BOHR
C EXPANSION COEFFFICIENTS IN CM-1
C REPRODUCING KERNEL HILBERT SPACE METHOD 
C AUTHOR: Jacek Klos, University of Maryland
C Department of Chemistry, College Park,MD
C---OPTIMIZED FOR EXECUTION TIME BY DIRECT
C---EXPRESIONS OF HYPERGEOMETRIC AND BETA FUNCTIONS
C
      FUNCTION VL0_v2_0(RR)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NPT=107)
      DIMENSION VAB(NPT),VCOEF(NPT)
      DIMENSION R(NPT),THETA(NPT)
      DATA R/
     .  3.500D0,
     .  3.750D0,
     .  4.000D0,
     .  4.250D0,
     .  4.500D0,
     .  4.750D0,
     .  5.000D0,
     .  5.250D0,
     .  5.500D0,
     .  5.750D0,
     .  6.000D0,
     .  6.250D0,
     .  6.500D0,
     .  6.750D0,
     .  7.000D0,
     .  7.250D0,
     .  7.500D0,
     .  7.750D0,
     .  8.000D0,
     .  8.250D0,
     .  8.500D0,
     .  8.750D0,
     .  9.000D0,
     .  9.250D0,
     .  9.500D0,
     .  9.750D0,
     . 10.000D0,
     . 10.250D0,
     . 10.500D0,
     . 10.750D0,
     . 11.000D0,
     . 11.250D0,
     . 11.500D0,
     . 11.750D0,
     . 12.000D0,
     . 12.250D0,
     . 12.500D0,
     . 12.750D0,
     . 13.000D0,
     . 13.250D0,
     . 13.500D0,
     . 13.750D0,
     . 14.000D0,
     . 14.250D0,
     . 14.500D0,
     . 14.750D0,
     . 15.000D0,
     . 15.250D0,
     . 15.500D0,
     . 15.750D0,
     . 16.000D0,
     . 16.250D0,
     . 16.500D0,
     . 16.750D0,
     . 17.000D0,
     . 17.250D0,
     . 17.500D0,
     . 17.750D0,
     . 18.000D0,
     . 18.250D0,
     . 18.500D0,
     . 18.750D0,
     . 19.000D0,
     . 19.250D0,
     . 19.500D0,
     . 19.750D0,
     . 20.000D0,
     . 20.250D0,
     . 20.500D0,
     . 20.750D0,
     . 21.000D0,
     . 21.250D0,
     . 21.500D0,
     . 21.750D0,
     . 22.000D0,
     . 22.250D0,
     . 22.500D0,
     . 22.750D0,
     . 23.000D0,
     . 23.250D0,
     . 23.500D0,
     . 23.750D0,
     . 24.000D0,
     . 24.250D0,
     . 24.500D0,
     . 24.750D0,
     . 25.000D0,
     . 25.250D0,
     . 25.500D0,
     . 25.750D0,
     . 26.000D0,
     . 26.250D0,
     . 26.500D0,
     . 26.750D0,
     . 27.000D0,
     . 27.250D0,
     . 27.500D0,
     . 27.750D0,
     . 28.000D0,
     . 28.250D0,
     . 28.500D0,
     . 28.750D0,
     . 29.000D0,
     . 29.250D0,
     . 29.500D0,
     . 29.750D0,
     . 30.000D0/
      DATA VCOEF/
     *   -0.154629389539211988D+06,
     *    0.121841221273252368D+07,
     *   -0.671396144606281817D+07,
     *    0.335586385775115341D+08,
     *   -0.162061239946619034D+09,
     *    0.772346965933419585D+09,
     *   -0.364234680140747499D+10,
     *    0.169825789043622971D+11,
     *    0.250163295109086838D+11,
     *   -0.473538000579325180D+11,
     *    0.475794732943994427D+10,
     *    0.312844217482747078D+09,
     *   -0.772039760059415817D+09,
     *   -0.809660191305515766D+09,
     *    0.510570914423100352D+09,
     *   -0.536456454956802845D+09,
     *   -0.789944547819529533D+09,
     *    0.409370868912674046D+10,
     *   -0.661334358676793575D+10,
     *    0.850096134652707481D+10,
     *   -0.490072986508396721D+10,
     *    0.272892237616406918D+10,
     *   -0.592851587877929688D+09,
     *   -0.108104500148564768D+10,
     *    0.186984629866173863D+10,
     *    0.547313852263413620D+10,
     *   -0.177073911887202110D+11,
     *    0.357591959001386490D+11,
     *   -0.462146842921948853D+11,
     *    0.367306253521090851D+11,
     *   -0.109442362095616245D+11,
     *   -0.843797091373239326D+10,
     *    0.136398537475157852D+11,
     *   -0.783669606093332863D+10,
     *   -0.650954322819320869D+10,
     *   -0.654444162885882378D+09,
     *    0.230335559975635529D+11,
     *   -0.153854004517139673D+09,
     *   -0.276591022571881981D+11,
     *   -0.179015576615942955D+09,
     *    0.231858550367821579D+11,
     *   -0.707544234749225616D+09,
     *   -0.148942961558026295D+11,
     *   -0.948685548941135406D+08,
     *    0.590704413635449028D+10,
     *    0.128798118190090179D+09,
     *   -0.156752798359494209D+09,
     *    0.855623466506299973D+08,
     *   -0.796358076628494263D+07,
     *    0.153825214534528732D+09,
     *   -0.295865324523482025D+09,
     *    0.367094737377381325D+09,
     *   -0.679986220152318001D+09,
     *    0.968295924859561920D+09,
     *   -0.645464220054449081D+09,
     *   -0.141479266425786972D+09,
     *    0.665119866546386719D+09,
     *   -0.651780983505534410D+09,
     *    0.450610381587818146D+09,
     *   -0.864061633401079178D+08,
     *   -0.656216556366613865D+09,
     *    0.107242168147609997D+10,
     *   -0.253735291121152878D+09,
     *   -0.822444789007836699D+09,
     *    0.561306780480514288D+09,
     *    0.588182576562806129D+09,
     *   -0.166549353963377810D+10,
     *    0.233808445375976181D+10,
     *   -0.163694820534156275D+10,
     *   -0.503002650620643616D+09,
     *    0.220553512506510830D+10,
     *   -0.219863056081393051D+10,
     *    0.130286381364128876D+10,
     *   -0.686023570602212906D+09,
     *    0.784397081606933594D+09,
     *   -0.264218640441078329D+10,
     *    0.604710454104571915D+10,
     *   -0.763836124277976608D+10,
     *    0.546361127040253830D+10,
     *   -0.104026460827975178D+10,
     *   -0.391931013110157728D+10,
     *    0.707229463730255699D+10,
     *   -0.386658737227968788D+10,
     *   -0.464101417857854939D+10,
     *    0.871336161461091614D+10,
     *   -0.777819225750759506D+10,
     *    0.102645989686761742D+11,
     *   -0.903817974326175308D+10,
     *   -0.655155160374891853D+10,
     *    0.257507716615588036D+11,
     *   -0.334211635861339798D+11,
     *    0.294584351977024574D+11,
     *   -0.218024881522567062D+11,
     *    0.101747586026057816D+11,
     *    0.116192651570452251D+11,
     *   -0.319560951791091805D+11,
     *    0.316424161876122131D+11,
     *   -0.150857237063855000D+11,
     *    0.196264338617022133D+10,
     *   -0.159349188336703110D+10,
     *    0.137364720175378685D+11,
     *   -0.363891672974388580D+11,
     *    0.470626485093751831D+11,
     *   -0.103716516035930042D+11,
     *   -0.606996118373231812D+11,
     *    0.814868299018983765D+11,
     *   -0.325873936101888046D+11/
C Kernel parameters
      M=5
C
C      EVALUATE PES    
       SUMA=ZERO
       DO I=1,NPT
        SUMA=SUMA+VCOEF(I)*RKHS_DKN2(R(I),RR,M)
       END DO
       VL0_v2_0=SUMA
       RETURN
       END
C PROGRAM TO GENERATE 1-D RKHS FITS OF Vl0
C COEFFICIENTS IN LEGENDRE
C ANGULAR EXPANSION OF Ar-CN(A,v=2) 
C DISTANCE IS IN BOHR
C EXPANSION COEFFFICIENTS IN CM-1
C REPRODUCING KERNEL HILBERT SPACE METHOD 
C AUTHOR: Jacek Klos, University of Maryland
C Department of Chemistry, College Park,MD
C---OPTIMIZED FOR EXECUTION TIME BY DIRECT
C---EXPRESIONS OF HYPERGEOMETRIC AND BETA FUNCTIONS
C
      FUNCTION VL0_v2_1(RR)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NPT=107)
      DIMENSION VAB(NPT),VCOEF(NPT)
      DIMENSION R(NPT),THETA(NPT)
      DATA R/
     .  3.500D0,
     .  3.750D0,
     .  4.000D0,
     .  4.250D0,
     .  4.500D0,
     .  4.750D0,
     .  5.000D0,
     .  5.250D0,
     .  5.500D0,
     .  5.750D0,
     .  6.000D0,
     .  6.250D0,
     .  6.500D0,
     .  6.750D0,
     .  7.000D0,
     .  7.250D0,
     .  7.500D0,
     .  7.750D0,
     .  8.000D0,
     .  8.250D0,
     .  8.500D0,
     .  8.750D0,
     .  9.000D0,
     .  9.250D0,
     .  9.500D0,
     .  9.750D0,
     . 10.000D0,
     . 10.250D0,
     . 10.500D0,
     . 10.750D0,
     . 11.000D0,
     . 11.250D0,
     . 11.500D0,
     . 11.750D0,
     . 12.000D0,
     . 12.250D0,
     . 12.500D0,
     . 12.750D0,
     . 13.000D0,
     . 13.250D0,
     . 13.500D0,
     . 13.750D0,
     . 14.000D0,
     . 14.250D0,
     . 14.500D0,
     . 14.750D0,
     . 15.000D0,
     . 15.250D0,
     . 15.500D0,
     . 15.750D0,
     . 16.000D0,
     . 16.250D0,
     . 16.500D0,
     . 16.750D0,
     . 17.000D0,
     . 17.250D0,
     . 17.500D0,
     . 17.750D0,
     . 18.000D0,
     . 18.250D0,
     . 18.500D0,
     . 18.750D0,
     . 19.000D0,
     . 19.250D0,
     . 19.500D0,
     . 19.750D0,
     . 20.000D0,
     . 20.250D0,
     . 20.500D0,
     . 20.750D0,
     . 21.000D0,
     . 21.250D0,
     . 21.500D0,
     . 21.750D0,
     . 22.000D0,
     . 22.250D0,
     . 22.500D0,
     . 22.750D0,
     . 23.000D0,
     . 23.250D0,
     . 23.500D0,
     . 23.750D0,
     . 24.000D0,
     . 24.250D0,
     . 24.500D0,
     . 24.750D0,
     . 25.000D0,
     . 25.250D0,
     . 25.500D0,
     . 25.750D0,
     . 26.000D0,
     . 26.250D0,
     . 26.500D0,
     . 26.750D0,
     . 27.000D0,
     . 27.250D0,
     . 27.500D0,
     . 27.750D0,
     . 28.000D0,
     . 28.250D0,
     . 28.500D0,
     . 28.750D0,
     . 29.000D0,
     . 29.250D0,
     . 29.500D0,
     . 29.750D0,
     . 30.000D0/
      DATA VCOEF/
     *    0.944266830672696233D+04,
     *   -0.234986064157793298D+06,
     *    0.187122324532803893D+07,
     *   -0.101612447813324630D+08,
     *    0.493137970745900273D+08,
     *   -0.234456386565317094D+09,
     *    0.110554465490134048D+10,
     *   -0.515652599612600517D+10,
     *    0.376284539459770381D+09,
     *   -0.129982494271089535D+11,
     *    0.279033354045170593D+11,
     *   -0.160821657440916100D+11,
     *    0.648292115870761490D+10,
     *   -0.144441982730850625D+10,
     *    0.562165518496600628D+09,
     *    0.175485002789113426D+10,
     *   -0.217947176856145906D+10,
     *    0.383532805406534863D+10,
     *   -0.258773630932962704D+10,
     *   -0.100034000740798688D+10,
     *    0.144981473299851131D+10,
     *   -0.149255079088282061D+10,
     *    0.608718468321812916D+10,
     *   -0.927093994697484016D+10,
     *    0.886726298682999420D+10,
     *   -0.181573697492501259D+11,
     *    0.286798697871528511D+11,
     *   -0.216822230901814728D+11,
     *    0.334993707527063751D+10,
     *   -0.511574501367185593D+09,
     *    0.685178413935795403D+10,
     *   -0.618667023762058735D+09,
     *   -0.835383352189547348D+10,
     *    0.184710908581913400D+10,
     *    0.829780343003686333D+10,
     *    0.379515957389444351D+09,
     *   -0.182644487408814354D+11,
     *    0.257698944816846848D+09,
     *    0.233988538560033722D+11,
     *    0.134935292644818306D+09,
     *   -0.507996881293613815D+10,
     *    0.522742577421349525D+09,
     *   -0.232059008373967133D+11,
     *    0.323239948858605385D+09,
     *    0.164032846397813702D+11,
     *   -0.198829702990115643D+09,
     *    0.343359244241273642D+09,
     *   -0.385097175105535865D+09,
     *    0.327283394138616085D+09,
     *   -0.287943172105447412D+09,
     *    0.270964179819545031D+09,
     *   -0.337498129468008995D+09,
     *    0.705865608180177212D+09,
     *   -0.106407308299954844D+10,
     *    0.777692939806344032D+09,
     *   -0.121993319204670370D+09,
     *   -0.223966661429286122D+09,
     *    0.600781619412401676D+09,
     *   -0.145238462621385479D+10,
     *    0.196276257617608643D+10,
     *   -0.134982542991564918D+10,
     *    0.612979662072875023D+09,
     *   -0.104498849681033421D+10,
     *    0.182530707325719166D+10,
     *   -0.149307884078019714D+10,
     *    0.480941649564325809D+09,
     *   -0.347847735708001137D+09,
     *    0.159960959649914169D+10,
     *   -0.371821042041333342D+10,
     *    0.556749829833888054D+10,
     *   -0.479331589271711159D+10,
     *    0.569454715768041611D+09,
     *    0.368058667788250875D+10,
     *   -0.360376162936478567D+10,
     *   -0.552311511982818604D+09,
     *    0.533665505818369961D+10,
     *   -0.983914808297580528D+10,
     *    0.141140183984597435D+11,
     *   -0.155624866959897766D+11,
     *    0.135856571011710052D+11,
     *   -0.133393078795300446D+11,
     *    0.172126202414288940D+11,
     *   -0.203787963190983505D+11,
     *    0.171016472819207840D+11,
     *   -0.552036339232112980D+10,
     *   -0.657981354621486473D+10,
     *    0.107339424272735519D+11,
     *   -0.114064964470691910D+11,
     *    0.129580850233733215D+11,
     *   -0.160598098251309814D+11,
     *    0.290845923023138123D+11,
     *   -0.563925303604192200D+11,
     *    0.892456616644166260D+11,
     *   -0.114926791171534180D+12,
     *    0.126065250544173523D+12,
     *   -0.126469417940529633D+12,
     *    0.123884041223488739D+12,
     *   -0.120976183227555420D+12,
     *    0.112821648584180908D+12,
     *   -0.890179353453695831D+11,
     *    0.549589380067812119D+11,
     *   -0.288087685770144653D+11,
     *    0.140540592179781189D+11,
     *   -0.851716703265429687D+10,
     *    0.908543909838470459D+10,
     *   -0.672939034072848511D+10,
     *    0.187659228549438477D+10/
C Kernel parameters
      M=5
C
C      EVALUATE PES    
       SUMA=ZERO
       DO I=1,NPT
        SUMA=SUMA+VCOEF(I)*RKHS_DKN2(R(I),RR,M)
       END DO
       VL0_v2_1=SUMA
       RETURN
       END
C PROGRAM TO GENERATE 1-D RKHS FITS OF Vl0
C COEFFICIENTS IN LEGENDRE
C ANGULAR EXPANSION OF Ar-CN(A,v=2) 
C DISTANCE IS IN BOHR
C EXPANSION COEFFFICIENTS IN CM-1
C REPRODUCING KERNEL HILBERT SPACE METHOD 
C AUTHOR: Jacek Klos, University of Maryland
C Department of Chemistry, College Park,MD
C---OPTIMIZED FOR EXECUTION TIME BY DIRECT
C---EXPRESIONS OF HYPERGEOMETRIC AND BETA FUNCTIONS
C
      FUNCTION VL0_v2_2(RR)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NPT=107)
      DIMENSION VAB(NPT),VCOEF(NPT)
      DIMENSION R(NPT),THETA(NPT)
      DATA R/
     .  3.500D0,
     .  3.750D0,
     .  4.000D0,
     .  4.250D0,
     .  4.500D0,
     .  4.750D0,
     .  5.000D0,
     .  5.250D0,
     .  5.500D0,
     .  5.750D0,
     .  6.000D0,
     .  6.250D0,
     .  6.500D0,
     .  6.750D0,
     .  7.000D0,
     .  7.250D0,
     .  7.500D0,
     .  7.750D0,
     .  8.000D0,
     .  8.250D0,
     .  8.500D0,
     .  8.750D0,
     .  9.000D0,
     .  9.250D0,
     .  9.500D0,
     .  9.750D0,
     . 10.000D0,
     . 10.250D0,
     . 10.500D0,
     . 10.750D0,
     . 11.000D0,
     . 11.250D0,
     . 11.500D0,
     . 11.750D0,
     . 12.000D0,
     . 12.250D0,
     . 12.500D0,
     . 12.750D0,
     . 13.000D0,
     . 13.250D0,
     . 13.500D0,
     . 13.750D0,
     . 14.000D0,
     . 14.250D0,
     . 14.500D0,
     . 14.750D0,
     . 15.000D0,
     . 15.250D0,
     . 15.500D0,
     . 15.750D0,
     . 16.000D0,
     . 16.250D0,
     . 16.500D0,
     . 16.750D0,
     . 17.000D0,
     . 17.250D0,
     . 17.500D0,
     . 17.750D0,
     . 18.000D0,
     . 18.250D0,
     . 18.500D0,
     . 18.750D0,
     . 19.000D0,
     . 19.250D0,
     . 19.500D0,
     . 19.750D0,
     . 20.000D0,
     . 20.250D0,
     . 20.500D0,
     . 20.750D0,
     . 21.000D0,
     . 21.250D0,
     . 21.500D0,
     . 21.750D0,
     . 22.000D0,
     . 22.250D0,
     . 22.500D0,
     . 22.750D0,
     . 23.000D0,
     . 23.250D0,
     . 23.500D0,
     . 23.750D0,
     . 24.000D0,
     . 24.250D0,
     . 24.500D0,
     . 24.750D0,
     . 25.000D0,
     . 25.250D0,
     . 25.500D0,
     . 25.750D0,
     . 26.000D0,
     . 26.250D0,
     . 26.500D0,
     . 26.750D0,
     . 27.000D0,
     . 27.250D0,
     . 27.500D0,
     . 27.750D0,
     . 28.000D0,
     . 28.250D0,
     . 28.500D0,
     . 28.750D0,
     . 29.000D0,
     . 29.250D0,
     . 29.500D0,
     . 29.750D0,
     . 30.000D0/
      DATA VCOEF/
     *   -0.234680712861180305D+06,
     *    0.193288470869716257D+07,
     *   -0.107595073416248560D+08,
     *    0.541730813239948750D+08,
     *   -0.263753828738215804D+09,
     *    0.126122728657868433D+10,
     *   -0.595014688370163727D+10,
     *    0.277424455999113197D+11,
     *    0.353928213186601944D+11,
     *   -0.592211190108854752D+11,
     *   -0.955901011612146759D+10,
     *    0.950231731108540154D+10,
     *   -0.501495954229914379D+10,
     *    0.626342733565789223D+09,
     *   -0.238988302252866745D+10,
     *    0.359776764996529961D+10,
     *   -0.524579839230825424D+10,
     *    0.607125143443752766D+10,
     *   -0.596482491819163895D+10,
     *    0.107573658087061157D+11,
     *   -0.178140112514025116D+11,
     *    0.298443212755162697D+11,
     *   -0.354719724063076248D+11,
     *    0.259750209888620377D+11,
     *    0.745954769390970707D+10,
     *   -0.293674201491098480D+11,
     *    0.217417265441431503D+11,
     *   -0.480577287735168934D+10,
     *    0.541250120396377754D+10,
     *   -0.151423238011658077D+11,
     *    0.771777369926085949D+10,
     *    0.131062754769910564D+11,
     *   -0.241500348465263462D+10,
     *   -0.232790601488773575D+11,
     *    0.153537009653895073D+11,
     *   -0.863775421054828644D+09,
     *    0.292569167174566174D+10,
     *   -0.176642674775700092D+09,
     *    0.945297067603219986D+10,
     *   -0.186880848049430847D+08,
     *   -0.266742402519994736D+11,
     *   -0.489231582846311569D+09,
     *    0.237037096756863251D+11,
     *   -0.551245133573781252D+09,
     *   -0.702085218676636696D+10,
     *   -0.263854408113883972D+09,
     *    0.418116089441398621D+09,
     *   -0.579052946580553412D+09,
     *    0.636474320591375351D+09,
     *   -0.754444448161039352D+09,
     *    0.920640557204500675D+09,
     *   -0.671132489634183884D+09,
     *   -0.940452230008831024D+08,
     *    0.791365501766325474D+09,
     *   -0.960133084984990597D+09,
     *    0.680179165276940346D+09,
     *   -0.317055067524524689D+09,
     *   -0.119425783142674446D+09,
     *    0.828271801100126266D+09,
     *   -0.142663768005324173D+10,
     *    0.142877463018672180D+10,
     *   -0.562229537121818542D+09,
     *   -0.681354117577624321D+09,
     *    0.416814894015010834D+09,
     *    0.124345407676866245D+10,
     *   -0.126537741197731400D+10,
     *   -0.554211079838599920D+09,
     *    0.178300618551656675D+10,
     *   -0.274321861936753511D+10,
     *    0.499047499955271149D+10,
     *   -0.738958480565455246D+10,
     *    0.686538640299891376D+10,
     *   -0.383183464519910145D+10,
     *    0.414232309386197138D+10,
     *   -0.105269567278476906D+11,
     *    0.176439931452718697D+11,
     *   -0.187161351736337929D+11,
     *    0.132698515901041222D+11,
     *   -0.841138028449461555D+10,
     *    0.118882642770572624D+11,
     *   -0.218279711369527626D+11,
     *    0.274169386524946747D+11,
     *   -0.236273205852125549D+11,
     *    0.147257006118242149D+11,
     *   -0.577183646625222588D+10,
     *   -0.380944581835978508D+09,
     *    0.515998570494279861D+10,
     *   -0.150913833383592052D+11,
     *    0.389163381676414413D+11,
     *   -0.703310143223901978D+11,
     *    0.817027338258326721D+11,
     *   -0.604608435884113312D+11,
     *    0.278759347656931534D+11,
     *   -0.512901593095575333D+10,
     *   -0.596570884879036713D+10,
     *    0.912340578227148056D+10,
     *   -0.192667536044713593D+11,
     *    0.467406273844922791D+11,
     *   -0.703409725577329254D+11,
     *    0.826543074378631897D+11,
     *   -0.998783766803025970D+11,
     *    0.112401336408926819D+12,
     *   -0.113188016908552109D+12,
     *    0.120391724084739868D+12,
     *   -0.126465300161199387D+12,
     *    0.918451793819723969D+11,
     *   -0.294517575801225967D+11/
C Kernel parameters
      M=5
C
C      EVALUATE PES    
       SUMA=ZERO
       DO I=1,NPT
        SUMA=SUMA+VCOEF(I)*RKHS_DKN2(R(I),RR,M)
       END DO
       VL0_v2_2=SUMA
       RETURN
       END
C PROGRAM TO GENERATE 1-D RKHS FITS OF Vl0
C COEFFICIENTS IN LEGENDRE
C ANGULAR EXPANSION OF Ar-CN(A,v=2) 
C DISTANCE IS IN BOHR
C EXPANSION COEFFFICIENTS IN CM-1
C REPRODUCING KERNEL HILBERT SPACE METHOD 
C AUTHOR: Jacek Klos, University of Maryland
C Department of Chemistry, College Park,MD
C---OPTIMIZED FOR EXECUTION TIME BY DIRECT
C---EXPRESIONS OF HYPERGEOMETRIC AND BETA FUNCTIONS
C
      FUNCTION VL0_v2_3(RR)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NPT=107)
      DIMENSION VAB(NPT),VCOEF(NPT)
      DIMENSION R(NPT),THETA(NPT)
      DATA R/
     .  3.500D0,
     .  3.750D0,
     .  4.000D0,
     .  4.250D0,
     .  4.500D0,
     .  4.750D0,
     .  5.000D0,
     .  5.250D0,
     .  5.500D0,
     .  5.750D0,
     .  6.000D0,
     .  6.250D0,
     .  6.500D0,
     .  6.750D0,
     .  7.000D0,
     .  7.250D0,
     .  7.500D0,
     .  7.750D0,
     .  8.000D0,
     .  8.250D0,
     .  8.500D0,
     .  8.750D0,
     .  9.000D0,
     .  9.250D0,
     .  9.500D0,
     .  9.750D0,
     . 10.000D0,
     . 10.250D0,
     . 10.500D0,
     . 10.750D0,
     . 11.000D0,
     . 11.250D0,
     . 11.500D0,
     . 11.750D0,
     . 12.000D0,
     . 12.250D0,
     . 12.500D0,
     . 12.750D0,
     . 13.000D0,
     . 13.250D0,
     . 13.500D0,
     . 13.750D0,
     . 14.000D0,
     . 14.250D0,
     . 14.500D0,
     . 14.750D0,
     . 15.000D0,
     . 15.250D0,
     . 15.500D0,
     . 15.750D0,
     . 16.000D0,
     . 16.250D0,
     . 16.500D0,
     . 16.750D0,
     . 17.000D0,
     . 17.250D0,
     . 17.500D0,
     . 17.750D0,
     . 18.000D0,
     . 18.250D0,
     . 18.500D0,
     . 18.750D0,
     . 19.000D0,
     . 19.250D0,
     . 19.500D0,
     . 19.750D0,
     . 20.000D0,
     . 20.250D0,
     . 20.500D0,
     . 20.750D0,
     . 21.000D0,
     . 21.250D0,
     . 21.500D0,
     . 21.750D0,
     . 22.000D0,
     . 22.250D0,
     . 22.500D0,
     . 22.750D0,
     . 23.000D0,
     . 23.250D0,
     . 23.500D0,
     . 23.750D0,
     . 24.000D0,
     . 24.250D0,
     . 24.500D0,
     . 24.750D0,
     . 25.000D0,
     . 25.250D0,
     . 25.500D0,
     . 25.750D0,
     . 26.000D0,
     . 26.250D0,
     . 26.500D0,
     . 26.750D0,
     . 27.000D0,
     . 27.250D0,
     . 27.500D0,
     . 27.750D0,
     . 28.000D0,
     . 28.250D0,
     . 28.500D0,
     . 28.750D0,
     . 29.000D0,
     . 29.250D0,
     . 29.500D0,
     . 29.750D0,
     . 30.000D0/
      DATA VCOEF/
     *    0.623930584283531643D+05,
     *   -0.394932845088044181D+06,
     *    0.196680191952592833D+07,
     *   -0.997865188789807260D+07,
     *    0.499583275265116096D+08,
     *   -0.242100192494786799D+09,
     *    0.114554192909649944D+10,
     *   -0.534190770399544621D+10,
     *    0.247584550320498371D+10,
     *   -0.104036864956207428D+11,
     *    0.194961367273205872D+11,
     *   -0.105443261232799587D+11,
     *    0.443744064965943146D+10,
     *   -0.109707397797893810D+10,
     *    0.145498505967775464D+10,
     *   -0.171467259862396479D+09,
     *   -0.917633597663509011D+09,
     *   -0.122541441178299403D+10,
     *    0.654390705032151604D+10,
     *   -0.552005058901595688D+10,
     *   -0.257678525799923468D+10,
     *    0.690466045976855469D+10,
     *   -0.101017886342770767D+10,
     *   -0.928591347846768188D+10,
     *    0.805606752459601021D+10,
     *    0.754513131097502041D+10,
     *   -0.192437885995509529D+11,
     *    0.235874749791335106D+10,
     *    0.200385756349695282D+11,
     *   -0.101708267105730515D+11,
     *   -0.843998400826984406D+10,
     *    0.146288279905273747D+10,
     *    0.977554210911972237D+10,
     *    0.580264011169926167D+10,
     *   -0.225838382084025803D+11,
     *    0.121288231277540445D+09,
     *    0.202846497185333939D+11,
     *    0.201496911780025482D+09,
     *   -0.158508292115661411D+11,
     *    0.116555230913408279D+09,
     *    0.673043754425657082D+10,
     *    0.106091707442943811D+09,
     *    0.206359736162329292D+10,
     *    0.219183297538123131D+09,
     *   -0.269555523662617254D+10,
     *   -0.311730662673110962D+09,
     *    0.130527022452308655D+09,
     *    0.565826260707308769D+09,
     *   -0.117439069660624838D+10,
     *    0.128974699832942104D+10,
     *   -0.105362492200596619D+10,
     *    0.548064810222629070D+09,
     *    0.457011507665243149D+08,
     *   -0.535082617162959099D+09,
     *    0.117198593834851694D+10,
     *   -0.152182820117580652D+10,
     *    0.490937189870880008D+09,
     *    0.114764730628088546D+10,
     *   -0.112462665155499363D+10,
     *   -0.672568293649530649D+09,
     *    0.183965744069802117D+10,
     *   -0.943534902068485737D+09,
     *   -0.149347837594948626D+10,
     *    0.428242239624950600D+10,
     *   -0.537825117272288895D+10,
     *    0.367254776291504478D+10,
     *   -0.949894237195149899D+09,
     *   -0.156124648689509964D+10,
     *    0.359316058535353279D+10,
     *   -0.202050557208270836D+10,
     *   -0.309798667209887314D+10,
     *    0.633657023755415154D+10,
     *   -0.652253149062043190D+10,
     *    0.458592289118501759D+10,
     *   -0.234866777599945164D+10,
     *    0.404992383330332470D+10,
     *   -0.571972355627737808D+10,
     *    0.264529282886488724D+10,
     *   -0.238682855478442669D+09,
     *   -0.110104718587726593D+09,
     *    0.324172041401791382D+10,
     *   -0.494646829001006317D+10,
     *   -0.518316218781512070D+10,
     *    0.252201828674348526D+11,
     *   -0.388955915966057053D+11,
     *    0.384511768815678253D+11,
     *   -0.378417613122766266D+11,
     *    0.479678431819088516D+11,
     *   -0.509566282485571289D+11,
     *    0.316173887074252892D+11,
     *   -0.195771546690961685D+11,
     *    0.462563987840221939D+11,
     *   -0.968457532807483978D+11,
     *    0.146537740536148956D+12,
     *   -0.173302203710260345D+12,
     *    0.147662611469162659D+12,
     *   -0.753502910868430023D+11,
     *    0.114579848535022354D+11,
     *    0.701816319501663208D+09,
     *    0.147064266993961716D+11,
     *   -0.160098405265511723D+11,
     *    0.325201724105552521D+11,
     *   -0.993568695727409668D+11,
     *    0.141121847391422363D+12,
     *   -0.920805521632732239D+11,
     *    0.240886691536555328D+11,
     *   -0.944315764305564880D+09/
C Kernel parameters
      M=5
C
C      EVALUATE PES    
       SUMA=ZERO
       DO I=1,NPT
        SUMA=SUMA+VCOEF(I)*RKHS_DKN2(R(I),RR,M)
       END DO
       VL0_v2_3=SUMA
       RETURN
       END
C PROGRAM TO GENERATE 1-D RKHS FITS OF Vl0
C COEFFICIENTS IN LEGENDRE
C ANGULAR EXPANSION OF Ar-CN(A,v=2) 
C DISTANCE IS IN BOHR
C EXPANSION COEFFFICIENTS IN CM-1
C REPRODUCING KERNEL HILBERT SPACE METHOD 
C AUTHOR: Jacek Klos, University of Maryland
C Department of Chemistry, College Park,MD
C---OPTIMIZED FOR EXECUTION TIME BY DIRECT
C---EXPRESIONS OF HYPERGEOMETRIC AND BETA FUNCTIONS
C
      FUNCTION VL0_v2_4(RR)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NPT=107)
      DIMENSION VAB(NPT),VCOEF(NPT)
      DIMENSION R(NPT),THETA(NPT)
      DATA R/
     .  3.500D0,
     .  3.750D0,
     .  4.000D0,
     .  4.250D0,
     .  4.500D0,
     .  4.750D0,
     .  5.000D0,
     .  5.250D0,
     .  5.500D0,
     .  5.750D0,
     .  6.000D0,
     .  6.250D0,
     .  6.500D0,
     .  6.750D0,
     .  7.000D0,
     .  7.250D0,
     .  7.500D0,
     .  7.750D0,
     .  8.000D0,
     .  8.250D0,
     .  8.500D0,
     .  8.750D0,
     .  9.000D0,
     .  9.250D0,
     .  9.500D0,
     .  9.750D0,
     . 10.000D0,
     . 10.250D0,
     . 10.500D0,
     . 10.750D0,
     . 11.000D0,
     . 11.250D0,
     . 11.500D0,
     . 11.750D0,
     . 12.000D0,
     . 12.250D0,
     . 12.500D0,
     . 12.750D0,
     . 13.000D0,
     . 13.250D0,
     . 13.500D0,
     . 13.750D0,
     . 14.000D0,
     . 14.250D0,
     . 14.500D0,
     . 14.750D0,
     . 15.000D0,
     . 15.250D0,
     . 15.500D0,
     . 15.750D0,
     . 16.000D0,
     . 16.250D0,
     . 16.500D0,
     . 16.750D0,
     . 17.000D0,
     . 17.250D0,
     . 17.500D0,
     . 17.750D0,
     . 18.000D0,
     . 18.250D0,
     . 18.500D0,
     . 18.750D0,
     . 19.000D0,
     . 19.250D0,
     . 19.500D0,
     . 19.750D0,
     . 20.000D0,
     . 20.250D0,
     . 20.500D0,
     . 20.750D0,
     . 21.000D0,
     . 21.250D0,
     . 21.500D0,
     . 21.750D0,
     . 22.000D0,
     . 22.250D0,
     . 22.500D0,
     . 22.750D0,
     . 23.000D0,
     . 23.250D0,
     . 23.500D0,
     . 23.750D0,
     . 24.000D0,
     . 24.250D0,
     . 24.500D0,
     . 24.750D0,
     . 25.000D0,
     . 25.250D0,
     . 25.500D0,
     . 25.750D0,
     . 26.000D0,
     . 26.250D0,
     . 26.500D0,
     . 26.750D0,
     . 27.000D0,
     . 27.250D0,
     . 27.500D0,
     . 27.750D0,
     . 28.000D0,
     . 28.250D0,
     . 28.500D0,
     . 28.750D0,
     . 29.000D0,
     . 29.250D0,
     . 29.500D0,
     . 29.750D0,
     . 30.000D0/
      DATA VCOEF/
     *   -0.937195970324459486D+05,
     *    0.667445218612819677D+06,
     *   -0.348248345945237577D+07,
     *    0.175365712847156078D+08,
     *   -0.864427656786401868D+08,
     *    0.415530778317890048D+09,
     *   -0.196092337221423221D+10,
     *    0.913780310386868286D+10,
     *    0.168674237294951477D+11,
     *   -0.415446530626965179D+11,
     *    0.299553890505859985D+11,
     *   -0.184821350200034409D+11,
     *    0.526224059550064659D+10,
     *   -0.212620702211002851D+10,
     *    0.169539431194246602D+10,
     *   -0.322037469882166958D+10,
     *    0.438597077586382961D+10,
     *   -0.685995864682402229D+10,
     *    0.138939418488397865D+11,
     *   -0.199071751625468140D+11,
     *    0.222960744834270706D+11,
     *   -0.232969940180563812D+11,
     *    0.251684107626816940D+11,
     *   -0.146964825906735458D+11,
     *   -0.939430433373859215D+10,
     *    0.212574422233452148D+11,
     *   -0.537967228308159256D+10,
     *   -0.786871835711032295D+10,
     *    0.130917046432823420D+10,
     *    0.152919827435795403D+10,
     *    0.767420858767344666D+10,
     *   -0.213865803426550531D+10,
     *   -0.103569678918702431D+11,
     *    0.567260823552148533D+10,
     *    0.198135379343390608D+10,
     *    0.462325752894353569D+09,
     *   -0.239988515913723087D+10,
     *    0.920856771364850998D+08,
     *   -0.242831613420870686D+10,
     *    0.674293918472716808D+08,
     *    0.543811556495956707D+10,
     *    0.178201731369023085D+09,
     *    0.240024191493245602D+09,
     *   -0.384492378887319565D+08,
     *   -0.272857429442206669D+10,
     *   -0.422464369052759171D+09,
     *    0.441853249672552764D+09,
     *   -0.364527091212880135D+09,
     *    0.238913988301303864D+09,
     *   -0.362446086070890427D+08,
     *   -0.353785279050854683D+09,
     *    0.709545364488317013D+09,
     *   -0.714787789694134712D+09,
     *    0.563439432891406298D+09,
     *   -0.466806731286088467D+09,
     *    0.145102768613636494D+09,
     *    0.609612495200571299D+09,
     *   -0.168690175754870677D+10,
     *    0.304376003399720478D+10,
     *   -0.417011501852875376D+10,
     *    0.435929801704066086D+10,
     *   -0.418658592300873709D+10,
     *    0.358525356250673103D+10,
     *   -0.788811654602937937D+09,
     *   -0.326502705365627718D+10,
     *    0.462771731533103561D+10,
     *   -0.206382136621569061D+10,
     *   -0.186274661018190861D+10,
     *    0.421894797511309814D+10,
     *   -0.287384712618085337D+10,
     *   -0.171590070336726952D+10,
     *    0.585846429370522404D+10,
     *   -0.780651068681126595D+10,
     *    0.826271493860202217D+10,
     *   -0.730108576602961731D+10,
     *    0.626472344364629841D+10,
     *   -0.666612704279502296D+10,
     *    0.885164052891681671D+10,
     *   -0.903661193007003975D+10,
     *   -0.319426116111356926D+10,
     *    0.268008101661134529D+11,
     *   -0.438135150956207733D+11,
     *    0.440444603662805939D+11,
     *   -0.261935176640139580D+11,
     *   -0.961245189540376854D+10,
     *    0.457164696296959229D+11,
     *   -0.606185574988923798D+11,
     *    0.545765060726909027D+11,
     *   -0.299246488439945259D+11,
     *   -0.102185839785111465D+11,
     *    0.463222695016279297D+11,
     *   -0.726868093259483032D+11,
     *    0.893214305380102386D+11,
     *   -0.678495933231596603D+11,
     *   -0.122993456191337204D+10,
     *    0.694587359112958832D+11,
     *   -0.712746146765331421D+11,
     *    0.120583209465494232D+11,
     *    0.770252981329226685D+10,
     *    0.483688466737533188D+11,
     *   -0.925090405358695984D+11,
     *    0.799806401412774048D+11,
     *   -0.866824460066079712D+10,
     *   -0.142521229084606537D+12,
     *    0.288799029386858582D+12,
     *   -0.255817954305942261D+12,
     *    0.868860694114328918D+11/
C Kernel parameters
      M=5
C
C      EVALUATE PES    
       SUMA=ZERO
       DO I=1,NPT
        SUMA=SUMA+VCOEF(I)*RKHS_DKN2(R(I),RR,M)
       END DO
       VL0_v2_4=SUMA
       RETURN
       END
C PROGRAM TO GENERATE 1-D RKHS FITS OF Vl0
C COEFFICIENTS IN LEGENDRE
C ANGULAR EXPANSION OF Ar-CN(A,v=2) 
C DISTANCE IS IN BOHR
C EXPANSION COEFFFICIENTS IN CM-1
C REPRODUCING KERNEL HILBERT SPACE METHOD 
C AUTHOR: Jacek Klos, University of Maryland
C Department of Chemistry, College Park,MD
C---OPTIMIZED FOR EXECUTION TIME BY DIRECT
C---EXPRESIONS OF HYPERGEOMETRIC AND BETA FUNCTIONS
C
      FUNCTION VL0_v2_5(RR)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NPT=107)
      DIMENSION VAB(NPT),VCOEF(NPT)
      DIMENSION R(NPT),THETA(NPT)
      DATA R/
     .  3.500D0,
     .  3.750D0,
     .  4.000D0,
     .  4.250D0,
     .  4.500D0,
     .  4.750D0,
     .  5.000D0,
     .  5.250D0,
     .  5.500D0,
     .  5.750D0,
     .  6.000D0,
     .  6.250D0,
     .  6.500D0,
     .  6.750D0,
     .  7.000D0,
     .  7.250D0,
     .  7.500D0,
     .  7.750D0,
     .  8.000D0,
     .  8.250D0,
     .  8.500D0,
     .  8.750D0,
     .  9.000D0,
     .  9.250D0,
     .  9.500D0,
     .  9.750D0,
     . 10.000D0,
     . 10.250D0,
     . 10.500D0,
     . 10.750D0,
     . 11.000D0,
     . 11.250D0,
     . 11.500D0,
     . 11.750D0,
     . 12.000D0,
     . 12.250D0,
     . 12.500D0,
     . 12.750D0,
     . 13.000D0,
     . 13.250D0,
     . 13.500D0,
     . 13.750D0,
     . 14.000D0,
     . 14.250D0,
     . 14.500D0,
     . 14.750D0,
     . 15.000D0,
     . 15.250D0,
     . 15.500D0,
     . 15.750D0,
     . 16.000D0,
     . 16.250D0,
     . 16.500D0,
     . 16.750D0,
     . 17.000D0,
     . 17.250D0,
     . 17.500D0,
     . 17.750D0,
     . 18.000D0,
     . 18.250D0,
     . 18.500D0,
     . 18.750D0,
     . 19.000D0,
     . 19.250D0,
     . 19.500D0,
     . 19.750D0,
     . 20.000D0,
     . 20.250D0,
     . 20.500D0,
     . 20.750D0,
     . 21.000D0,
     . 21.250D0,
     . 21.500D0,
     . 21.750D0,
     . 22.000D0,
     . 22.250D0,
     . 22.500D0,
     . 22.750D0,
     . 23.000D0,
     . 23.250D0,
     . 23.500D0,
     . 23.750D0,
     . 24.000D0,
     . 24.250D0,
     . 24.500D0,
     . 24.750D0,
     . 25.000D0,
     . 25.250D0,
     . 25.500D0,
     . 25.750D0,
     . 26.000D0,
     . 26.250D0,
     . 26.500D0,
     . 26.750D0,
     . 27.000D0,
     . 27.250D0,
     . 27.500D0,
     . 27.750D0,
     . 28.000D0,
     . 28.250D0,
     . 28.500D0,
     . 28.750D0,
     . 29.000D0,
     . 29.250D0,
     . 29.500D0,
     . 29.750D0,
     . 30.000D0/
      DATA VCOEF/
     *    0.291503875912697986D+05,
     *   -0.184145984927516431D+06,
     *    0.923303168292276561D+06,
     *   -0.443439139634700119D+07,
     *    0.203237478816936761D+08,
     *   -0.936268958941847980D+08,
     *    0.434887838644962490D+09,
     *   -0.201637860764322281D+10,
     *   -0.143426106526027031D+11,
     *    0.545345431166461334D+11,
     *   -0.732163470692361450D+11,
     *    0.466786295340566025D+11,
     *   -0.156081319194769516D+11,
     *    0.533795632763763714D+10,
     *   -0.158453110292888546D+10,
     *   -0.584013066610781193D+09,
     *    0.203720421191119957D+10,
     *    0.795755218566172719D+09,
     *   -0.858354168101812553D+10,
     *    0.121468799137291107D+11,
     *   -0.504448920367796421D+10,
     *   -0.336527688986817551D+10,
     *   -0.321149700587638259D+09,
     *    0.790844566864217472D+10,
     *   -0.639624951486362457D+10,
     *    0.244289942238151121D+10,
     *   -0.433690744855468369D+10,
     *    0.840067622014716148D+10,
     *   -0.658416093028457928D+10,
     *    0.902080710597300529D+07,
     *    0.261408971609201431D+10,
     *   -0.404453846868035221D+10,
     *   -0.398658062631164646D+10,
     *    0.179877045577154160D+11,
     *   -0.161725560261175041D+11,
     *    0.657213084300389290D+09,
     *    0.113272606228593178D+11,
     *   -0.155211835522846222D+09,
     *   -0.123101098358551044D+11,
     *   -0.171363466493483543D+09,
     *    0.293362592835510921D+10,
     *    0.308618583721056938D+09,
     *    0.963150792816299820D+10,
     *   -0.553157078602657318D+08,
     *   -0.766472236545452881D+10,
     *    0.198277628448408842D+09,
     *   -0.274917053888925076D+09,
     *   -0.111353720090055466D+07,
     *    0.226962277458967686D+09,
     *   -0.130316108357289553D+09,
     *   -0.429114780201025009D+08,
     *    0.753203500880889893D+08,
     *    0.165695026173164368D+09,
     *   -0.719427787836055756D+09,
     *    0.987873737695210457D+09,
     *   -0.731309832291146278D+09,
     *    0.796260630144067764D+09,
     *   -0.105177283708026505D+10,
     *    0.315791502613487244D+09,
     *    0.114803662547035217D+10,
     *   -0.190706311176359510D+10,
     *    0.115697481373030376D+10,
     *    0.746141212759504318D+09,
     *   -0.229914759504242134D+10,
     *    0.180114017800588703D+10,
     *    0.108649890678237915D+09,
     *   -0.619564831682435036D+09,
     *   -0.929831324868312359D+09,
     *    0.405394255521310425D+10,
     *   -0.951614719529080963D+10,
     *    0.129972227018679848D+11,
     *   -0.833987665871158695D+10,
     *    0.604436876957538605D+09,
     *    0.508283558842733383D+09,
     *    0.614604214734861660D+10,
     *   -0.151961982391139603D+11,
     *    0.192126360218925323D+11,
     *   -0.158346666684518757D+11,
     *    0.112470491097339401D+11,
     *   -0.939201647131464958D+10,
     *    0.106830512447244377D+11,
     *   -0.168695874071801300D+11,
     *    0.251256093224893494D+11,
     *   -0.290955512467709122D+11,
     *    0.273170491362746239D+11,
     *   -0.270529339257102547D+11,
     *    0.386248254641946716D+11,
     *   -0.507801833576213379D+11,
     *    0.259365728649454956D+11,
     *    0.384105696635991364D+11,
     *   -0.842761844936179199D+11,
     *    0.837089994615249176D+11,
     *   -0.639065609376663666D+11,
     *    0.312306365947226181D+11,
     *    0.654162807980155945D+10,
     *   -0.380605692295272827D+09,
     *   -0.678266172255170288D+11,
     *    0.134264601304341919D+12,
     *   -0.142391008338781677D+12,
     *    0.141444010560479614D+12,
     *   -0.189348068643275513D+12,
     *    0.225696246019040649D+12,
     *   -0.167083798725824921D+12,
     *    0.625219270123179932D+11,
     *   -0.136616985903851624D+11,
     *    0.110472238215209503D+11,
     *   -0.536462548289582825D+10/
C Kernel parameters
      M=5
C
C      EVALUATE PES    
       SUMA=ZERO
       DO I=1,NPT
        SUMA=SUMA+VCOEF(I)*RKHS_DKN2(R(I),RR,M)
       END DO
       VL0_v2_5=SUMA
       RETURN
       END
C PROGRAM TO GENERATE 1-D RKHS FITS OF Vl0
C COEFFICIENTS IN LEGENDRE
C ANGULAR EXPANSION OF Ar-CN(A,v=2) 
C DISTANCE IS IN BOHR
C EXPANSION COEFFFICIENTS IN CM-1
C REPRODUCING KERNEL HILBERT SPACE METHOD 
C AUTHOR: Jacek Klos, University of Maryland
C Department of Chemistry, College Park,MD
C---OPTIMIZED FOR EXECUTION TIME BY DIRECT
C---EXPRESIONS OF HYPERGEOMETRIC AND BETA FUNCTIONS
C
      FUNCTION VL0_v2_6(RR)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NPT=107)
      DIMENSION VAB(NPT),VCOEF(NPT)
      DIMENSION R(NPT),THETA(NPT)
      DATA R/
     .  3.500D0,
     .  3.750D0,
     .  4.000D0,
     .  4.250D0,
     .  4.500D0,
     .  4.750D0,
     .  5.000D0,
     .  5.250D0,
     .  5.500D0,
     .  5.750D0,
     .  6.000D0,
     .  6.250D0,
     .  6.500D0,
     .  6.750D0,
     .  7.000D0,
     .  7.250D0,
     .  7.500D0,
     .  7.750D0,
     .  8.000D0,
     .  8.250D0,
     .  8.500D0,
     .  8.750D0,
     .  9.000D0,
     .  9.250D0,
     .  9.500D0,
     .  9.750D0,
     . 10.000D0,
     . 10.250D0,
     . 10.500D0,
     . 10.750D0,
     . 11.000D0,
     . 11.250D0,
     . 11.500D0,
     . 11.750D0,
     . 12.000D0,
     . 12.250D0,
     . 12.500D0,
     . 12.750D0,
     . 13.000D0,
     . 13.250D0,
     . 13.500D0,
     . 13.750D0,
     . 14.000D0,
     . 14.250D0,
     . 14.500D0,
     . 14.750D0,
     . 15.000D0,
     . 15.250D0,
     . 15.500D0,
     . 15.750D0,
     . 16.000D0,
     . 16.250D0,
     . 16.500D0,
     . 16.750D0,
     . 17.000D0,
     . 17.250D0,
     . 17.500D0,
     . 17.750D0,
     . 18.000D0,
     . 18.250D0,
     . 18.500D0,
     . 18.750D0,
     . 19.000D0,
     . 19.250D0,
     . 19.500D0,
     . 19.750D0,
     . 20.000D0,
     . 20.250D0,
     . 20.500D0,
     . 20.750D0,
     . 21.000D0,
     . 21.250D0,
     . 21.500D0,
     . 21.750D0,
     . 22.000D0,
     . 22.250D0,
     . 22.500D0,
     . 22.750D0,
     . 23.000D0,
     . 23.250D0,
     . 23.500D0,
     . 23.750D0,
     . 24.000D0,
     . 24.250D0,
     . 24.500D0,
     . 24.750D0,
     . 25.000D0,
     . 25.250D0,
     . 25.500D0,
     . 25.750D0,
     . 26.000D0,
     . 26.250D0,
     . 26.500D0,
     . 26.750D0,
     . 27.000D0,
     . 27.250D0,
     . 27.500D0,
     . 27.750D0,
     . 28.000D0,
     . 28.250D0,
     . 28.500D0,
     . 28.750D0,
     . 29.000D0,
     . 29.250D0,
     . 29.500D0,
     . 29.750D0,
     . 30.000D0/
      DATA VCOEF/
     *   -0.497082410359447822D+05,
     *    0.240395801968719810D+06,
     *   -0.100293151424878836D+07,
     *    0.433065174561760575D+07,
     *   -0.186570150921086669D+08,
     *    0.844504416317461729D+08,
     *   -0.393100056760318220D+09,
     *    0.182885222096852160D+10,
     *    0.105601237862558174D+11,
     *   -0.371280980681122055D+11,
     *    0.461496720420469589D+11,
     *   -0.285204883479512634D+11,
     *    0.918490699613259125D+10,
     *   -0.265597499351175976D+10,
     *    0.346321878875696182D+09,
     *    0.152953718885928392D+09,
     *    0.587793148355411887D+09,
     *    0.540796711542363763D+09,
     *   -0.366985370514666367D+10,
     *    0.389239047351135731D+10,
     *   -0.501798468131018877D+09,
     *   -0.147178354874304032D+10,
     *    0.187125607441025472D+10,
     *   -0.136039994311361623D+10,
     *   -0.106159083166522217D+10,
     *    0.343071785932095289D+10,
     *    0.354387290333536148D+09,
     *   -0.164745314281257210D+11,
     *    0.338210027429471092D+11,
     *   -0.211127418542581215D+11,
     *   -0.826239181634186840D+10,
     *    0.641332994006654358D+10,
     *    0.883169219992344475D+10,
     *   -0.926024300437173653D+10,
     *    0.146888543990588684D+11,
     *   -0.418566030347422600D+09,
     *   -0.255300219546543007D+11,
     *    0.407294873877706528D+08,
     *    0.188686185354594193D+11,
     *   -0.312032831437379003D+09,
     *    0.104710694545094528D+11,
     *   -0.248416448491321564D+09,
     *   -0.288378455100695877D+11,
     *    0.733558920508547306D+09,
     *    0.143713234603354759D+11,
     *    0.726449919009802341D+09,
     *   -0.525135992463006020D+09,
     *    0.542661923912518024D+09,
     *   -0.576600225892875195D+09,
     *    0.375061631880145073D+09,
     *    0.173651292908773422D+09,
     *   -0.101420206307632446D+10,
     *    0.161835123787630367D+10,
     *   -0.148452828156170177D+10,
     *    0.804960697757418275D+09,
     *    0.234586232418507099D+09,
     *   -0.140389965826658154D+10,
     *    0.203843700658820963D+10,
     *   -0.210135350170916557D+10,
     *    0.182934623438458443D+10,
     *   -0.872713498492652893D+09,
     *   -0.249893892193222523D+09,
     *    0.598476820199254990D+09,
     *   -0.106583944270539570D+10,
     *    0.235005285829511738D+10,
     *   -0.272061667721994352D+10,
     *    0.263171051162371963D+09,
     *    0.469993291160729980D+10,
     *   -0.907466562828670311D+10,
     *    0.868416280436135674D+10,
     *   -0.349271009023538017D+10,
     *    0.292589204842746735D+09,
     *   -0.182691984531507015D+10,
     *    0.832572592441318512D+09,
     *    0.516958918310806656D+10,
     *   -0.107925167302498817D+11,
     *    0.142414512995316219D+11,
     *   -0.176077902402592850D+11,
     *    0.195603485672767105D+11,
     *   -0.142339124059779778D+11,
     *    0.103975994377750778D+10,
     *    0.137112648048498974D+11,
     *   -0.232518093476362495D+11,
     *    0.138840874682300148D+11,
     *    0.259862885313725510D+11,
     *   -0.703798399758027191D+11,
     *    0.793605652866225739D+11,
     *   -0.554883032898882370D+11,
     *    0.127711884183747368D+11,
     *    0.461534341427242584D+11,
     *   -0.979760842687846680D+11,
     *    0.121321357461488068D+12,
     *   -0.111234540329938446D+12,
     *    0.589037195092485809D+11,
     *    0.168668984804883194D+11,
     *   -0.590050209550066986D+11,
     *    0.464800872123426208D+11,
     *   -0.322674568888201065D+11,
     *    0.706148779361629028D+11,
     *   -0.133635373630351608D+12,
     *    0.156046836899628601D+12,
     *   -0.144532526773709045D+12,
     *    0.141436676413227142D+12,
     *   -0.134924729380136658D+12,
     *    0.947898614577640686D+11,
     *   -0.378982603285232697D+11,
     *    0.566546444451667786D+10/
C Kernel parameters
      M=5
C
C      EVALUATE PES    
       SUMA=ZERO
       DO I=1,NPT
        SUMA=SUMA+VCOEF(I)*RKHS_DKN2(R(I),RR,M)
       END DO
       VL0_v2_6=SUMA
       RETURN
       END
C PROGRAM TO GENERATE 1-D RKHS FITS OF Vl2
C COEFFICIENTS IN LEGENDRE
C ANGULAR EXPANSION OF Ar-CN(A,v=2)
C DISTANCE IS IN BOHR
C EXPANSION COEFFFICIENTS IN CM-1
C REPRODUCING KERNEL HILBERT SPACE METHOD
C AUTHOR: Jacek Klos, University of Maryland
C Department of Chemistry, College Park,MD
C---OPTIMIZED FOR EXECUTION TIME BY DIRECT
C---EXPRESIONS OF HYPERGEOMETRIC AND BETA FUNCTIONS
C

      FUNCTION VL2_v2_2(RR)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NPT=107)
      DIMENSION VAB(NPT),VCOEF(NPT)
      DIMENSION R(NPT),THETA(NPT)
      DATA R/
     .  3.500D0,
     .  3.750D0,
     .  4.000D0,
     .  4.250D0,
     .  4.500D0,
     .  4.750D0,
     .  5.000D0,
     .  5.250D0,
     .  5.500D0,
     .  5.750D0,
     .  6.000D0,
     .  6.250D0,
     .  6.500D0,
     .  6.750D0,
     .  7.000D0,
     .  7.250D0,
     .  7.500D0,
     .  7.750D0,
     .  8.000D0,
     .  8.250D0,
     .  8.500D0,
     .  8.750D0,
     .  9.000D0,
     .  9.250D0,
     .  9.500D0,
     .  9.750D0,
     . 10.000D0,
     . 10.250D0,
     . 10.500D0,
     . 10.750D0,
     . 11.000D0,
     . 11.250D0,
     . 11.500D0,
     . 11.750D0,
     . 12.000D0,
     . 12.250D0,
     . 12.500D0,
     . 12.750D0,
     . 13.000D0,
     . 13.250D0,
     . 13.500D0,
     . 13.750D0,
     . 14.000D0,
     . 14.250D0,
     . 14.500D0,
     . 14.750D0,
     . 15.000D0,
     . 15.250D0,
     . 15.500D0,
     . 15.750D0,
     . 16.000D0,
     . 16.250D0,
     . 16.500D0,
     . 16.750D0,
     . 17.000D0,
     . 17.250D0,
     . 17.500D0,
     . 17.750D0,
     . 18.000D0,
     . 18.250D0,
     . 18.500D0,
     . 18.750D0,
     . 19.000D0,
     . 19.250D0,
     . 19.500D0,
     . 19.750D0,
     . 20.000D0,
     . 20.250D0,
     . 20.500D0,
     . 20.750D0,
     . 21.000D0,
     . 21.250D0,
     . 21.500D0,
     . 21.750D0,
     . 22.000D0,
     . 22.250D0,
     . 22.500D0,
     . 22.750D0,
     . 23.000D0,
     . 23.250D0,
     . 23.500D0,
     . 23.750D0,
     . 24.000D0,
     . 24.250D0,
     . 24.500D0,
     . 24.750D0,
     . 25.000D0,
     . 25.250D0,
     . 25.500D0,
     . 25.750D0,
     . 26.000D0,
     . 26.250D0,
     . 26.500D0,
     . 26.750D0,
     . 27.000D0,
     . 27.250D0,
     . 27.500D0,
     . 27.750D0,
     . 28.000D0,
     . 28.250D0,
     . 28.500D0,
     . 28.750D0,
     . 29.000D0,
     . 29.250D0,
     . 29.500D0,
     . 29.750D0,
     . 30.000D0/
      DATA VCOEF/
     *   -0.808095709974840283D+05,
     *    0.535851682606445858D+06,
     *   -0.245106049415671825D+07,
     *    0.115013769919181988D+08,
     *   -0.561017847512309551D+08,
     *    0.270840752814414740D+09,
     *   -0.128311947945379162D+10,
     *    0.599518935926638222D+10,
     *    0.737177390047739506D+10,
     *   -0.173514266043333054D+11,
     *    0.768213346153709793D+10,
     *   -0.723777550769067764D+10,
     *    0.386302364738911438D+10,
     *    0.129078168805017052D+11,
     *   -0.412565495400005188D+11,
     *    0.584000772855338974D+11,
     *   -0.359245439796842651D+11,
     *   -0.110758968306302719D+11,
     *    0.222024569614260368D+11,
     *   -0.618452640487666321D+10,
     *    0.220251661155906534D+10,
     *   -0.699778699429829836D+09,
     *    0.214889636845111072D+09,
     *   -0.657594198854942322D+08,
     *    0.198475088944873810D+08,
     *   -0.597203544595432281D+07,
     *    0.179173579270815849D+07,
     *   -0.536071610816717148D+06,
     *    0.159965542944908142D+06,
     *   -0.476143568048477173D+05,
     *    0.141384502220153809D+05,
     *   -0.418836708307266235D+04,
     *    0.123796693444252014D+04,
     *   -0.365210749149322510D+03,
     *    0.107608146667480469D+03,
     *   -0.317629938125610352D+02,
     *    0.961006450653076172D+01,
     *   -0.340752051770687103D+01,
     *    0.178261804580688477D+01,
     *   -0.121309566497802734D+01,
     *    0.977046012878417969D+00,
     *   -0.112090110778808594D+01,
     *    0.135106897354125977D+01,
     *   -0.103053057193756104D+01,
     *    0.128637313842773438D+00,
     *    0.736931800842285156D+00,
     *   -0.110098934173583984D+01,
     *    0.831099510192871094D+00,
     *   -0.248255729675292969D+00,
     *    0.368170738220214844D-01,
     *   -0.292985081672668457D+00,
     *    0.268943309783935547D+00,
     *    0.440641403198242188D+00,
     *   -0.111331558227539063D+01,
     *    0.916120529174804688D+00,
     *   -0.297182083129882812D+00,
     *    0.146249771118164062D+00,
     *   -0.557837486267089844D+00,
     *    0.138008880615234375D+01,
     *   -0.244939231872558594D+01,
     *    0.292099690437316895D+01,
     *   -0.193484210968017578D+01,
     *    0.211715698242187500D-01,
     *    0.148459815979003906D+01,
     *   -0.196932125091552734D+01,
     *    0.164958572387695313D+01,
     *   -0.119799232482910156D+01,
     *    0.973062515258789062D+00,
     *    0.371459007263183594D+00,
     *   -0.355438899993896484D+01,
     *    0.515858650207519531D+01,
     *   -0.182197380065917969D+01,
     *   -0.392218732833862305D+01,
     *    0.664612436294555664D+01,
     *   -0.499288666248321533D+01,
     *    0.192127847671508789D+01,
     *    0.193460464477539062D+00,
     *   -0.428584575653076172D+00,
     *   -0.128123283386230469D+01,
     *    0.272195339202880859D+01,
     *   -0.266846084594726563D+01,
     *    0.250979995727539063D+01,
     *   -0.143586826324462891D+01,
     *   -0.129890346527099609D+01,
     *    0.275392723083496094D+01,
     *   -0.170112705230712891D+01,
     *    0.640821456909179688D-02,
     *    0.698489189147949219D+00,
     *    0.145286703109741211D+01,
     *   -0.482551336288452148D+01,
     *    0.455412292480468750D+01,
     *   -0.275373435020446777D+01,
     *    0.385370683670043945D+01,
     *   -0.458475971221923828D+01,
     *    0.406003034114837646D+01,
     *   -0.686897504329681396D+01,
     *    0.112870578765869141D+02,
     *   -0.118021984100341797D+02,
     *    0.864754390716552734D+01,
     *   -0.747406148910522461D+01,
     *    0.113742032051086426D+02,
     *   -0.145731320381164551D+02,
     *    0.120581789016723633D+02,
     *   -0.955791378021240234D+01,
     *    0.107266697883605957D+02,
     *   -0.884020519256591797D+01,
     *    0.294593429565429688D+01/
C Kernel parameters
      M=5
C
C      EVALUATE PES    
       SUMA=ZERO
       DO I=1,NPT
        SUMA=SUMA+VCOEF(I)*RKHS_DKN2(R(I),RR,M)
       END DO
       VL2_v2_2=SUMA
       RETURN
       END
C PROGRAM TO GENERATE 1-D RKHS FITS OF Vl2
C COEFFICIENTS IN LEGENDRE
C ANGULAR EXPANSION OF Ar-CN(A,v=2)
C DISTANCE IS IN BOHR
C EXPANSION COEFFFICIENTS IN CM-1
C REPRODUCING KERNEL HILBERT SPACE METHOD
C AUTHOR: Jacek Klos, University of Maryland
C Department of Chemistry, College Park,MD
C---OPTIMIZED FOR EXECUTION TIME BY DIRECT
C---EXPRESIONS OF HYPERGEOMETRIC AND BETA FUNCTIONS
C

      FUNCTION VL2_v2_3(RR)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NPT=107)
      DIMENSION VAB(NPT),VCOEF(NPT)
      DIMENSION R(NPT),THETA(NPT)
      DATA R/
     .  3.500D0,
     .  3.750D0,
     .  4.000D0,
     .  4.250D0,
     .  4.500D0,
     .  4.750D0,
     .  5.000D0,
     .  5.250D0,
     .  5.500D0,
     .  5.750D0,
     .  6.000D0,
     .  6.250D0,
     .  6.500D0,
     .  6.750D0,
     .  7.000D0,
     .  7.250D0,
     .  7.500D0,
     .  7.750D0,
     .  8.000D0,
     .  8.250D0,
     .  8.500D0,
     .  8.750D0,
     .  9.000D0,
     .  9.250D0,
     .  9.500D0,
     .  9.750D0,
     . 10.000D0,
     . 10.250D0,
     . 10.500D0,
     . 10.750D0,
     . 11.000D0,
     . 11.250D0,
     . 11.500D0,
     . 11.750D0,
     . 12.000D0,
     . 12.250D0,
     . 12.500D0,
     . 12.750D0,
     . 13.000D0,
     . 13.250D0,
     . 13.500D0,
     . 13.750D0,
     . 14.000D0,
     . 14.250D0,
     . 14.500D0,
     . 14.750D0,
     . 15.000D0,
     . 15.250D0,
     . 15.500D0,
     . 15.750D0,
     . 16.000D0,
     . 16.250D0,
     . 16.500D0,
     . 16.750D0,
     . 17.000D0,
     . 17.250D0,
     . 17.500D0,
     . 17.750D0,
     . 18.000D0,
     . 18.250D0,
     . 18.500D0,
     . 18.750D0,
     . 19.000D0,
     . 19.250D0,
     . 19.500D0,
     . 19.750D0,
     . 20.000D0,
     . 20.250D0,
     . 20.500D0,
     . 20.750D0,
     . 21.000D0,
     . 21.250D0,
     . 21.500D0,
     . 21.750D0,
     . 22.000D0,
     . 22.250D0,
     . 22.500D0,
     . 22.750D0,
     . 23.000D0,
     . 23.250D0,
     . 23.500D0,
     . 23.750D0,
     . 24.000D0,
     . 24.250D0,
     . 24.500D0,
     . 24.750D0,
     . 25.000D0,
     . 25.250D0,
     . 25.500D0,
     . 25.750D0,
     . 26.000D0,
     . 26.250D0,
     . 26.500D0,
     . 26.750D0,
     . 27.000D0,
     . 27.250D0,
     . 27.500D0,
     . 27.750D0,
     . 28.000D0,
     . 28.250D0,
     . 28.500D0,
     . 28.750D0,
     . 29.000D0,
     . 29.250D0,
     . 29.500D0,
     . 29.750D0,
     . 30.000D0/
      DATA VCOEF/
     *    0.541006367386845013D+05,
     *   -0.139553686792177614D+06,
     *    0.475255618489165616D+06,
     *   -0.347878672163076792D+07,
     *    0.171624999830567092D+08,
     *   -0.740822978558292538D+08,
     *    0.333318777218375564D+09,
     *   -0.154191248300813818D+10,
     *    0.736277110034379768D+10,
     *   -0.124846360201973248D+11,
     *    0.110406153805028954D+11,
     *   -0.617210849531747437D+10,
     *   -0.517700350623227119D+10,
     *    0.178567945444698524D+11,
     *   -0.189068321297370644D+11,
     *    0.559873642077919769D+10,
     *    0.810275925583445930D+10,
     *   -0.983818059657069397D+10,
     *    0.594291060663252068D+10,
     *   -0.267750286983957195D+10,
     *    0.815018107424457908D+09,
     *   -0.255001797932770967D+09,
     *    0.788070626772012711D+08,
     *   -0.241457259541554451D+08,
     *    0.728766329986361414D+07,
     *   -0.219282851521551609D+07,
     *    0.657894473522543907D+06,
     *   -0.196836155034422874D+06,
     *    0.587364250776171684D+05,
     *   -0.174829897683858871D+05,
     *    0.519127357208728790D+04,
     *   -0.153784202635288239D+04,
     *    0.454485115945339203D+03,
     *   -0.134004316896200180D+03,
     *    0.395019613504409790D+02,
     *   -0.117423775196075439D+02,
     *    0.361056756973266602D+01,
     *   -0.127111649513244629D+01,
     *    0.579054474830627441D+00,
     *   -0.312650471925735474D+00,
     *    0.248823881149291992D+00,
     *   -0.271215915679931641D+00,
     *    0.245202541351318359D+00,
     *   -0.144078254699707031D+00,
     *   -0.119881629943847656D-01,
     *    0.133069992065429688D+00,
     *   -0.134319782257080078D+00,
     *    0.436353385448455811D-01,
     *    0.406348705291748047D-01,
     *   -0.308909416198730469D-01,
     *   -0.417375564575195312D-01,
     *    0.382251739501953125D-01,
     *    0.849237442016601562D-01,
     *   -0.226614952087402344D+00,
     *    0.351327419281005859D+00,
     *   -0.471027851104736328D+00,
     *    0.605880498886108398D+00,
     *   -0.822496533393859863D+00,
     *    0.888406395912170410D+00,
     *   -0.616879701614379883D+00,
     *    0.377213001251220703D+00,
     *   -0.199912071228027344D+00,
     *   -0.208737850189208984D+00,
     *    0.488938331604003906D+00,
     *   -0.349591732025146484D+00,
     *    0.167567729949951172D+00,
     *   -0.364392757415771484D+00,
     *    0.901297569274902344D+00,
     *   -0.865468978881835938D+00,
     *   -0.367803096771240234D+00,
     *    0.151598429679870605D+01,
     *   -0.124911749362945557D+01,
     *    0.129506617784500122D+00,
     *    0.720711827278137207D+00,
     *   -0.744391918182373047D+00,
     *    0.447723865509033203D-01,
     *    0.737899303436279297D+00,
     *   -0.114355087280273438D+01,
     *    0.127115631103515625D+01,
     *   -0.150637602806091309D+01,
     *    0.168076181411743164D+01,
     *   -0.132627010345458984D+01,
     *    0.817006349563598633D+00,
     *   -0.677979707717895508D+00,
     *    0.107102489471435547D+01,
     *   -0.200175988674163818D+01,
     *    0.266960930824279785D+01,
     *   -0.224373054504394531D+01,
     *    0.144681113958358765D+01,
     *   -0.136069333553314209D+01,
     *    0.191988807916641235D+01,
     *   -0.344380789995193481D+01,
     *    0.593279445171356201D+01,
     *   -0.710917031764984131D+01,
     *    0.703689211606979370D+01,
     *   -0.851800644397735596D+01,
     *    0.100862630009651184D+02,
     *   -0.895239424705505371D+01,
     *    0.731850039958953857D+01,
     *   -0.825009268522262573D+01,
     *    0.102875113487243652D+02,
     *   -0.884650909900665283D+01,
     *    0.294926595687866211D+01,
     *    0.146110248565673828D+01,
     *   -0.380778431892395020D+00,
     *   -0.159410142898559570D+01,
     *    0.880563855171203613D+00/
C Kernel parameters
      M=5
C
C      EVALUATE PES    
       SUMA=ZERO
       DO I=1,NPT
        SUMA=SUMA+VCOEF(I)*RKHS_DKN2(R(I),RR,M)
       END DO
       VL2_v2_3=SUMA
       RETURN
       END
C PROGRAM TO GENERATE 1-D RKHS FITS OF Vl2
C COEFFICIENTS IN LEGENDRE
C ANGULAR EXPANSION OF Ar-CN(A,v=2)
C DISTANCE IS IN BOHR
C EXPANSION COEFFFICIENTS IN CM-1
C REPRODUCING KERNEL HILBERT SPACE METHOD
C AUTHOR: Jacek Klos, University of Maryland
C Department of Chemistry, College Park,MD
C---OPTIMIZED FOR EXECUTION TIME BY DIRECT
C---EXPRESIONS OF HYPERGEOMETRIC AND BETA FUNCTIONS
C

      FUNCTION VL2_v2_4(RR)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NPT=107)
      DIMENSION VAB(NPT),VCOEF(NPT)
      DIMENSION R(NPT),THETA(NPT)
      DATA R/
     .  3.500D0,
     .  3.750D0,
     .  4.000D0,
     .  4.250D0,
     .  4.500D0,
     .  4.750D0,
     .  5.000D0,
     .  5.250D0,
     .  5.500D0,
     .  5.750D0,
     .  6.000D0,
     .  6.250D0,
     .  6.500D0,
     .  6.750D0,
     .  7.000D0,
     .  7.250D0,
     .  7.500D0,
     .  7.750D0,
     .  8.000D0,
     .  8.250D0,
     .  8.500D0,
     .  8.750D0,
     .  9.000D0,
     .  9.250D0,
     .  9.500D0,
     .  9.750D0,
     . 10.000D0,
     . 10.250D0,
     . 10.500D0,
     . 10.750D0,
     . 11.000D0,
     . 11.250D0,
     . 11.500D0,
     . 11.750D0,
     . 12.000D0,
     . 12.250D0,
     . 12.500D0,
     . 12.750D0,
     . 13.000D0,
     . 13.250D0,
     . 13.500D0,
     . 13.750D0,
     . 14.000D0,
     . 14.250D0,
     . 14.500D0,
     . 14.750D0,
     . 15.000D0,
     . 15.250D0,
     . 15.500D0,
     . 15.750D0,
     . 16.000D0,
     . 16.250D0,
     . 16.500D0,
     . 16.750D0,
     . 17.000D0,
     . 17.250D0,
     . 17.500D0,
     . 17.750D0,
     . 18.000D0,
     . 18.250D0,
     . 18.500D0,
     . 18.750D0,
     . 19.000D0,
     . 19.250D0,
     . 19.500D0,
     . 19.750D0,
     . 20.000D0,
     . 20.250D0,
     . 20.500D0,
     . 20.750D0,
     . 21.000D0,
     . 21.250D0,
     . 21.500D0,
     . 21.750D0,
     . 22.000D0,
     . 22.250D0,
     . 22.500D0,
     . 22.750D0,
     . 23.000D0,
     . 23.250D0,
     . 23.500D0,
     . 23.750D0,
     . 24.000D0,
     . 24.250D0,
     . 24.500D0,
     . 24.750D0,
     . 25.000D0,
     . 25.250D0,
     . 25.500D0,
     . 25.750D0,
     . 26.000D0,
     . 26.250D0,
     . 26.500D0,
     . 26.750D0,
     . 27.000D0,
     . 27.250D0,
     . 27.500D0,
     . 27.750D0,
     . 28.000D0,
     . 28.250D0,
     . 28.500D0,
     . 28.750D0,
     . 29.000D0,
     . 29.250D0,
     . 29.500D0,
     . 29.750D0,
     . 30.000D0/
      DATA VCOEF/
     *   -0.370925725730128586D+06,
     *    0.167040042199961143D+07,
     *   -0.483240159392591100D+07,
     *    0.174415562292638607D+08,
     *   -0.806312561120399833D+08,
     *    0.389475256846287072D+09,
     *   -0.185061750387419939D+10,
     *    0.863790655526251411D+10,
     *   -0.610786245324980354D+10,
     *   -0.113564433353826714D+11,
     *    0.205130332369458466D+11,
     *   -0.139840432966091442D+11,
     *   -0.316573733772571325D+10,
     *    0.293331474232156219D+11,
     *   -0.582497846400255814D+11,
     *    0.744730915715721893D+11,
     *   -0.582628940345717468D+11,
     *    0.193434034129244308D+11,
     *   -0.353102959569033802D+09,
     *    0.594331378622876167D+09,
     *    0.156942603014107466D+09,
     *   -0.598262432289071083D+08,
     *    0.198820562463828325D+08,
     *   -0.544129626798272133D+07,
     *    0.164229230362820625D+07,
     *   -0.494159391621589661D+06,
     *    0.148258510460853577D+06,
     *   -0.443579979121685028D+05,
     *    0.132367935072183609D+05,
     *   -0.393999008274078369D+04,
     *    0.116975523090362549D+04,
     *   -0.346346384048461914D+03,
     *    0.102416865944862366D+03,
     *   -0.305214300155639648D+02,
     *    0.936190891265869141D+01,
     *   -0.301590728759765625D+01,
     *    0.115453997254371643D+01,
     *   -0.925188779830932617D+00,
     *    0.113781023025512695D+01,
     *   -0.104867029190063477D+01,
     *    0.732403278350830078D+00,
     *   -0.748680353164672852D+00,
     *    0.109043306112289429D+01,
     *   -0.938838481903076172D+00,
     *   -0.372810363769531250D-01,
     *    0.102392578125000000D+01,
     *   -0.132894897460937500D+01,
     *    0.982195854187011719D+00,
     *   -0.303641319274902344D+00,
     *   -0.271643638610839844D+00,
     *    0.625254392623901367D+00,
     *   -0.102527689933776855D+01,
     *    0.152677059173583984D+01,
     *   -0.166122913360595703D+01,
     *    0.115121650695800781D+01,
     *   -0.501752853393554688D+00,
     *    0.222784042358398438D+00,
     *   -0.402000427246093750D+00,
     *    0.120312118530273438D+01,
     *   -0.262604999542236328D+01,
     *    0.358502960205078125D+01,
     *   -0.263280940055847168D+01,
     *    0.925936698913574219D-01,
     *    0.205823516845703125D+01,
     *   -0.269997406005859375D+01,
     *    0.234772109985351563D+01,
     *   -0.179497528076171875D+01,
     *    0.102694702148437500D+01,
     *    0.132196998596191406D+01,
     *   -0.525640296936035156D+01,
     *    0.632808494567871094D+01,
     *   -0.110423851013183594D+01,
     *   -0.623471927642822266D+01,
     *    0.897164630889892578D+01,
     *   -0.639104700088500977D+01,
     *    0.207760357856750488D+01,
     *    0.184128284454345703D+01,
     *   -0.365056371688842773D+01,
     *    0.182292842864990234D+01,
     *    0.135415458679199219D+01,
     *   -0.350045108795166016D+01,
     *    0.502853775024414063D+01,
     *   -0.458313941955566406D+01,
     *    0.135558509826660156D+01,
     *    0.207130241394042969D+01,
     *   -0.398905563354492188D+01,
     *    0.265617752075195313D+01,
     *    0.182014369964599609D+01,
     *   -0.313538932800292969D+01,
     *   -0.698763847351074219D+00,
     *    0.441944408416748047D+01,
     *   -0.794850444793701172D+01,
     *    0.118099188804626465D+02,
     *   -0.103262481689453125D+02,
     *    0.597875608503818512D+01,
     *   -0.859755039215087891D+01,
     *    0.155139536857604980D+02,
     *   -0.158831710815429688D+02,
     *    0.900578117370605469D+01,
     *   -0.472886466979980469D+01,
     *    0.914161872863769531D+01,
     *   -0.145610685348510742D+02,
     *    0.134424781799316406D+02,
     *   -0.131153049468994141D+02,
     *    0.169562950134277344D+02,
     *   -0.140343360900878906D+02,
     *    0.456685066223144531D+01/
C Kernel parameters
      M=5
C
C      EVALUATE PES    
       SUMA=ZERO
       DO I=1,NPT
        SUMA=SUMA+VCOEF(I)*RKHS_DKN2(R(I),RR,M)
       END DO
       VL2_v2_4=SUMA
       RETURN
       END
C PROGRAM TO GENERATE 1-D RKHS FITS OF Vl2
C COEFFICIENTS IN LEGENDRE
C ANGULAR EXPANSION OF Ar-CN(A,v=2)
C DISTANCE IS IN BOHR
C EXPANSION COEFFFICIENTS IN CM-1
C REPRODUCING KERNEL HILBERT SPACE METHOD
C AUTHOR: Jacek Klos, University of Maryland
C Department of Chemistry, College Park,MD
C---OPTIMIZED FOR EXECUTION TIME BY DIRECT
C---EXPRESIONS OF HYPERGEOMETRIC AND BETA FUNCTIONS
C

      FUNCTION VL2_v2_5(RR)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NPT=107)
      DIMENSION VAB(NPT),VCOEF(NPT)
      DIMENSION R(NPT),THETA(NPT)
      DATA R/
     .  3.500D0,
     .  3.750D0,
     .  4.000D0,
     .  4.250D0,
     .  4.500D0,
     .  4.750D0,
     .  5.000D0,
     .  5.250D0,
     .  5.500D0,
     .  5.750D0,
     .  6.000D0,
     .  6.250D0,
     .  6.500D0,
     .  6.750D0,
     .  7.000D0,
     .  7.250D0,
     .  7.500D0,
     .  7.750D0,
     .  8.000D0,
     .  8.250D0,
     .  8.500D0,
     .  8.750D0,
     .  9.000D0,
     .  9.250D0,
     .  9.500D0,
     .  9.750D0,
     . 10.000D0,
     . 10.250D0,
     . 10.500D0,
     . 10.750D0,
     . 11.000D0,
     . 11.250D0,
     . 11.500D0,
     . 11.750D0,
     . 12.000D0,
     . 12.250D0,
     . 12.500D0,
     . 12.750D0,
     . 13.000D0,
     . 13.250D0,
     . 13.500D0,
     . 13.750D0,
     . 14.000D0,
     . 14.250D0,
     . 14.500D0,
     . 14.750D0,
     . 15.000D0,
     . 15.250D0,
     . 15.500D0,
     . 15.750D0,
     . 16.000D0,
     . 16.250D0,
     . 16.500D0,
     . 16.750D0,
     . 17.000D0,
     . 17.250D0,
     . 17.500D0,
     . 17.750D0,
     . 18.000D0,
     . 18.250D0,
     . 18.500D0,
     . 18.750D0,
     . 19.000D0,
     . 19.250D0,
     . 19.500D0,
     . 19.750D0,
     . 20.000D0,
     . 20.250D0,
     . 20.500D0,
     . 20.750D0,
     . 21.000D0,
     . 21.250D0,
     . 21.500D0,
     . 21.750D0,
     . 22.000D0,
     . 22.250D0,
     . 22.500D0,
     . 22.750D0,
     . 23.000D0,
     . 23.250D0,
     . 23.500D0,
     . 23.750D0,
     . 24.000D0,
     . 24.250D0,
     . 24.500D0,
     . 24.750D0,
     . 25.000D0,
     . 25.250D0,
     . 25.500D0,
     . 25.750D0,
     . 26.000D0,
     . 26.250D0,
     . 26.500D0,
     . 26.750D0,
     . 27.000D0,
     . 27.250D0,
     . 27.500D0,
     . 27.750D0,
     . 28.000D0,
     . 28.250D0,
     . 28.500D0,
     . 28.750D0,
     . 29.000D0,
     . 29.250D0,
     . 29.500D0,
     . 29.750D0,
     . 30.000D0/
      DATA VCOEF/
     *    0.437430702038419258D+05,
     *    0.562087247260249103D+06,
     *   -0.362186103068597708D+07,
     *    0.127302794971397556D+08,
     *   -0.497366318895263672D+08,
     *    0.233792150263017356D+09,
     *   -0.111880690884085393D+10,
     *    0.523255164100811386D+10,
     *   -0.858707607226926422D+10,
     *    0.871790471265742493D+10,
     *   -0.100245478185217285D+11,
     *    0.137112167996148148D+11,
     *   -0.232465637422053719D+11,
     *    0.308529395388170967D+11,
     *   -0.236170541407451935D+11,
     *    0.581149985400893784D+10,
     *    0.111525785841227264D+11,
     *   -0.179810313956451492D+11,
     *    0.129494120765984421D+11,
     *   -0.554117439338127708D+10,
     *    0.199048874327253151D+10,
     *   -0.646201477718023300D+09,
     *    0.195174875817803144D+09,
     *   -0.586966737336789370D+08,
     *    0.177158307644817680D+08,
     *   -0.533062205330604967D+07,
     *    0.159929819208532572D+07,
     *   -0.478495751517713070D+06,
     *    0.142784528790175915D+06,
     *   -0.425002828435897827D+05,
     *    0.126199540829658508D+05,
     *   -0.373857718455791473D+04,
     *    0.110482360100746155D+04,
     *   -0.325601805001497269D+03,
     *    0.957500544786453247D+02,
     *   -0.282089722156524658D+02,
     *    0.839758348464965820D+01,
     *   -0.264876627922058105D+01,
     *    0.110372900962829590D+01,
     *   -0.761255264282226562D+00,
     *    0.771248221397399902D+00,
     *   -0.836806774139404297D+00,
     *    0.703304767608642578D+00,
     *   -0.313158512115478516D+00,
     *   -0.270510673522949219D+00,
     *    0.843412399291992188D+00,
     *   -0.102189111709594727D+01,
     *    0.644318938255310059D+00,
     *    0.144120454788208008D-01,
     *   -0.456959247589111328D+00,
     *    0.350673198699951172D+00,
     *    0.263871192932128906D+00,
     *   -0.974827289581298828D+00,
     *    0.109938955307006836D+01,
     *   -0.434201717376708984D+00,
     *   -0.410982608795166016D+00,
     *    0.971377044916152954D+00,
     *   -0.120032882690429688D+01,
     *    0.116364336013793945D+01,
     *   -0.116816377639770508D+01,
     *    0.130358219146728516D+01,
     *   -0.127111434936523438D+01,
     *    0.119548797607421875D+01,
     *   -0.126442146301269531D+01,
     *    0.771535396575927734D+00,
     *    0.538326263427734375D+00,
     *   -0.145039606094360352D+01,
     *    0.115048301219940186D+01,
     *   -0.747216939926147461D-01,
     *   -0.824886560440063477D+00,
     *    0.672283649444580078D+00,
     *    0.229861259460449219D+00,
     *   -0.117250442504882813D+01,
     *    0.188537979125976563D+01,
     *   -0.151747608184814453D+01,
     *   -0.343658447265625000D+00,
     *    0.264640617370605469D+01,
     *   -0.376461887359619141D+01,
     *    0.323643779754638672D+01,
     *   -0.251279830932617188D+01,
     *    0.206624078750610352D+01,
     *   -0.465073585510253906D+00,
     *   -0.283670949935913086D+01,
     *    0.607406663894653320D+01,
     *   -0.587421810626983643D+01,
     *    0.199330791831016541D+01,
     *    0.336611151695251465D+00,
     *    0.990684270858764648D+00,
     *   -0.151344966888427734D+01,
     *   -0.997521400451660156D+00,
     *    0.490479898452758789D+01,
     *   -0.861562824249267578D+01,
     *    0.968598890304565430D+01,
     *   -0.674419164657592773D+01,
     *    0.349489688873291016D+01,
     *   -0.428297138214111328D+01,
     *    0.814800071716308594D+01,
     *   -0.132496881484985352D+02,
     *    0.197101740837097168D+02,
     *   -0.246612973213195801D+02,
     *    0.237155818939208984D+02,
     *   -0.154841442108154297D+02,
     *    0.348773479461669922D+01,
     *    0.232947874069213867D+01,
     *    0.160942649841308594D+01,
     *   -0.458299112319946289D+01,
     *    0.194691085815429688D+01/
C Kernel parameters
      M=5
C
C      EVALUATE PES    
       SUMA=ZERO
       DO I=1,NPT
        SUMA=SUMA+VCOEF(I)*RKHS_DKN2(R(I),RR,M)
       END DO
       VL2_v2_5=SUMA
       RETURN
       END

C------RKHS ROUTINES

C------------------------RKHS---------------------------------
C Fortran  Deck with distance-like and angular-like 
C kernels for RKHS interpolation method
C****************************************************
C* By J. KLOS  12/05/2007   University of Maryland  *
C* REVISON: 1.0                                     * 
C* jasztol@gmail.com                                *
C****************************************************
C-------------------------------------------------------------
C FUNCTIONS:
C
C RKHS_DK(X,Y,N,M): Reproducing kernel for  distance-like (DK) 
C                   variables, see Ho, Rabitz Eq(17) of
C                   J. Chem. Phys. 104, 2584 (1996) 
C                   Range = [0, inf]
C
C  INPUT: X,Y-DOUBLE PRECISION
C          N:INTEGER:ORDER OF SMOOTHNESS OF THE FUNCTION
C          M>=0:INTEGER:RECIPROCAL POWER OF THE WEIGHT W(X)=X**(-M)
C  OUTPUT: DOUBLE PRECISION
C -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -            
C RKHS_AK(X,Y,N): Reproducing kernel for  angular-like (AK) 
C                   variables, see Ho, Rabitz Eq(23) of
C                   J. Chem. Phys. 104, 2584 (1996) 
C                    Range = [0, 1]
C    
C  INPUT: X,Y-DOUBLE PRECISION
C          N:INTEGER:ORDER OF SMOOTHNESS OF THE FUNCTION
C  OUPUT: DOUBLE PRECISION
C  HINT: SCALE ANGLES TO [0,1] INTEGRAL FOR ANGLES, FOR EXAMPLE: 
C          X=(1.d0-cosd(ANGLE))/2.d0
C -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -
C RKHS_OP(X,Y,N,M):Reproducing kernel for angular like 
C                    variables with a use of orthogonal 
C                    polynomials Plm(L,M,X) where X is 
C                    K=SUM_L=M^N PLM(X)PLM(X')
C                    variable transformed from angles as
C                    x=cos(theta)
C-------------------------------------------------------------
       DOUBLE PRECISION FUNCTION RKHS_DKN2(X,Y,M)
       IMPLICIT DOUBLE PRECISION (A-H,O-Z)
       IF (X .LT. Y) THEN
           XB=X
           XU=Y
       ELSE
           XB=Y
           XU=X
       ENDIF

C       M=ABS(M)! FORCE M>=0
       NSQR=4
       XUPOWM=XU**(-(M+1))

C      TERM WITH BETA FUNCTION
C       CALL BETA(DFLOAT(M+1),DFLOAT(N),BETATERM)
C      N=2 case direct expression
       BETATERM=1.D0/DFLOAT((M+1)*(M+2))

C      GET TERM WITH 2F1 HYPERGEOMETRIC  GAUSS FUNCTION
C       CALL HYGFX(DFLOAT(-N+1),DFLOAT(M+1),DFLOAT(N+M+1),XB/XU,HF)
C      DIRECT EXPRESSION FOR 2F1 WITH N=2 case
       HF=1.D0-(XB/XU)*(DFLOAT(M+1)/DFLOAT(M+3))
       RKHS_DKN2=NSQR*XUPOWM*BETATERM*HF
       RETURN
       END

       DOUBLE PRECISION FUNCTION RKHS_DK(X,Y,N,M)
       IMPLICIT DOUBLE PRECISION (A-H,O-Z)
       IF (X .LT. Y) THEN
           XB=X
           XU=Y
       ELSE
           XB=Y
           XU=X
       ENDIF

C       M=ABS(M)! FORCE M>=0
       NSQR=N*N
       XUPOWM=XU**(-(M+1))

C      TERM WITH BETA FUNCTION
       CALL BETA(DFLOAT(M+1),DFLOAT(N),BETATERM)

C      GET TERM WITH 2F1 HYPERGEOMETRIC  GAUSS FUNCTION
       CALL HYGFX(DFLOAT(-N+1),DFLOAT(M+1),DFLOAT(N+M+1),XB/XU,HF)
       RKHS_DK=NSQR*XUPOWM*BETATERM*HF
       RETURN
       END

C-------------------------------------------------------------
       DOUBLE PRECISION FUNCTION RKHS_EXPR(X,Y,XE,N)
       IMPLICIT DOUBLE PRECISION (A-H,O-Z)
       PARAMETER (ZERO=0.D0,ONE=1.D0)
       
       SUMA=ZERO
       Z1=(X-XE)/XE
       Z2=(Y-XE)/XE
       DO I=0,N
       SUMA=SUMA+(Z1**I)*(Z2**I)
       ENDDO

       RKHS_EXPR=SUMA
       RETURN
       END


C-------------------------------------------------------------
       DOUBLE PRECISION FUNCTION RKHS_AK(X,Y,N)
       IMPLICIT DOUBLE PRECISION (A-H,O-Z)
       PARAMETER (ZERO=0.D0,ONE=1.D0)
       
       IF ((X.EQ.ZERO).OR.(Y.EQ.ZERO)) THEN
          RKHS_AK=ONE
          RETURN
       ENDIF
       IF (X .LT. Y) THEN
           XB=X
           XU=Y
       ELSE
           XB=Y
           XU=X
       ENDIF

       SUMA=ZERO
C      GET POLYNOMIAL TERM
       DO I=0,N-1
       SUMA=SUMA+(XU**I)*(XB**I)
       END DO

C      GET TERM WITH 2F1 HYPERGEOMETRIC  GAUSS FUNCTION
       CALL HYGFX(DFLOAT(1),DFLOAT(-N+1),DFLOAT(N+1),XB/XU,HF)
       
       RKHS_AK=SUMA+N*(XB**N)*(XU**(N-1))*HF
       RETURN
       END

       DOUBLE PRECISION FUNCTION RKHS_AKN2(X,Y)
       IMPLICIT DOUBLE PRECISION (A-H,O-Z)
       PARAMETER (ZERO=0.D0,ONE=1.D0)
       
       IF ((X.EQ.ZERO).OR.(Y.EQ.ZERO)) THEN
          RKHS_AKN2=ONE
          RETURN
       ENDIF 
       IF (X .LT. Y) THEN
           XB=X
           XU=Y
       ELSE
           XB=Y
           XU=X
       ENDIF

C      GET POLYNOMIAL TERM
       SUMA=1.D0+XU*XB

C      GET TERM WITH 2F1 HYPERGEOMETRIC  GAUSS FUNCTION
C       CALL HYGFX(DFLOAT(1),DFLOAT(-N+1),DFLOAT(N+1),XB/XU,HF)
       HF=1.D0-(XB/XU)/3.D0
       
       RKHS_AKN2=SUMA+2.D0*(XB**2)*XU*HF
       RETURN
       END


       DOUBLE PRECISION FUNCTION RKHS_OP(X,Y,N,M)
       IMPLICIT DOUBLE PRECISION (A-H,O-Z)
       PARAMETER (ZERO=0.D0,ONE=1.D0)

       SUMA=ZERO
C      GET ORTHOGONAL POLYNOMIAL TERM
       DO I=ABS(M),N
       SUMA=SUMA+PLGNDR(I,M,X)*PLGNDR(I,M,Y)
       END DO
       RKHS_OP=SUMA
       RETURN
       END

       DOUBLE PRECISION FUNCTION RKHS_OP2L(X,Y,N,M)
       IMPLICIT DOUBLE PRECISION (A-H,O-Z)
       PARAMETER (ZERO=0.D0,ONE=1.D0)
 
       SUMA=ZERO
C      GET ORTHOGONAL POLYNOMIAL TERM
       DO I=ABS(M),N,2
       SUMA=SUMA+PLGNDR(I,M,X)*PLGNDR(I,M,Y)
       END DO
       RKHS_OP2L=SUMA
       RETURN
       END


            


      FUNCTION PLGNDR(L,M,x)
      IMPLICIT DOUBLE PRECISION (A-H, O-Z)
      if(m.lt.0.or.m.gt.l.or.abs(x).gt.1.)pause
     *'bad arguments in plgndr'
      pmm=1.
      if(m.gt.0) then
        somx2=dsqrt((1.-x)*(1.+x))
        fact=1.
        do 11 i=1,m
          pmm=-pmm*fact*somx2
          fact=fact+2.
11      continue
      endif
      if(l.eq.m) then
        plgndr=pmm
      else
        pmmp1=x*(2*m+1)*pmm
        if(l.eq.m+1) then
          plgndr=pmmp1
        else
         do 12 ll=m+2,l
            pll=(x*(2*ll-1)*pmmp1-(ll+m-1)*pmm)/(ll-m)
            pmm=pmmp1
            pmmp1=pll
12        continue
          plgndr=pll
        endif
      endif
      return
      END



        SUBROUTINE BETA(P,Q,BT)
C
C       ==========================================
C       Purpose: Compute the beta function B(p,q)
C       Input :  p  --- Parameter  ( p > 0 )
C                q  --- Parameter  ( q > 0 )
C       Output:  BT --- B(p,q)
C       Routine called: GAMMA for computing gamma(x)
C       ==========================================
C
        IMPLICIT DOUBLE PRECISION (A-H,O-Z)
        CALL GAMMA(P,GP)
        CALL GAMMA(Q,GQ)
        PPQ=P+Q
        CALL GAMMA(PPQ,GPQ)
        BT=GP*GQ/GPQ
        RETURN
        END


        SUBROUTINE GAMMA(X,GA)
C
C       ==================================================
C       Purpose: Compute gamma function (x)
C       Input :  x  --- Argument of ( x )
C                       ( x is not equal to 0,-1,-2,...)
C       Output:  GA --- (x)
C       ==================================================
C
        IMPLICIT DOUBLE PRECISION (A-H,O-Z)
        DIMENSION G(26)
        PI=3.141592653589793D0
        IF (X.EQ.INT(X)) THEN
           IF (X.GT.0.0D0) THEN
              GA=1.0D0
              M1=X-1
              DO 10 K=2,M1
10               GA=GA*K
           ELSE
              GA=1.0D+300
           ENDIF
        ELSE
           IF (DABS(X).GT.1.0D0) THEN
              Z=DABS(X)
              M=INT(Z)
              R=1.0D0
              DO 15 K=1,M
15               R=R*(Z-K)
              Z=Z-M
           ELSE
              Z=X
           ENDIF
           DATA G/1.0D0,0.5772156649015329D0,
     &          -0.6558780715202538D0, -0.420026350340952D-1,
     &          0.1665386113822915D0,-.421977345555443D-1,
     &          -.96219715278770D-2, .72189432466630D-2,
     &          -.11651675918591D-2, -.2152416741149D-3,
     &          .1280502823882D-3, -.201348547807D-4,
     &          -.12504934821D-5, .11330272320D-5,
     &          -.2056338417D-6, .61160950D-8,
     &          .50020075D-8, -.11812746D-8,
     &          .1043427D-9, .77823D-11,
     &          -.36968D-11, .51D-12,
     &          -.206D-13, -.54D-14, .14D-14, .1D-15/
           GR=G(26)
           DO 20 K=25,1,-1
20            GR=GR*Z+G(K)
           GA=1.0D0/(GR*Z)
           IF (DABS(X).GT.1.0D0) THEN
              GA=GA*R
              IF (X.LT.0.0D0) GA=-PI/(X*GA*DSIN(PI*X))
           ENDIF
        ENDIF
        RETURN
        END



        SUBROUTINE HYGFX(A,B,C,X,HF)
C
C       ====================================================
C       Purpose: Compute hypergeometric function F(a,b,c,x)
C       Input :  a --- Parameter
C                b --- Parameter
C                c --- Parameter, c <> 0,-1,-2,...
C                x --- Argument   ( x < 1 )
C       Output:  HF --- F(a,b,c,x)
C       Routines called:
C            (1) GAMMA for computing gamma function
C            (2) PSI_AAA for computing psi function
C       ====================================================
C
        IMPLICIT DOUBLE PRECISION (A-H,O-Z)
        LOGICAL L0,L1,L2,L3,L4,L5
        PI=3.141592653589793D0
        EL=.5772156649015329D0
        L0=C.EQ.INT(C).AND.C.LT.0.0
        L1=1.0D0-X.LT.1.0D-15.AND.C-A-B.LE.0.0
        L2=A.EQ.INT(A).AND.A.LT.0.0
        L3=B.EQ.INT(B).AND.B.LT.0.0
        L4=C-A.EQ.INT(C-A).AND.C-A.LE.0.0
        L5=C-B.EQ.INT(C-B).AND.C-B.LE.0.0
        IF (L0.OR.L1) THEN
           WRITE(*,*)'The hypergeometric series is divergent'
           RETURN
        ENDIF
        EPS=1.0D-15
        IF (X.GT.0.95) EPS=1.0D-8
        IF (X.EQ.0.0.OR.A.EQ.0.0.OR.B.EQ.0.0) THEN
           HF=1.0D0
           RETURN
        ELSE IF (1.0D0-X.EQ.EPS.AND.C-A-B.GT.0.0) THEN
           CALL GAMMA(C,GC)
           CALL GAMMA(C-A-B,GCAB)
           CALL GAMMA(C-A,GCA)
           CALL GAMMA(C-B,GCB)
           HF=GC*GCAB/(GCA*GCB)
           RETURN
        ELSE IF (1.0D0+X.LE.EPS.AND.DABS(C-A+B-1.0).LE.EPS) THEN
           G0=DSQRT(PI)*2.0D0**(-A)
           CALL GAMMA(C,G1)
           CALL GAMMA(1.0D0+A/2.0-B,G2)
           CALL GAMMA(0.5D0+0.5*A,G3)
           HF=G0*G1/(G2*G3)
           RETURN
        ELSE IF (L2.OR.L3) THEN
           IF (L2) NM=INT(ABS(A))
           IF (L3) NM=INT(ABS(B))
           HF=1.0D0
           R=1.0D0
           DO 10 K=1,NM
              R=R*(A+K-1.0D0)*(B+K-1.0D0)/(K*(C+K-1.0D0))*X
10            HF=HF+R
           RETURN
        ELSE IF (L4.OR.L5) THEN
           IF (L4) NM=INT(ABS(C-A))
           IF (L5) NM=INT(ABS(C-B))
           HF=1.0D0
           R=1.0D0
           DO 15 K=1,NM
              R=R*(C-A+K-1.0D0)*(C-B+K-1.0D0)/(K*(C+K-1.0D0))*X
15            HF=HF+R
           HF=(1.0D0-X)**(C-A-B)*HF
           RETURN
        ENDIF
        AA=A
        BB=B
        X1=X
        IF (X.LT.0.0D0) THEN
           X=X/(X-1.0D0)
           IF (C.GT.A.AND.B.LT.A.AND.B.GT.0.0) THEN
              A=BB
              B=AA
           ENDIF
           B=C-B
        ENDIF
        IF (X.GE.0.75D0) THEN
           GM=0.0D0
           IF (DABS(C-A-B-INT(C-A-B)).LT.1.0D-15) THEN
              M=INT(C-A-B)
              CALL GAMMA(A,GA)
              CALL GAMMA(B,GB)
              CALL GAMMA(C,GC)
              CALL GAMMA(A+M,GAM)
              CALL GAMMA(B+M,GBM)
              CALL PSI_AAA(A,PA)
              CALL PSI_AAA(B,PB)
              IF (M.NE.0) GM=1.0D0
              DO 30 J=1,ABS(M)-1
30               GM=GM*J
              RM=1.0D0
              DO 35 J=1,ABS(M)
35               RM=RM*J
              F0=1.0D0
              R0=1.0D0
              R1=1.0D0
              SP0=0.D0
              SP=0.0D0
              IF (M.GE.0) THEN
                 C0=GM*GC/(GAM*GBM)
                 C1=-GC*(X-1.0D0)**M/(GA*GB*RM)
                 DO 40 K=1,M-1
                    R0=R0*(A+K-1.0D0)*(B+K-1.0)/(K*(K-M))*(1.0-X)
40                  F0=F0+R0
                 DO 45 K=1,M
45                  SP0=SP0+1.0D0/(A+K-1.0)+1.0/(B+K-1.0)-1.0/K
                 F1=PA+PB+SP0+2.0D0*EL+DLOG(1.0D0-X)
                 DO 55 K=1,250
                    SP=SP+(1.0D0-A)/(K*(A+K-1.0))+(1.0-B)/(K*(B+K-1.0))
                    SM=0.0D0
                    DO 50 J=1,M
50                     SM=SM+(1.0D0-A)/((J+K)*(A+J+K-1.0))+1.0/
     &                    (B+J+K-1.0)
                    RP=PA+PB+2.0D0*EL+SP+SM+DLOG(1.0D0-X)
                    R1=R1*(A+M+K-1.0D0)*(B+M+K-1.0)/(K*(M+K))*(1.0-X)
                    F1=F1+R1*RP
                    IF (DABS(F1-HW).LT.DABS(F1)*EPS) GO TO 60
55                  HW=F1
60               HF=F0*C0+F1*C1
              ELSE IF (M.LT.0) THEN
                 M=-M
                 C0=GM*GC/(GA*GB*(1.0D0-X)**M)
                 C1=-(-1)**M*GC/(GAM*GBM*RM)
                 DO 65 K=1,M-1
                    R0=R0*(A-M+K-1.0D0)*(B-M+K-1.0)/(K*(K-M))*(1.0-X)
65                  F0=F0+R0
                 DO 70 K=1,M
70                  SP0=SP0+1.0D0/K
                 F1=PA+PB-SP0+2.0D0*EL+DLOG(1.0D0-X)
                 DO 80 K=1,250
                    SP=SP+(1.0D0-A)/(K*(A+K-1.0))+(1.0-B)/(K*(B+K-1.0))
                    SM=0.0D0
                    DO 75 J=1,M
75                     SM=SM+1.0D0/(J+K)
                    RP=PA+PB+2.0D0*EL+SP-SM+DLOG(1.0D0-X)
                    R1=R1*(A+K-1.0D0)*(B+K-1.0)/(K*(M+K))*(1.0-X)
                    F1=F1+R1*RP
                    IF (DABS(F1-HW).LT.DABS(F1)*EPS) GO TO 85
80                  HW=F1
85               HF=F0*C0+F1*C1
              ENDIF
           ELSE
              CALL GAMMA(A,GA)
              CALL GAMMA(B,GB)
              CALL GAMMA(C,GC)
              CALL GAMMA(C-A,GCA)
              CALL GAMMA(C-B,GCB)
              CALL GAMMA(C-A-B,GCAB)
              CALL GAMMA(A+B-C,GABC)
              C0=GC*GCAB/(GCA*GCB)
              C1=GC*GABC/(GA*GB)*(1.0D0-X)**(C-A-B)
              HF=0.0D0
              R0=C0
              R1=C1
              DO 90 K=1,250
                 R0=R0*(A+K-1.0D0)*(B+K-1.0)/(K*(A+B-C+K))*(1.0-X)
                 R1=R1*(C-A+K-1.0D0)*(C-B+K-1.0)/(K*(C-A-B+K))
     &              *(1.0-X)
                 HF=HF+R0+R1
                 IF (DABS(HF-HW).LT.DABS(HF)*EPS) GO TO 95
90               HW=HF
95            HF=HF+C0+C1
           ENDIF
        ELSE
           A0=1.0D0
           IF (C.GT.A.AND.C.LT.2.0D0*A.AND.
     &         C.GT.B.AND.C.LT.2.0D0*B) THEN
              A0=(1.0D0-X)**(C-A-B)
              A=C-A
              B=C-B
           ENDIF
           HF=1.0D0
           R=1.0D0
           DO 100 K=1,250
              R=R*(A+K-1.0D0)*(B+K-1.0D0)/(K*(C+K-1.0D0))*X
              HF=HF+R
              IF (DABS(HF-HW).LE.DABS(HF)*EPS) GO TO 105
100           HW=HF
105        HF=A0*HF
        ENDIF
        IF (X1.LT.0.0D0) THEN
           X=X1
           C0=1.0D0/(1.0D0-X)**AA
           HF=C0*HF
        ENDIF
        A=AA
        B=BB
        IF (K.GT.120) WRITE(*,115)
115     FORMAT(1X,'Warning! You should check the accuracy')
        RETURN
        END



        SUBROUTINE PSI_AAA(X,PS)
C
C       ======================================
C       Purpose: Compute Psi function
C       Input :  x  --- Argument of psi(x)
C       Output:  PS --- psi(x)
C       ======================================
C
        IMPLICIT DOUBLE PRECISION (A-H,O-Z)
        XA=DABS(X)
        PI=3.141592653589793D0
        EL=.5772156649015329D0
        S=0.0D0
        IF (X.EQ.INT(X).AND.X.LE.0.0) THEN
           PS=1.0D+300
           RETURN
        ELSE IF (XA.EQ.INT(XA)) THEN
           N=XA
           DO 10 K=1 ,N-1
10            S=S+1.0D0/K
           PS=-EL+S
        ELSE IF (XA+.5.EQ.INT(XA+.5)) THEN
           N=XA-.5
           DO 20 K=1,N
20            S=S+1.0/(2.0D0*K-1.0D0)
           PS=-EL+2.0D0*S-1.386294361119891D0
        ELSE
           IF (XA.LT.10.0) THEN
              N=10-INT(XA)
              DO 30 K=0,N-1
30               S=S+1.0D0/(XA+K)
              XA=XA+N
           ENDIF
           X2=1.0D0/(XA*XA)
           A1=-.8333333333333D-01
           A2=.83333333333333333D-02
           A3=-.39682539682539683D-02
           A4=.41666666666666667D-02
           A5=-.75757575757575758D-02
           A6=.21092796092796093D-01
           A7=-.83333333333333333D-01
           A8=.4432598039215686D0
           PS=DLOG(XA)-.5D0/XA+X2*(((((((A8*X2+A7)*X2+
     &        A6)*X2+A5)*X2+A4)*X2+A3)*X2+A2)*X2+A1)
           PS=PS-S
        ENDIF
        IF (X.LT.0.0) PS=PS-PI*DCOS(PI*X)/DSIN(PI*X)-1.0D0/X
        RETURN
        END
