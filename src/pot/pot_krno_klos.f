* System:  NO(X 2Pi)+Kr, initio RCCSD(T) PES's
* Bo Wen, H. Meyer, J. Kłos, M. H. Alexander, "A joint experimental-theoretical investigation of the bound states of the NO(X2Π)- Kr complex" J. Phys. Chem. A, 113, 7366 (2009) 
*  Sarantos Marinakis, Brian J. Howard, F. J. Aoiz, Jacek Kłos "Product rotational alignment in NO(X)+Kr collisions" Chem. Phys. Lett. 512,161 (2011) 


      subroutine driver
      implicit double precision (a-h,o-z)
      common /cosysr/ xjunk(2),rshift,xfact
      common /covvl/ vvl(11)
      include "common/parpot"
      potnam='Klos et al Kr-NO(X2PI) RCCSDT avtz+33221+ ECP PES'
      print *, potnam
1      print *, ' r (bohr)'
      rshift=0.5
      xfact=0.8
      read (5, *, end=99) r
      call pot(vv0,r)
      write (6, 100) vv0,vvl
100   format(' vsum',/,7(1pe16.8),/,
     :    '  vdif',/,5e16.8)
      goto 1
99    end

      include "common/syusr"
      include "common/bausr"
      include "common/ground"
      subroutine loapot(iunit,filnam)
* ------------------------------------------------------------------------
      character*(*) filnam
      include "common/parbas"
      include "common/parpot"
      potnam='Klos et al Kr-NO(X2PI) RCCSDT PES'
** ccsdt potential for 7 angles **
      lammin(1)=1
      lammax(1)=6
      lammin(2)=2
      lammax(2)=6
      mproj(1)=0
      mproj(2)=2
      ntv(1)=1
      ivcol(1,1)=0
      ivrow(1,1)=0
      return
      end
* ----------------------------------------------------------------------
      subroutine pot (vv0, r)
*  subroutine to calculate the r-dependent coefficients
*  in atomic units (distance and energy)
* ----------------------------------------------------------------------
*  on entry:
*    r:      interparticle distance
*  on return:
*  vv0        contains isotropic term (d00 term in vsum)
*  variable in common block /covvl/
*    vvl:     vector of length 6 to store r-dependence of each term
*             in potential expansion
*    vvl(1-6) expansion coefficients in dl0 (l=1:6) of vsum
*    vvl(7-11) expansion coefficients in dl2 (l=2:6) of vdif

* uses linear least squares routines from cmlib

* author:  millard alexander
* latest revision date:  8-oct-1993
* revised for He-NO(X) : 1-20-95 by Moonbong Yang
* revised for Xe-NO RCCSD(T) PES: 2003.1.1 by Jacek Klos
* 0 degree for Xe-NO and 180 for Xe-ON
* ----------------------------------------------------------------------

      implicit double precision (a-h,o-z)
      dimension xlam1(14),xlam2(14),r0(14),c1(14),c2(14),c3(14),
     :          clr(14),vsum(7),xsum(7),vdif(7),xdif(7),
     :          ddif(7),vap(7),va2p(7),
     :          d0(49),d2(25),aa(64)
      dimension kpvt(8),qraux(7),work(55),rsd(7),re(14)

      common /covvl/ vvl(11)
      data half, zero, one, alph /0.5d0, 0.d0, 1.d0, 1.2d0/
* for distances beyond rmax difference potential is damped
      data rmax /15d0/
* coefficicients for d0 rotation matrices
* stored (by column) for each of 7 angles and for l=0:6
* angles are 0 30 60 90 120 150 180
      data d0/
     : 1d0,  1d0,  1d0,  1d0,  1d0,  1d0,  1d0,
     : 1d0,  8.6602541d-1,  5.0000001d-1,  1.3349125d-8, -4.9999998d-1,
     : -8.6602539d-1, -1d0,
     : 1d0,  6.2500001d-1, -1.2499999d-1, -5.0000000d-1, -1.2500002d-1,
     : 6.2499997d-1,  1d0,
     : 1d0,  3.2475954d-1, -4.3750000d-1, -2.0023687d-8,  4.3750001d-1,
     : -3.2475948d-1, -1d0,
     : 1d0,  2.3437511d-2, -2.8906251d-1,  3.7500000d-1, -2.8906248d-1,
     : 2.3437446d-2,  1d0,
     : 1d0, -2.2327216d-1,  8.9843733d-2,  2.5029609d-8, -8.9843784d-2,
     : 2.2327222d-1, -1d0,
     : 1d0, -3.7402343d-1,  3.2324218d-1, -3.1250000d-1,  3.2324220d-1,
     : -3.7402346d-1,  1d0/
* coefficicients for d2 rotation matrices
* stored (by column) for each of 5 angles and for l=2:6
* angles are 30 60 90 120 150
      data d2/
     : 1.5309311d-1,  4.5927932d-1,  6.1237244d-1,  4.5927934d-1,
     : 1.5309312d-1,
     : 2.9646353d-1,  5.1348990d-1,  1.8279042d-8, -5.1348989d-1,
     : -2.9646355d-1,
     : 4.1999000d-1,  2.2234766d-1, -3.9528471d-1,  2.2234762d-1,
     : 4.1999002d-1,
     : 4.9023048d-1, -1.6982081d-1, -2.4180900d-8,  1.6982085d-1,
     : -4.9023049d-1,
     : 4.8532921d-1, -3.4523418d-1,  3.2021721d-1, -3.4523418d-1,
     : 4.8532920d-1/


* determine A' and A" potentials at angles
      do 100 i=1,7
        vap(i)=VAPRIMI(r,i)
        va2p(i)=VABISI(r,i)
        vsum(i)=half*(va2p(i)+vap(i))
* don't compute vdif for colinear geometries
        if (i.ne.1 .and. i.ne.7) then
          vdif(i-1)=half*(va2p(i)-vap(i))
* for long range damp out difference potential

          if (r .gt. rmax) then
            damp=-half*(tanh(3.d0*(r-rmax))-one)
            vdif(i-1)=vdif(i-1)*damp
          endif
        endif
100   continue
* solve simultaneous equations for solutions
* first for vsigma
      tol=1.e-10
      call dcopy(49,d0,1,aa,1)
      call dqrank(aa,7,7,7,tol,kr,kpvt,qraux,work)
      call dqrlss(aa,7,7,7,kr,vsum,xsum,rsd,kpvt,qraux)
* convert to hartree
      conv=1.d0/219474.6
      call dscal(7,conv,xsum,1)
      vv0=xsum(1)
      call dcopy(6,xsum(2),1,vvl,1)
      call dcopy(25,d2,1,aa,1)
      call dqrank(aa,5,5,5,tol,kr,kpvt,qraux,work)
      call dqrlss(aa,5,5,5,kr,vdif,xdif,rsd,kpvt,qraux)
      call dscal(5,conv,xdif,1)
      call dcopy(5,xdif,1,vvl(7),1)
      end
*Deck POT

      FUNCTION VAPRIMI(R,N)
CSYSTEM: NO-Kr Aprim state
CLEVEL:RHF/RCCSD[T]/
C units R=au E=cm-1
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      DIMENSION XX(16),XX1(16),XX2(16),XX3(16),
     * XX4(16),XX5(16),XX6(16),XX7(16)
C theta=0
      DATA XX1/
     *    0.125717367691647650D+01,
     *   -0.978788456532057790D+01,
     *    0.809782459815127500D+07,
     *   -0.639172054113550860D+07,
     *    0.226418936169679980D+07,
     *   -0.462915169840692370D+06,
     *    0.593745330221700790D+05,
     *   -0.487470347137828960D+04,
     *    0.249887894195171730D+03,
     *   -0.731566968806472500D+01,
     *    0.940572848879227050D-01,
     *    0.501466237891449600D+04,
     *    0.726629065829550770D+08,
     *    0.107510322343766670D+10,
     *   -0.377273093363379760D+12,
     *    0.975484777759294140D+13/
C theta=30
      DATA XX2/
     *   0.121709560373223070D+01,
     *  -0.648744687364050240D+01,
     *   0.713342089001057480D+07,
     *  -0.582025734719443320D+07,
     *   0.215785530873638670D+07,
     *  -0.460420332186074690D+06,
     *   0.609875287599588560D+05,
     *  -0.510545749419488040D+04,
     *   0.263466875881902520D+03,
     *  -0.767493607114191880D+01,
     *   0.971001840139580000D-01,
     *   0.501466237891449600D+04,
     *   0.677881314838012610D+08,
     *   0.102451091368218960D+10,
     *  -0.640449213019956970D+10,
     *   0.262675971067293120D+12/
C theta=60
      DATA XX3/
     *   0.102259705255180310D+01,
     *  -0.422931059819828280D+01,
     *   0.841298547885173750D+07,
     *  -0.631332264600359370D+07,
     *   0.218610436759517570D+07,
     *  -0.442547293676054920D+06,
     *   0.561787256064376490D+05,
     *  -0.452345794400489100D+04,
     *   0.224088668974039710D+03,
     *  -0.622606462312523500D+01,
     *   0.743650128608139130D-01,
     *   0.501466237891449600D+04,
     *   0.718144856596150990D+08,
     *   0.643028416366354820D+09,
     *   0.128439975235925810D+11,
     *   0.933159597162069510D+10/
C theta=90
      DATA XX4/
     *   0.110047387161036680D+01,
     *  -0.417477036260108210D+01,
     *   0.105253742552225570D+08,
     *  -0.845172598987702470D+07,
     *   0.307399328399921860D+07,
     *  -0.646167854240398160D+06,
     *   0.845963621931602390D+05,
     *  -0.699818251716040140D+04,
     *   0.355364580400691860D+03,
     *  -0.101045290571688580D+02,
     *   0.123290384491220050D+00,
     *   0.501466237891449600D+04,
     *   0.764554333821597840D+08,
     *   0.326477245861719070D+09,
     *   0.274662617013192420D+10,
     *   0.226057768146365740D+11/
C theta=120
      DATA XX5/
     *   0.104859173931842340D+01,
     *  -0.199361355561161770D+01,
     *   0.198095856103767600D+08,
     *  -0.104318662799394950D+08,
     *   0.263400242953600080D+07,
     *  -0.435493335130205790D+06,
     *   0.516171332865437730D+05,
     *  -0.428008622962904430D+04,
     *   0.229231045500385870D+03,
     *  -0.699723534295297610D+01,
     *   0.921731633760895970D-01,
     *   0.501466237891449600D+04,
     *   0.788549245680361090D+08,
     *   0.340226481958905700D+09,
     *   0.288363815375071910D+10,
     *  -0.474655194247720430D+10/
C theta=150
      DATA XX6/
     *   0.172323714588573250D+01,
     *  -0.104335137804348990D+02,
     *   0.296556750017641390D+07,
     *  -0.321329979630668830D+07,
     *   0.150522907864027190D+07,
     *  -0.397958929976709890D+06,
     *   0.650979126299272100D+05,
     *  -0.675637220520657050D+04,
     *   0.434363677679029820D+03,
     *  -0.157816077242744230D+02,
     *   0.246768575183440350D+00,
     *   0.501466237891449600D+04,
     *   0.794063926321976480D+08,
     *   0.536145712996094410D+09,
     *   0.284940809407146020D+10,
     *  -0.499354056454523770D+11/
C theta=180
      DATA XX7/
     *   0.208201600110828360D+01,
     *  -0.151212984507481580D+02,
     *  -0.176033262758345950D+07,
     *   0.205200832243337920D+07,
     *  -0.103799405725804250D+07,
     *   0.297777292732825440D+06,
     *  -0.530399138263440250D+05,
     *   0.601607821808363860D+04,
     *  -0.425243450145618450D+03,
     *   0.171698260554314390D+02,
     *  -0.304211320658061090D+00,
     *   0.501466237891449600D+04,
     *   0.824480374038421360D+08,
     *   0.587850638550512790D+09,
     *   0.510532235086869720D+10,
     *  -0.972015733737625430D+11/



      RCUT=4.85D0
      IF (R.LE.RCUT) THEN
      R=RCUT
      ENDIF


      IF(N.EQ.1) THEN
      DO I=1,16
      XX(I)=XX1(I)
      ENDDO
      ENDIF
      IF(N.EQ.2) THEN
      DO I=1,16
      XX(I)=XX2(I)
      ENDDO
      ENDIF
      IF(N.EQ.3) THEN
      DO I=1,16
      XX(I)=XX3(I)
      ENDDO
      ENDIF
      IF(N.EQ.4) THEN
      DO I=1,16
      XX(I)=XX4(I)
      ENDDO
      ENDIF
      IF(N.EQ.5) THEN
      DO I=1,16
      XX(I)=XX5(I)
      ENDDO
      ENDIF
      IF(N.EQ.6) THEN
      DO I=1,16
      XX(I)=XX6(I)
      ENDDO
      ENDIF
      IF(N.EQ.7) THEN
      DO I=1,16
      XX(I)=XX7(I)
      ENDDO
      ENDIF


      TERM1 = DEXP(-XX(1)*R-XX(2))
      TERM2 = XX(3) + XX(4)*R+XX(5)*R**2+
     *        XX(6)*R**3+XX(7)*R**4+XX(8)*R**5
     *        +XX(9)*R**6+XX(10)*R**7+XX(11)*R**8
      TERM3=0.5D0*
     *   (1.D0+ DTANH(1.D0+XX(12)*R))
      TERM4 = XX(13)/(R**6)+XX(14)/(R**7)
     *        +XX(15)/(R**8)+XX(16)/(R**9)

       VAPRIMI = (TERM1*TERM2-TERM3*TERM4)/4.556335D0
       RETURN
       END

      FUNCTION VABISI(R,N)
CSYSTEM: NO-Kr Abis state
CLEVEL:RHF/RCCSD[T]/
C units R=au E=cm-1
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      DIMENSION XX(16),XX1(16),XX2(16),XX3(16),
     * XX4(16),XX5(16),XX6(16),XX7(16)
C theta=0
      DATA XX1/
     *    0.125717367691647650D+01,
     *   -0.978788456532057790D+01,
     *    0.809782459815127500D+07,
     *   -0.639172054113550860D+07,
     *    0.226418936169679980D+07,
     *   -0.462915169840692370D+06,
     *    0.593745330221700790D+05,
     *   -0.487470347137828960D+04,
     *    0.249887894195171730D+03,
     *   -0.731566968806472500D+01,
     *    0.940572848879227050D-01,
     *    0.501466237891449600D+04,
     *    0.726629065829550770D+08,
     *    0.107510322343766670D+10,
     *   -0.377273093363379760D+12,
     *    0.975484777759294140D+13/
C theta=30
      DATA XX2/
     *   0.121391485484413340D+01,
     *  -0.618514112822369010D+01,
     *   0.717890078289272260D+07,
     *  -0.583068988088009880D+07,
     *   0.216438908965821010D+07,
     *  -0.463025207500261370D+06,
     *   0.614099921976343320D+05,
     *  -0.513406755209529910D+04,
     *   0.263825178834662210D+03,
     *  -0.763178950393744420D+01,
     *   0.956585762283299880D-01,
     *   0.501466237891449600D+04,
     *   0.740978586973972170D+08,
     *   0.873275920214649800D+09,
     *  -0.598873426094741820D+10,
     *   0.217132275411089660D+12/
C theta=60
      DATA XX3/
     *   0.130357209222345220D+01,
     *  -0.642528160139274360D+01,
     *  -0.340570866048953400D+07,
     *   0.343700423190768760D+07,
     *  -0.149536593043263350D+07,
     *   0.369980133881654360D+06,
     *  -0.568690538999575510D+05,
     *   0.553045932775761960D+04,
     *  -0.330440794088726140D+03,
     *   0.110388424491119540D+02,
     *  -0.157473242110801180D+00,
     *   0.501466237891449600D+04,
     *   0.800033478218421190D+08,
     *   0.441155671826940060D+09,
     *  -0.386695984158222040D+06,
     *  -0.295907384086639060D+11/
C theta=90
      DATA XX4/
     *   0.110373175851425010D+01,
     *  -0.382993547997363580D+01,
     *   0.127714755976436660D+08,
     *  -0.102072680012995360D+08,
     *   0.370243061476593650D+07,
     *  -0.776374550563270690D+06,
     *   0.101234301709989160D+06,
     *  -0.831663728070779690D+04,
     *   0.417695763365515800D+03,
     *  -0.116860477646175520D+02,
     *   0.139342212810863450D+00,
     *   0.501466237891449600D+04,
     *   0.827257615260146110D+08,
     *   0.189140044924528000D+09,
     *  -0.118829920565854500D+09,
     *   0.283523646792802350D+11/
C theta=120
      DATA XX5/
     *   0.948352654833558080D+00,
     *  -0.131206759701059260D+01,
     *   0.310028020268645100D+08,
     *  -0.167780614492693210D+08,
     *   0.399350815849820060D+07,
     *  -0.555371930208534240D+06,
     *   0.506363478304414020D+05,
     *  -0.317846487106930950D+04,
     *   0.135182121272924410D+03,
     *  -0.350124218707751610D+01,
     *   0.411234615852565890D-01,
     *   0.501466237891449600D+04,
     *   0.858183114753690960D+08,
     *   0.201112935912792680D+09,
     *   0.190067088858048130D+10,
     *  -0.160232331911966600D+08/
C theta=150
      DATA XX6/
     *   0.225936440264973410D+01,
     *  -0.159699880768872440D+02,
     *  -0.194974339877647880D+07,
     *   0.242250570941398110D+07,
     *  -0.130913050736845190D+07,
     *   0.402031609402810460D+06,
     *  -0.767743489451826170D+05,
     *   0.934230093326465980D+04,
     *  -0.708003686438776300D+03,
     *   0.305838069890516700D+02,
     *  -0.577450976022965270D+00,
     *   0.501466237891449600D+04,
     *   0.842653888527839330D+08,
     *   0.440035742067516510D+09,
     *   0.204014962315189220D+10,
     *  -0.382291448870839080D+11/
C theta=180
      DATA XX7/
     *   0.208201600110828360D+01,
     *  -0.151212984507481580D+02,
     *  -0.176033262758345950D+07,
     *   0.205200832243337920D+07,
     *  -0.103799405725804250D+07,
     *   0.297777292732825440D+06,
     *  -0.530399138263440250D+05,
     *   0.601607821808363860D+04,
     *  -0.425243450145618450D+03,
     *   0.171698260554314390D+02,
     *  -0.304211320658061090D+00,
     *   0.501466237891449600D+04,
     *   0.824480374038421360D+08,
     *   0.587850638550512790D+09,
     *   0.510532235086869720D+10,
     *  -0.972015733737625430D+11/



      RCUT=4.85D0
      IF (R.LE.RCUT) THEN
      R=RCUT
      ENDIF


      IF(N.EQ.1) THEN
      DO I=1,16
      XX(I)=XX1(I)
      ENDDO
      ENDIF
      IF(N.EQ.2) THEN
      DO I=1,16
      XX(I)=XX2(I)
      ENDDO
      ENDIF
      IF(N.EQ.3) THEN
      DO I=1,16
      XX(I)=XX3(I)
      ENDDO
      ENDIF
      IF(N.EQ.4) THEN
      DO I=1,16
      XX(I)=XX4(I)
      ENDDO
      ENDIF
      IF(N.EQ.5) THEN
      DO I=1,16
      XX(I)=XX5(I)
      ENDDO
      ENDIF
      IF(N.EQ.6) THEN
      DO I=1,16
      XX(I)=XX6(I)
      ENDDO
      ENDIF
      IF(N.EQ.7) THEN
      DO I=1,16
      XX(I)=XX7(I)
      ENDDO
      ENDIF


      TERM1 = DEXP(-XX(1)*R-XX(2))
      TERM2 = XX(3) + XX(4)*R+XX(5)*R**2+
     *        XX(6)*R**3+XX(7)*R**4+XX(8)*R**5
     *        +XX(9)*R**6+XX(10)*R**7+XX(11)*R**8
      TERM3=0.5D0*
     *   (1.D0+ DTANH(1.D0+XX(12)*R))
      TERM4 = XX(13)/(R**6)+XX(14)/(R**7)
     *        +XX(15)/(R**8)+XX(16)/(R**9)

       VABISI = (TERM1*TERM2-TERM3*TERM4)/4.556335D0
       RETURN
       END
