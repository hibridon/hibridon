*  System:  O(1D,3P) + Xe
*
*   calculation of potential energy curves and spin-orbit matrix
*   elements by j.klos 
*
*   3P and 1D-3P spin-orbit matrix elements extend to large R.
*   compute 3P spin-orbit splitting using large R values
*
*   MODIFICATION:  Two states only considered, namely the 1Sigma+
*   PE curve correlating with O(1D) and the 3Pi PE curve
*   correlating with O(3P).  A Gaussian coupling centered at
*   the curve-crossing R is included.
*  
*   written by p. dagdigian
*   current revision date:  18-aug-2014
*
      include "common/syusr"
      include "common/bausr"
      include "common/ground"
* --------------------------------------------------------------------------
      subroutine loapot(iunit,filnam)
* --------------------------------------------------------------------------
      character*(*) filnam
      common /coselb/ ibasty
      include "common/parbas"
      include "common/parpot"
      potnam='O-Xe 2state'
      npot=1
      ibasty=22
*  only 3 pot terms in this 2-state model
      lammin(1)=1
      lammax(1)=3
      mproj(1)=0
      ntv(1)=1
      ivcol(1,1)=0
      ivrow(1,1)=0
      return
      end
* --------------------------------------------------------------------------
      subroutine driver
      implicit double precision (a-h,o-z)
      common /cosysi/ junk(5), npot
      common /cosysr/ isrcod, junkr, en(4)
      common /covvl/ vvl(3)
      include "common/parpot"
      potnam='O-Xe 2state'
      econv=219474.6d0
      print *, potnam
1     print *, 'R (bohr):'
      read (5, *, end=99) r
      if (r.le.0.d0) goto 99
      call pot(vv0,r)
      write (6, 100) (econv*vvl(i), i=1,3)
100   format('  ',3(1pe16.8))
      goto 1
99    rr=2.6d0
      dr=0.1d0
      open (unit=12,file='oxe_vlms_2state.txt')
      write(12,109)
109   format(' R/bohr 1Sig  3Pi  Coupling')
      do i=1,401
        call pot(vv0,rr)
        write (12,110) rr,(econv*vvl(j),j=1,3)
110     format(f7.2,3(1pe16.8))
        rr = rr + dr
      enddo
      close(12)
      end
* --------------------------------------------------------------------------
      subroutine pot (vv0, r)
*  subroutine to calculate the r-dependent coefficients
*  in atomic units (distance and energy)
* ----------------------------------------------------------------------
*  on entry:
*    r:      interparticle distance
*  on return:
*    vv0        (not used)
*    vvl(1)     1Sigma+ energy
*    vvl(2)     3Pi energy
*    vvl(3)     Gaussian coupling
*  variable in common block /conlam/ used here
*    nlam:      the number of angular coupling terms actually used
*  variable in common block /covvl/
*    vvl:       array to store r-dependence of each
*               angular term in the potential
*  variable in common block /coconv/
*    econv:     conversion factor from cm-1 to hartrees
*  variables in common /cosysr/
*    isrcod:    number of real parameters
*    en1d:      asymptotic energy of the 1D state (cm-1)
* 
* author:  paul dagdigian
* latest revision date:  15-may-2014
* ----------------------------------------------------------------------
      implicit double precision (a-h,o-z)
      include "common/parbas"
      common /covvl/ vvl(3)

      dimension rr(85),vl(425),rso(22),somat(154)
      dimension csplel(85,5),csplso(22,12),vecel(85),vecso(22)
      dimension v(19)
*
*  values or R for PE curves
      data rr /
     +  2.600,  2.700,  2.800,  2.900,  3.000,
     +  3.100,  3.200,  3.300,  3.400,  3.500,
     +  3.600,  3.700,  3.800,  3.900,  4.000,
     +  4.100,  4.200,  4.300,  4.400,  4.500,
     +  4.600,  4.700,  4.800,  5.000,  5.100,
     +  5.200,  5.300,  5.400,  5.500,  5.600,
     +  5.700,  5.800,  5.900,  6.000,  6.100,
     +  6.200,  6.300,  6.400,  6.500,  6.600,
     +  6.700,  6.800,  6.900,  7.000,  7.100,
     +  7.200,  7.300,  7.400,  7.500,  7.600,
     +  7.700,  7.800,  7.900,  8.000,  8.250,
     +  8.500,  8.750,  9.000,  9.250,  9.500,
     +  9.750, 10.000, 10.250, 10.500, 10.750,
     + 11.000, 11.250, 11.500, 11.750, 12.000,
     + 12.500, 13.000, 13.500, 14.000, 15.000,
     + 16.000, 17.000, 18.000, 19.000, 20.000,
     + 22.000, 24.000, 26.000, 28.000, 30.000 /
*  values of the 5 PE curves
      data vl /  
     + 8.1736093e+04, 5.9671966e+04, 4.3241876e+04, 3.1130442e+04,
     + 2.2321499e+04, 1.6034788e+04, 1.1674766e+04, 8.7827831e+03,
     + 6.9983220e+03, 6.0392535e+03, 5.6907200e+03, 5.7916592e+03,
     + 6.2198353e+03, 6.8790642e+03, 7.6902181e+03, 8.5860145e+03,
     + 9.5089277e+03, 1.0411237e+04, 1.1256040e+04, 1.2018084e+04,
     + 1.2683607e+04, 1.3248949e+04, 1.3718228e+04, 1.4408031e+04,
     + 1.4652833e+04, 1.4846884e+04, 1.5000649e+04, 1.5122943e+04,
     + 1.5220938e+04, 1.5300303e+04, 1.5365435e+04, 1.5419686e+04,
     + 1.5465583e+04, 1.5505012e+04, 1.5539375e+04, 1.5569709e+04,
     + 1.5596782e+04, 1.5621166e+04, 1.5643288e+04, 1.5663473e+04,
     + 1.5681972e+04, 1.5698978e+04, 1.5714648e+04, 1.5729109e+04,
     + 1.5742469e+04, 1.5754818e+04, 1.5766234e+04, 1.5776789e+04,
     + 1.5786545e+04, 1.5795559e+04, 1.5803885e+04, 1.5811571e+04,
     + 1.5818663e+04, 1.5825203e+04, 1.5839398e+04, 1.5850949e+04,
     + 1.5860334e+04, 1.5867962e+04, 1.5874177e+04, 1.5879263e+04,
     + 1.5883451e+04, 1.5886920e+04, 1.5889812e+04, 1.5892234e+04,
     + 1.5894269e+04, 1.5895986e+04, 1.5897439e+04, 1.5898670e+04,
     + 1.5899717e+04, 1.5900608e+04, 1.5902018e+04, 1.5903054e+04,
     + 1.5903822e+04, 1.5904403e+04, 1.5905200e+04, 1.5905697e+04,
     + 1.5906013e+04, 1.5906213e+04, 1.5906342e+04, 1.5906435e+04,
     + 1.5906538e+04, 1.5906589e+04, 1.5906617e+04, 1.5906633e+04,
     + 1.5906642e+04,
     + 1.2033712e+05, 9.7301094e+04, 7.9690022e+04, 6.6167393e+04,
     + 5.5709101e+04, 4.7541089e+04, 4.1090014e+04, 3.5945759e+04,
     + 3.1823002e+04, 2.8519309e+04, 2.5882557e+04, 2.3791429e+04,
     + 2.2144877e+04, 2.0856778e+04, 1.9853497e+04, 1.9072856e+04,
     + 1.8463506e+04, 1.7984200e+04, 1.7602769e+04, 1.7294831e+04,
     + 1.7042387e+04, 1.6832428e+04, 1.6655691e+04, 1.6377512e+04,
     + 1.6267977e+04, 1.6174432e+04, 1.6094846e+04, 1.6027541e+04,
     + 1.5971071e+04, 1.5924153e+04, 1.5885629e+04, 1.5854443e+04,
     + 1.5829630e+04, 1.5810314e+04, 1.5795700e+04, 1.5785080e+04,
     + 1.5777820e+04, 1.5773365e+04, 1.5771226e+04, 1.5770980e+04,
     + 1.5772261e+04, 1.5774754e+04, 1.5778193e+04, 1.5782348e+04,
     + 1.5787028e+04, 1.5792071e+04, 1.5797342e+04, 1.5802732e+04,
     + 1.5808150e+04, 1.5813524e+04, 1.5818796e+04, 1.5823922e+04,
     + 1.5828869e+04, 1.5833613e+04, 1.5844492e+04, 1.5853917e+04,
     + 1.5861941e+04, 1.5868707e+04, 1.5874387e+04, 1.5879159e+04,
     + 1.5883176e+04, 1.5886569e+04, 1.5889440e+04, 1.5891874e+04,
     + 1.5893939e+04, 1.5895694e+04, 1.5897187e+04, 1.5898458e+04,
     + 1.5899542e+04, 1.5900467e+04, 1.5901931e+04, 1.5903000e+04,
     + 1.5903788e+04, 1.5904381e+04, 1.5905195e+04, 1.5905705e+04,
     + 1.5906028e+04, 1.5906233e+04, 1.5906363e+04, 1.5906448e+04,
     + 1.5906544e+04, 1.5906592e+04, 1.5906619e+04, 1.5906634e+04,
     + 1.5906643e+04,
     + 1.6219080e+05, 1.3832816e+05, 1.1977651e+05, 1.0518366e+05,
     + 9.3537517e+04, 8.4100016e+04, 7.6337224e+04, 6.9841371e+04,
     + 6.4267752e+04, 5.9325264e+04, 5.4804744e+04, 5.0591928e+04,
     + 4.6647957e+04, 4.2975845e+04, 3.9592162e+04, 3.6510570e+04,
     + 3.3735333e+04, 3.1260698e+04, 2.9072833e+04, 2.7152427e+04,
     + 2.5477078e+04, 2.4023149e+04, 2.2767086e+04, 2.0759635e+04,
     + 1.9967733e+04, 1.9293048e+04, 1.8719884e+04, 1.8234314e+04,
     + 1.7824066e+04, 1.7478386e+04, 1.7187895e+04, 1.6944452e+04,
     + 1.6741012e+04, 1.6571504e+04, 1.6430711e+04, 1.6314167e+04,
     + 1.6218054e+04, 1.6139124e+04, 1.6074614e+04, 1.6022182e+04,
     + 1.5979843e+04, 1.5945920e+04, 1.5918994e+04, 1.5897868e+04,
     + 1.5881533e+04, 1.5869138e+04, 1.5859968e+04, 1.5853422e+04,
     + 1.5848997e+04, 1.5846274e+04, 1.5844903e+04, 1.5844593e+04,
     + 1.5845104e+04, 1.5846238e+04, 1.5850817e+04, 1.5856579e+04,
     + 1.5862520e+04, 1.5868137e+04, 1.5873222e+04, 1.5877729e+04,
     + 1.5881682e+04, 1.5885128e+04, 1.5888118e+04, 1.5890697e+04,
     + 1.5892911e+04, 1.5894805e+04, 1.5896420e+04, 1.5897797e+04,
     + 1.5898970e+04, 1.5899970e+04, 1.5901549e+04, 1.5902700e+04,
     + 1.5903550e+04, 1.5904192e+04, 1.5905077e+04, 1.5905630e+04,
     + 1.5905979e+04, 1.5906200e+04, 1.5906342e+04, 1.5906435e+04,
     + 1.5906538e+04, 1.5906589e+04, 1.5906617e+04, 1.5906632e+04,
     + 1.5906642e+04, 
     + 1.5619782e+05, 1.3238594e+05, 1.1382999e+05, 9.9149366e+04,
     + 8.7298140e+04, 7.7501001e+04, 6.9184137e+04, 6.1913519e+04,
     + 5.5371181e+04, 4.9357194e+04, 4.3776856e+04, 3.8605193e+04,
     + 3.3848346e+04, 2.9516894e+04, 2.5613099e+04, 2.2127633e+04,
     + 1.9040987e+04, 1.6326467e+04, 1.3953203e+04, 1.1888626e+04,
     + 1.0100259e+04, 8.5569074e+03, 7.2293895e+03, 5.1172295e+03,
     + 4.2866102e+03, 3.5797593e+03, 2.9796483e+03, 2.4713318e+03,
     + 2.0417526e+03, 1.6795471e+03, 1.3748592e+03, 1.1191669e+03,
     + 9.0512292e+02, 7.2641000e+02, 5.7761101e+02, 4.5409246e+02,
     + 3.5190053e+02, 2.6766869e+02, 1.9853569e+02, 1.4207346e+02,
     + 9.6223961e+01, 5.9244402e+01, 2.9660036e+01, 6.2238400e+00,
     + -1.2117771e+01, -2.6253999e+01, -3.6934246e+01, -4.4788991e+01,
     + -5.0347500e+01, -5.4052950e+01, -5.6275326e+01, -5.7322496e+01,
     + -5.7449649e+01, -5.6867363e+01, -5.3365067e+01, -4.8349020e+01,
     + -4.2917501e+01, -3.7642833e+01, -3.2781345e+01, -2.8417402e+01,
     + -2.4555115e+01, -2.1168390e+01, -1.8222177e+01, -1.5678301e+01,
     + -1.3496101e+01, -1.1633171e+01, -1.0047317e+01, -8.6988490e+00,
     + -7.5523480e+00, -6.5771140e+00, -5.0393070e+00, -3.9166450e+00,
     + -3.0835530e+00, -2.4506810e+00, -1.5734140e+00, -1.0266500e+00,
     + -6.8107500e-01, -4.5941000e-01, -3.1612200e-01, -2.2309600e-01,
     + -1.2003600e-01, -6.9596000e-02, -4.2299000e-02, -2.6617000e-02,
     + -1.7215000e-02,
     + 1.1623946e+05, 9.3185489e+04, 7.5515371e+04, 6.1873965e+04,
     + 5.1219842e+04, 4.2766726e+04, 3.5936815e+04, 3.0324911e+04,
     + 2.5658588e+04, 2.1750886e+04, 1.8463940e+04, 1.5689464e+04,
     + 1.3339558e+04, 1.1342139e+04, 9.6382330e+03, 8.1799359e+03,
     + 6.9285709e+03, 5.8529466e+03, 4.9277735e+03, 4.1323068e+03,
     + 3.4492615e+03, 2.8639897e+03, 2.3638841e+03, 1.5765541e+03,
     + 1.2711421e+03, 1.0141731e+03, 7.9897032e+02, 6.1964138e+02,
     + 4.7100260e+02, 3.4851120e+02, 2.4820301e+02, 1.6663384e+02,
     + 1.0082495e+02, 4.8211966e+01, 6.5976010e+00, -2.5892132e+01,
     + -5.0848225e+01, -6.9615391e+01, -8.3325489e+01, -9.2927516e+01,
     + -9.9214337e+01, -1.0284619e+02, -1.0437117e+02, -1.0424288e+02,
     + -1.0283551e+02, -1.0045657e+02, -9.7357752e+01, -9.3744011e+01,
     + -8.9781244e+01, -8.5602787e+01, -8.1314866e+01, -7.7001253e+01,
     + -7.2727136e+01, -6.8542389e+01, -5.8691523e+01, -4.9942406e+01,
     + -4.2386619e+01, -3.5973552e+01, -3.0581062e+01, -2.6061165e+01,
     + -2.2268925e+01, -1.9077356e+01, -1.6381823e+01, -1.4098218e+01,
     + -1.2158792e+01, -1.0508196e+01, -9.1006550e+00, -7.8981410e+00,
     + -6.8691670e+00, -5.9876690e+00, -4.5838960e+00, -3.5501790e+00,
     + -2.7842990e+00, -2.2087090e+00, -1.4216600e+00, -9.2847500e-01,
     + -6.1388500e-01, -4.1437400e-01, -2.8754600e-01, -2.0533000e-01,
     + -1.1229900e-01, -6.5502000e-02, -3.9919000e-02, -2.5163000e-02,
     + -1.6292000e-02 /
*  values or R for spin-orbit matrix elements
      data rso /  
     +  2.500,  2.600,  2.700,  2.800,  2.900,
     +  3.000,  3.250,  3.500,  3.750,  4.000,
     +  4.250,  4.500,  4.750,  5.000,  5.250,
     +  5.500,  6.000,  6.500,  7.000,  7.500,
     +  8.000,  8.500 /
*  values of Axy and Azy - spin-orbit matrix elements within 3P state
*  then values of the B spin-orbit matrix elements, coupling the 1D and 3P states
       data somat /  
     + 2.0028983e+03, 1.8717172e+03, 1.6880283e+03, 1.4705986e+03,
     + 1.2515656e+03, 1.0540202e+03, 6.8657523e+02, 4.5633663e+02,
     + 2.9901971e+02, 2.0995807e+02, 1.5842905e+02, 1.2729100e+02,
     + 1.0810864e+02, 9.6205394e+01, 8.8789232e+01, 8.4156174e+01,
     + 7.9445760e+01, 7.7602781e+01, 7.6882855e+01, 7.6596871e+01,
     + 7.6457772e+01, 7.6425669e+01,
     + -6.9421451e+02, -7.4252306e+02, -7.8459119e+02, -8.2167250e+02,
     + -8.5407790e+02, -8.8045923e+02, -9.0016087e+02, -7.7858487e+02,
     + -4.4368091e+02, -2.4291545e+02, -1.3367381e+02, -6.7442900e+01,
     + -2.5689880e+01, 1.2867770e+00, 1.9025303e+01, 3.0781268e+01,
     + 4.3797579e+01, 4.9557749e+01, 5.2095309e+01, 5.3165425e+01,
     + 5.3682220e+01, 5.3870478e+01,
*
     + 2.4995862e+02, 2.3716130e+02, 2.2107208e+02, 2.0248595e+02,
     + 1.8317523e+02, 1.6491391e+02, 1.2997172e+02, 1.0876538e+02,
     + 8.9580946e+01, 8.3015121e+01, 8.2397485e+01, 8.3276335e+01,
     + 8.3415156e+01, 8.2821179e+01, 8.2130193e+01, 8.1615689e+01,
     + 8.1173338e+01, 8.1136899e+01, 8.1189058e+01, 8.1192303e+01,
     + 8.1149602e+01, 8.1163280e+01,
     + 1.8896122e+03, 1.7511517e+03, 1.5670768e+03, 1.3588484e+03,
     + 1.1561932e+03, 9.7722518e+02, 6.4775454e+02, 4.4066966e+02,
     + 2.9831662e+02, 2.1212484e+02, 1.5924548e+02, 1.2613151e+02,
     + 1.0534871e+02, 9.2326060e+01, 8.4169815e+01, 7.9065829e+01,
     + 7.3886486e+01, 7.1874421e+01, 7.1096256e+01, 7.0778941e+01,
     + 7.0612061e+01, 7.0580349e+01,
     + -8.5387530e+02, -8.8124564e+02, -8.8296336e+02, -8.6115306e+02,
     + -8.2410091e+02, -7.8020960e+02, -6.6516488e+02, -5.4369896e+02,
     + -3.9263364e+02, -2.5960203e+02, -1.5740431e+02, -8.4961459e+01,
     + -3.8242154e+01, -1.0338903e+01, 5.7182330e+00, 1.4925300e+01,
     + 2.3498947e+01, 2.6693668e+01, 2.7982582e+01, 2.8517873e+01,
     + 2.8766647e+01, 2.8911813e+01,
     + -7.6359582e+02, -8.1312324e+02, -8.5695588e+02, -8.9616351e+02,
     + -9.3102330e+02, -9.6028175e+02, -9.8856364e+02, -8.7214444e+02,
     + -5.2233533e+02, -3.0193438e+02, -1.7628052e+02, -9.7565111e+01,
     + -4.6631230e+01, -1.3308540e+01, 8.5210580e+00, 2.2828722e+01,
     + 3.8350340e+01, 4.5003005e+01, 4.7844194e+01, 4.9004504e+01,
     + 4.9536857e+01, 4.9737006e+01,
     + -6.9361133e+02, -7.4280537e+02, -7.8764245e+02, -8.2959833e+02,
     + -8.6882597e+02, -9.0393510e+02, -9.5737478e+02, -9.0181011e+02,
     + -5.7865445e+02, -3.1827478e+02, -1.7512821e+02, -9.1406828e+01,
     + -4.0533266e+01, -8.6877000e+00, 1.1703110e+01, 2.4918723e+01,
     + 3.9184392e+01, 4.5317580e+01, 4.7959444e+01, 4.9073217e+01,
     + 4.9548613e+01, 4.9745891e+01 /
*
*  set vv0 term to zero
      vv0 = 0.d0
*
*  spline fits
      if (ifirst .eq. 0) then
*  spline fit of the coefficients for the PE curves
        indel=1
        do ilam=1,5
          call dcopy(85,vl(indel),1,vecel,1)
*  evaluate derivative at first point
          der1=(vecel(2)-vecel(1))/(rr(2)-rr(1))
          call dspline(rr,vecel,85,der1,0d0,csplel(1,ilam))
          indel = indel + 85
        enddo
        ifirst = 1
      end if
*  determine splined coefficients for PE curves at r=R
      indel=1
      do ilam=1,5
        call dcopy(85,vl(indel),1,vecel,1)
        call dsplint(rr,vecel,csplel(1,ilam),85,r,vvx)
*  1Sigma energy, shifted to E=0 at large R
        if (ilam.eq.1) then
          v(1) = vvx - 15906.642d0
        endif
*  3Pi energy
        if (ilam.eq.5) then
          v(2) = vvx
        endif
        call dcopy(85,vl(indel),1,vecel,1)
        indel = indel + 85
      enddo
*  fix long-range behavior of PE curves to go to zero at large R
      if (r.gt.25.d0) then
        switch_lr = 0.5*(tanh(0.5*(r - 30.d0)) + 1.d0)
        v(1) = (1.d0 - switch_lr) * v(1)
        v(2) = (1.d0 - switch_lr) * v(2)
      endif
*  Gaussian coupling - to match larger Omega=0 splitting
      ecoup = 427.d0
      rcross = 4.087d0
      fwhm = 1.d0
      arg = (((r - rcross) / fwhm)**2 * 2.7726d0)
*      arg = ((r - rcross)/0.5)**2
      if (arg .lt. 20.d0) then
        v(3) = ecoup*exp(-arg)
      else
        v(3) = 0.d0
      endif
*
      call dcopy(3,v,1,vvl,1)
* convert to hartree
      econv=1.d0/219474.6d0
      call dscal(3,econv,vvl,1)
      return
      end
*===================================eof====================================
