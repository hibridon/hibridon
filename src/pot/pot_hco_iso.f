*  System:  H-CO - Re(CO) - Nijmegen PES
*
*   L. Song, A. van der Avoird, and G. C. Groenenboom,
*   JPCA 1117, 7571 (2013)
*
*   lambda_max of angular fit = 15
*
*   take only lambda=0 term (spherically averaged potential
*  
*   written by p. dagdigian
*   current revision date:  3-sep-2015
      include "common/syusr"
      include "common/bausr"
      include "common/ground"
* ------------------------------------------------------------------------
      subroutine driver
      implicit double precision (a-h,o-z)
      common /covvl/ vvl(15)
      include "common/parpot"
      econv=219474.6d0
      potnam='HCO PES-Nijmegen-V0 term'
      print *, potnam
1     print *, 'R (bohr):'
      read (5, *, end=99) r
      call pot(vv0,r)
      if (r.le.0.d0) goto 99
*     vlm coefficient is returned in atomic units (hartree)
*     convert from atomic units for printout
      write (6, 100) vv0*econv
100   format(1(1pe16.8))
      goto 1
99    rr=3.0d0
      dr=0.2d0
      open (unit=12,file='hco_iso_vlms.txt')
      write(12,109)
109   format(' %R/bohr V0')
      do i=1,250
        call pot(vv0,rr)
        write (12,110) rr,vv0*econv
110     format(f7.2,1(1pe16.8))
        rr = rr + dr
      enddo
      close(12)
      end
* --------------------------------------------------------------------------
      subroutine loapot(iunit,filnam)
* --------------------------------------------------------------------------
      implicit double precision (a-h,o-z)
      character*(*) filnam
      include "common/parbas"
      include "common/parpot" 
      common /conlam/ nlam, nlammx, lamnum(2)
      common /cosysi/ nscode, isicod, nterm
      potnam='HCO PES-Nijmegen-V0 term'
      npot=1
      nterm=1
      lammin(1)=1
      lammax(1)=15
      mproj(1)=0
      ipotsy = 1
*
      ntv(1)=1
      ivcol(1,1)=0
      ivrow(1,1)=0
*  count number of anisotropic terms
      nlam = 0
      do il=lammin(1),lammax(1),ipotsy
        nlam = nlam + 1
      enddo
      nlammx = nlam
      return
      end
* --------------------------------------------------------------------------
      subroutine pot (vv0, r)


*  subroutine to calculate the r-dependent coefficients in the
*  collision of a diatomic with a structureless target
*  in units of hartree for energy and bohr for distance

*  on return:
*  vv0 contains the isotropic term (n=0) in the potential
*  the coefficients for each angular term in the coupling potential
*  [ vvl(i) for i = 1, nlam ] are returned in common block /covvl/

*  variable in common block /conlam/
*    nlammx:    the maximum number of anisotropic terms
*    nlam:      the total number of angular coupling terms
*  variable in common block /covvl/
*    vvl        array to store r-dependence of each angular term in the
*               potential
* 
* author:  paul dagdigian
* latest revision date:  21-jan-2015
* ----------------------------------------------------------------------
      implicit double precision (a-h,o-z)
      logical ljunk, ihomo, csflag, lljunk
      include "common/parbas"
      dimension v(16)
      dimension csplin(47,16)
      dimension rr(47), vl(752),vec(47)
      common /colpar/ ljunk(5),csflag,lljunk(2),ihomo
      common /covvl/ vvl(15)
*
*  47 values or R
      data rr /
     +  2.000,  2.250,  2.500,  2.750,  3.000, 
     +  3.250,  3.500,  3.750,  4.000,  4.250, 
     +  4.500,  4.750,  5.000,  5.250,  5.500, 
     +  5.750,  6.000,  6.250,  6.500,  6.750, 
     +  7.000,  7.500,  8.000,  8.500,  9.000, 
     +  9.500, 10.000, 11.000, 12.000, 13.000, 
     + 14.000, 15.000, 16.000, 17.000, 18.000, 
     + 19.000, 20.000, 21.000, 22.000, 23.000, 
     + 24.000, 25.000, 26.000, 27.000, 28.000, 
     + 29.000, 30.000 /
*  16 values of the vlam coefficients
      data vl /  
     + 3.9706078e+04, 2.1692434e+04, 1.3338522e+04, 8.8301058e+03,
     + 6.3727183e+03, 4.7349829e+03, 3.6541442e+03, 2.8961201e+03,
     + 2.2638124e+03, 1.6936795e+03, 1.2110582e+03, 8.3186609e+02,
     + 5.4899488e+02, 3.4648758e+02, 2.0639953e+02, 1.1255636e+02,
     + 5.1768792e+01, 1.3994132e+01, -8.2599619e+00, -2.0297316e+01,
     + -2.5828449e+01, -2.6658263e+01, -2.2194468e+01, -1.6990090e+01,
     + -1.2549664e+01, -9.1543559e+00, -6.6746180e+00, -3.6173559e+00,
     + -2.0544957e+00, -1.2232495e+00, -7.6035081e-01, -4.9034402e-01,
     + -3.2638179e-01, -2.2327457e-01, -1.5642863e-01, -1.1190710e-01,
     + -8.1531851e-02, -6.0360238e-02, -4.5334743e-02, -3.4498636e-02,
     + -2.6568637e-02, -2.0687111e-02, -1.6270899e-02, -1.2917130e-02,
     + -1.0343374e-02, -8.3489375e-03, -6.7894079e-03, 
*  lambda=1
     + -2.7045060e+04, -6.3707098e+03, 5.2200679e+03, 1.0075595e+04,
     + 1.0442435e+04, 8.1040304e+03, 5.1909897e+03, 2.7435126e+03,
     + 1.1338101e+03, 2.8897951e+02, -8.7140685e+01, -2.2292633e+02,
     + -2.4332160e+02, -2.1495690e+02, -1.7092989e+02, -1.2678940e+02,
     + -8.8894338e+01, -5.8987966e+01, -3.6760648e+01, -2.1014004e+01,
     + -1.0361351e+01, 7.4916137e-01, 4.3101603e+00, 4.6539288e+00,
     + 3.9639196e+00, 3.0739172e+00, 2.2698991e+00, 1.1760625e+00,
     + 6.1598366e-01, 3.3401237e-01, 1.8923984e-01, 1.1216644e-01,
     + 6.9500922e-02, 4.4510651e-02, 2.9079811e-02, 1.9314530e-02,
     + 1.3073547e-02, 9.0478868e-03, 6.3938025e-03, 4.6024940e-03,
     + 3.3680392e-03, 2.5013485e-03, 1.8825874e-03, 1.4341094e-03,
     + 1.1045661e-03, 8.5936837e-04, 6.7483013e-04, 
*  lambda=2
     + 7.6828342e+04, 2.3954553e+04, 3.8081198e+03, -1.1879211e+03,
     + -1.4983875e+03, -9.3883989e+02, 2.9341469e+01, 9.8506703e+02,
     + 1.4909031e+03, 1.5059373e+03, 1.2863814e+03, 1.0121673e+03,
     + 7.5630670e+02, 5.4483227e+02, 3.8091617e+02, 2.5909926e+02,
     + 1.7144174e+02, 1.0995106e+02, 6.7838252e+01, 3.9732784e+01,
     + 2.1471357e+01, 2.9510447e+00, -3.1953182e+00, -4.3765050e+00,
     + -3.8980766e+00, -3.0419107e+00, -2.2405106e+00, -1.1371103e+00,
     + -5.8493497e-01, -3.1365491e-01, -1.7709666e-01, -1.0468735e-01,
     + -6.4428394e-02, -4.1178954e-02, -2.7303620e-02, -1.8696353e-02,
     + -1.3127572e-02, -9.3837094e-03, -6.8112166e-03, -5.0146525e-03,
     + -3.7408623e-03, -2.8249173e-03, -2.1575986e-03, -1.6654217e-03,
     + -1.2982502e-03, -1.0213861e-03, -8.1051597e-04, 
*  lambda=3
     + -4.5844806e+04, -2.6276200e+04, -1.4206359e+04, -4.9733767e+03,
     + 1.5087543e+02, 1.5168254e+03, 1.1485859e+03, 3.3190646e+02,
     + -2.5277771e+02, -4.3738094e+02, -4.2900781e+02, -3.6423239e+02,
     + -2.8878071e+02, -2.2024340e+02, -1.6341357e+02, -1.1847744e+02,
     + -8.4232802e+01, -5.8673488e+01, -4.0040727e+01, -2.6774299e+01,
     + -1.7513882e+01, -6.9048586e+00, -2.3012921e+00, -5.0656541e-01,
     + 1.1830801e-01, 2.7587746e-01, 2.6096868e-01, 1.4280831e-01,
     + 6.7101790e-02, 3.0795257e-02, 1.4820057e-02, 7.3937491e-03,
     + 3.7036373e-03, 1.7782136e-03, 7.3093295e-04, 1.7501632e-04,
     + -8.8946017e-05, -1.8426746e-04, -2.0123125e-04, -1.8657759e-04,
     + -1.6138542e-04, -1.3484103e-04, -1.1061662e-04, -8.9875251e-05,
     + -7.2700537e-05, -5.8728259e-05, -4.7469462e-05, 
*  lambda=4
     + 7.0536696e+04, 3.4865553e+04, 1.7496876e+04, 9.0959746e+03,
     + 5.6624661e+03, 3.5241523e+03, 2.3968667e+03, 1.9140574e+03,
     + 1.5438328e+03, 1.1150497e+03, 7.5687257e+02, 5.0728988e+02,
     + 3.3935263e+02, 2.2775348e+02, 1.5324880e+02, 1.0315733e+02,
     + 6.9323934e+01, 4.6381497e+01, 3.0829814e+01, 2.0324820e+01,
     + 1.3269177e+01, 5.4580807e+00, 2.1041570e+00, 7.4254779e-01,
     + 2.1030872e-01, 2.0325216e-02, -3.2150169e-02, -2.9618919e-02,
     + -1.3950525e-02, -5.6282972e-03, -2.3331738e-03, -1.0263191e-03,
     + -4.6145798e-04, -1.2877046e-04, 1.2751234e-04, 2.7965721e-04,
     + 3.2371783e-04, 2.9280513e-04, 2.3860880e-04, 1.8566534e-04,
     + 1.4131472e-04, 1.0646671e-04, 7.9926849e-05, 6.0011319e-05,
     + 4.5169534e-05, 3.4130668e-05, 2.5912022e-05, 
*  lambda=5
     + -2.4318532e+04, -7.7851025e+03, -2.9961696e+03, -2.5743518e+03,
     + -1.7384407e+03, -1.4785522e+03, -1.3825395e+03, -1.2940559e+03,
     + -1.0549653e+03, -6.9712752e+02, -4.1607709e+02, -2.4391427e+02,
     + -1.4373288e+02, -8.6458086e+01, -5.3298337e+01, -3.3650683e+01,
     + -2.1568231e+01, -1.4038892e+01, -9.2293028e+00, -6.0679186e+00,
     + -3.9711899e+00, -1.6742448e+00, -6.7513413e-01, -2.5621249e-01,
     + -8.5719502e-02, -2.1296799e-02, -8.5004640e-04, 4.6745105e-03,
     + 3.2970136e-03, 1.5964144e-03, 3.4300409e-04, -3.7167645e-04,
     + -6.1249056e-04, -4.1473473e-04, 3.2775482e-05, 3.7550120e-04,
     + 4.9960945e-04, 4.5720711e-04, 3.6435439e-04, 2.7418145e-04,
     + 2.0092330e-04, 1.4548376e-04, 1.0489608e-04, 7.5640759e-05,
     + 5.4697834e-05, 3.9725268e-05, 2.9005556e-05, 
*  lambda=6
     + 2.7317928e+04, 1.1358231e+04, 6.1646815e+03, 3.7986254e+03,
     + 2.8478522e+03, 2.1643563e+03, 1.7482084e+03, 1.4785367e+03,
     + 1.1021416e+03, 6.7367877e+02, 3.7275452e+02, 2.0169257e+02,
     + 1.0917229e+02, 5.9994431e+01, 3.3709623e+01, 1.9497688e+01,
     + 1.1394801e+01, 6.8498043e+00, 4.2355095e+00, 2.6383204e+00,
     + 1.6403322e+00, 6.4654651e-01, 2.5252117e-01, 9.4773268e-02,
     + 3.3710620e-02, 1.0634720e-02, 2.4117930e-03, -1.0150068e-03,
     + -1.0532120e-03, -3.1952630e-04, 1.8796213e-04, -4.2881163e-05,
     + -4.9164552e-04, -5.3598419e-04, -1.9679355e-04, 1.4323922e-04,
     + 3.1472487e-04, 3.3228648e-04, 2.8807972e-04, 2.3117758e-04,
     + 1.7888461e-04, 1.3595508e-04, 1.0246368e-04, 7.6995108e-05,
     + 5.7870882e-05, 4.3596531e-05, 3.2957341e-05, 
*  lambda=7
     + -1.4504599e+04, -8.1241697e+03, -3.8533441e+03, -9.5830555e+02,
     + -3.4193730e+02, -5.5052639e+02, -8.0455952e+02, -9.0987013e+02,
     + -7.4177471e+02, -4.4394279e+02, -2.3209464e+02, -1.1700661e+02,
     + -5.8341291e+01, -2.9267118e+01, -1.4807775e+01, -7.7898425e+00,
     + -4.0541420e+00, -2.1733086e+00, -1.2336158e+00, -7.1560274e-01,
     + -4.1048137e-01, -1.4695425e-01, -5.1553835e-02, -1.6564752e-02,
     + -5.5699388e-03, -1.7983841e-03, -2.3616783e-04, 3.8236345e-04,
     + 1.1995233e-04, 7.6849745e-05, 1.8571976e-04, 2.7893041e-04,
     + 3.0335075e-04, 2.3544141e-04, 1.1060208e-04, 9.9991119e-06,
     + -3.9744172e-05, -4.9786208e-05, -4.4311897e-05, -3.5276139e-05,
     + -2.6735065e-05, -1.9794822e-05, -1.4495098e-05, -1.0572473e-05,
     + -7.7076628e-06, -5.6346447e-06, -4.1343397e-06, 
*  lambda=8
     + 1.0997632e+04, 2.7887446e+03, 5.8582343e+02, 7.1878635e+02,
     + 7.2072580e+02, 5.5007253e+02, 5.8397364e+02, 6.5570019e+02,
     + 5.3787723e+02, 3.0743283e+02, 1.5208906e+02, 7.2844500e+01,
     + 3.4546866e+01, 1.6495383e+01, 7.8913401e+00, 3.9234837e+00,
     + 1.9400827e+00, 9.7083062e-01, 5.0180511e-01, 2.6359659e-01,
     + 1.3533764e-01, 4.1471478e-02, 1.1688602e-02, 1.9844211e-03,
     + 7.9304816e-05, 3.3908616e-05, 2.5457069e-04, 4.7810864e-04,
     + 3.3945184e-04, 1.1127397e-05, -2.6042774e-04, -3.5454969e-04,
     + -3.4030122e-04, -2.8615417e-04, -2.2018452e-04, -1.6166308e-04,
     + -1.1486744e-04, -7.8435480e-05, -5.2414024e-05, -3.4778054e-05,
     + -2.3089068e-05, -1.5396959e-05, -1.0336965e-05, -6.9989440e-06,
     + -4.7784495e-06, -3.2918087e-06, -2.2878722e-06, 
*  lambda=9
     + -4.5737313e+03, 2.4569144e+02, 1.4254987e+02, -2.9884887e+02,
     + -1.4441675e+01, -9.9053281e+01, -2.5785499e+02, -3.8919246e+02,
     + -3.4573847e+02, -1.8883735e+02, -8.7525184e+01, -3.9354529e+01,
     + -1.7582040e+01, -7.9297355e+00, -3.6207543e+00, -1.6857369e+00,
     + -7.9016417e-01, -3.8777488e-01, -1.8847416e-01, -8.6451525e-02,
     + -4.2380911e-02, -1.1188694e-02, -1.4643336e-03, 2.9132070e-04,
     + 3.7304340e-04, 4.7635635e-04, 6.1781931e-04, 2.2418806e-04,
     + -3.2287392e-04, -2.0511271e-04, 3.6571760e-05, 3.8537236e-05,
     + -6.6550969e-05, -1.3438689e-04, -1.5500972e-04, -1.4532518e-04,
     + -1.1872868e-04, -8.5710648e-05, -5.8104709e-05, -3.8386951e-05,
     + -2.5125251e-05, -1.6428875e-05, -1.0782550e-05, -7.1185146e-06,
     + -4.7406368e-06, -3.1792761e-06, -2.1524356e-06, 
*  lambda=10
     + 4.1719901e+03, 2.9256170e+03, 1.5000157e+03, 3.3163377e+02,
     + 3.3025031e+02, 2.1301718e+02, 2.1235081e+02, 2.6264602e+02,
     + 2.3291088e+02, 1.1837975e+02, 5.0814574e+01, 2.1188876e+01,
     + 8.8786978e+00, 3.8071349e+00, 1.7358262e+00, 7.2972833e-01,
     + 3.1193491e-01, 1.5069600e-01, 7.1962966e-02, 3.7076422e-02,
     + 2.7830875e-02, 2.5469063e-03, -6.3357159e-04, 8.4594560e-04,
     + 6.7207145e-04, 1.9534931e-04, -1.1892781e-04, 1.4948860e-04,
     + 5.1066389e-04, 7.4477654e-05, -1.2010371e-04, 4.4884331e-04,
     + 1.0242382e-03, 1.0092791e-03, 6.0544513e-04, 2.5322077e-04,
     + 6.8350442e-05, 4.1847783e-06, -1.2199858e-05, -1.3595472e-05,
     + -1.1054528e-05, -8.0928157e-06, -5.6598680e-06, -3.8756149e-06,
     + -2.6263415e-06, -1.7791291e-06, -1.2063478e-06, 
*  lambda=11
     + -2.3098131e+03, -1.5805770e+03, -5.3005012e+02, -5.6961385e+01,
     + 3.4767293e+00, -8.6249130e+01, -1.1570333e+02, -1.5748875e+02,
     + -1.4415747e+02, -6.8732902e+01, -2.7385786e+01, -1.0547053e+01,
     + -4.1177515e+00, -1.6788284e+00, -7.5917119e-01, -2.6123962e-01,
     + -1.0624936e-01, -3.2479755e-02, -7.0010161e-03, -1.6837981e-02,
     + -2.7624941e-02, -6.6165005e-04, -2.6277166e-04, -2.9257556e-03,
     + -1.8735242e-03, -1.0419246e-04, 1.1231386e-03, 5.8629455e-04,
     + -5.9321479e-04, 4.8991538e-05, 5.5380834e-04, -2.5370385e-05,
     + -7.2891724e-04, -8.5185962e-04, -5.9061396e-04, -3.2900315e-04,
     + -1.6934379e-04, -8.7507617e-05, -4.6284537e-05, -2.5047247e-05,
     + -1.3849763e-05, -7.8146285e-06, -4.4990882e-06, -2.6400071e-06,
     + -1.5757419e-06, -9.5424855e-07, -5.8773422e-07, 
*  lambda=12
     + 7.0816938e+02, -1.8388518e+03, -8.4214877e+02, 9.0230362e+01,
     + 8.1724143e+01, 7.6503803e+01, 7.1351567e+01, 7.8829381e+01,
     + 7.1976327e+01, 3.2705345e+01, 1.2355058e+01, 4.4789624e+00,
     + 1.6487919e+00, 6.5849442e-01, 2.4660699e-01, 7.3542971e-02,
     + 4.3725168e-02, -5.2098190e-03, -1.5008926e-02, 6.2151836e-03,
     + 2.0128180e-02, 6.5911235e-04, 1.9271188e-04, 1.9760434e-04,
     + -1.0856114e-03, -1.3085082e-03, -8.7122998e-04, 2.6582929e-04,
     + 4.6432315e-04, -7.4756349e-04, -1.3977473e-03, -7.9911003e-04,
     + 4.4797045e-05, 4.9776892e-04, 6.5219793e-04, 6.2129002e-04,
     + 4.8777890e-04, 3.2147663e-04, 1.9505235e-04, 1.1475585e-04,
     + 6.6887832e-05, 3.9024598e-05, 2.2917290e-05, 1.3583328e-05,
     + 8.1332773e-06, 4.9290837e-06, 3.0227457e-06, 
*  lambda=13
     + -5.3869428e+01, 8.2306042e+00, -4.5074285e-01, -3.7857420e+00,
     + 6.5684459e-01, 4.2987361e-04, 9.1009817e-04, -1.6307698e-04,
     + 1.6333610e-04, -3.3199651e-05, -2.4156187e-04, 1.9000684e-04,
     + 1.2978017e-05, 5.4545848e-05, -1.1279677e-06, 1.3550860e-05,
     + -6.7142437e-06, -7.5800843e-06, -2.1327712e-06, -1.6160925e-06,
     + -1.8053412e-06, 3.0704455e-06, 2.1160954e-06, -2.4522439e-06,
     + -2.3881433e-07, 7.1304447e-08, 4.2677437e-07, 2.9696174e-08,
     + -1.6277701e-07, -2.8285074e-07, 1.2852710e-07, 1.4131161e-08,
     + 1.3551221e-08, 3.7453072e-09, -1.4203250e-08, -4.4837545e-08,
     + -3.3230969e-09, 3.2321587e-09, -2.5664167e-09, 1.4354571e-09,
     + 4.3206813e-09, -1.3666710e-10, -2.2787994e-10, 2.6435986e-10,
     + 3.1001126e-09, 1.8569464e-10, 2.4229359e-10, 
*  lambda=14
     + 2.1650781e+01, -2.2165130e+01, -4.7785045e-01, -3.9962815e+00,
     + 1.1507837e+00, 3.8528104e-04, 1.3294874e-03, 3.3279397e-04,
     + -1.4903710e-05, 1.0756219e-04, -2.9708462e-04, -1.6591935e-04,
     + 4.0060015e-05, 3.9216201e-06, -5.2904128e-05, -6.9075133e-06,
     + -1.7736918e-05, -6.7859421e-06, 1.4687650e-05, -1.5930611e-06,
     + -3.3514229e-06, -1.1704604e-07, 1.9473249e-06, 1.2716120e-06,
     + -4.5116814e-06, -1.5917530e-06, -1.3674732e-06, 1.7915742e-07,
     + 2.0326223e-07, -7.6959050e-09, -5.8937792e-08, -2.2367883e-08,
     + 1.8280485e-08, -1.6229467e-08, -1.2895665e-08, 2.1498988e-08,
     + 9.6553365e-09, -2.5164364e-09, -1.6634487e-09, 1.0172003e-09,
     + 1.2787264e-09, 1.8300244e-09, -5.5224150e-09, -2.8689856e-09,
     + 1.9876583e-10, -7.0649046e-10, 2.6726078e-10, 
*  lambda=15
     + 1.7813028e+01, 1.0396476e+01, -2.6437845e+00, -3.3280689e+00,
     + 1.0752479e+00, 2.5006099e-04, 8.3736616e-04, 3.6305199e-04,
     + 2.2201098e-04, -3.1435757e-05, 2.7693553e-04, 2.2050758e-04,
     + 4.3442760e-05, -9.2243923e-05, 7.7926570e-05, 1.5994704e-05,
     + 2.9813481e-05, 5.9702577e-06, -1.1504649e-05, 1.1413373e-06,
     + 1.0229310e-06, -3.1165738e-06, -1.9948256e-06, 6.2167272e-06,
     + 3.1666860e-06, 1.6117620e-06, 9.6558704e-07, 1.2606749e-07,
     + -2.5171346e-08, -3.8284240e-08, 7.4165835e-10, -3.1960358e-08,
     + -8.5492903e-09, -1.2322752e-08, 1.2127333e-08, 2.1893513e-08,
     + -2.7460288e-09, -2.2721617e-10, 1.3578006e-09, 8.6114066e-10,
     + -3.1364622e-09, -3.2758118e-09, 2.3199119e-10, -1.3792231e-09,
     + 1.0451870e-09, 6.6641097e-10, 1.1706160e-10 /
* spline fit
      if (ifirst .eq. 0) then
* spline fit of the vl coefficients
         ind=1
         do ilam=1,19
           call dcopy(47,vl(ind),1,vec,1)
*    evaluate derivative at first point
           der1=(vec(2)-vec(1))/(rr(2)-rr(1))
           call dspline(rr,vec,47,der1,0d0,csplin(1,ilam))
           ind = ind + 47
         enddo
         ifirst = 1
       end if
* r^-6 fit to at R = 25 bohr for isotropic part of potential
       c6sum = -5.05056421875e+06
* switching function for long-range
       switch_lr=0.5*(tanh(0.5*(r - 27.d0)) + 1.d0)
* determine splined coefficients at R=r
       ind=1
       do ilam=1,16
         call dcopy(47,vl(ind),1,vec,1)
         call dsplint(rr,vec,csplin(1,ilam),47,r,vvx)
         if (ilam.eq.1) then
* merge with asymptotic form for V0
           vvx = (1.d0 - switch_lr)*vvx 
     +       + switch_lr*c6sum/(r**6)
         else
* kill anisotropic terms at large R
           vvx = (1.d0 - switch_lr)*vvx
         endif
         v(ilam)=vvx
         call dcopy(47,vl(ind),1,vec,1)
         ind = ind + 47
       enddo
       call dcopy(15,v(2),1,vvl(1),1)
* convert to hartree
       econv=1.d0/219474.6d0
       call dscal(15,0.d0,vvl,1)
* isotropic term 
       vv0 = v(1)*econv
*
       return
       end
*===========================eof===============================