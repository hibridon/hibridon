* System:  CH(X 2Pi)+He, ab initio RCCSD(T)/AVQZ+BF PES
* F. Lique 2011, ab initio calculations
* J. Klos 2011, fitting

      subroutine driver
      implicit double precision (a-h,o-z)
      common /cosysr/ xjunk(2),rshift,xfact
      common /covvl/ vvl(23)
      include "common/parpot"
      potnam='He-CH(X) RCCSD(T)/AVQZBF PES'
      print *, potnam
1      print *, ' r (bohr)'
      rshift=0.5
      xfact=0.8
      read (5, *, end=99) r
      call pot(vv0,r)
      write (6, 100) vv0,vvl
100   format(' vsum',/,7(1pe16.8),/,
     :    '  vdif',/,5e16.8)
      goto 1
99    end

      include "common/syusr"
      include "common/bausr"
      include "common/ground"
      subroutine loapot(iunit,filnam)
* ------------------------------------------------------------------------
      character*(*) filnam
      include "common/parbas"
      include "common/parpot"
      potnam='He-CH(X) RCCSD(T)/AVQZBF PES'
      lammin(1)=1
      lammax(1)=12
      lammin(2)=2
      lammax(2)=12
      mproj(1)=0
      mproj(2)=2
      ntv(1)=1
      ivcol(1,1)=0
      ivrow(1,1)=0
      return
      end
* ----------------------------------------------------------------------
      subroutine pot (vv0, r)
*  subroutine to calculate the r-dependent coefficients
*  in atomic units (distance and energy)
* ----------------------------------------------------------------------
*  on entry:
*    r:      interparticle distance
*  on return:
*  vv0        contains isotropic term (d00 term in vsum)
*  variable in common block /covvl/
*    vvl:     vector of length 6 to store r-dependence of each term
*             in potential expansion
*    vvl(1-12) expansion coefficients in dl0 (l=1:12) of vsum
*    vvl(13-23) expansion coefficients in dl2 (l=2:12) of vdif

* uses linear least squares routines from cmlib
* ----------------------------------------------------------------------

      implicit double precision (a-h,o-z)

      common /covvl/ vvl(23)
      data half, zero, one, alph /0.5d0, 0.d0, 1.d0, 1.2d0/
      call dscal(23,zero,vvl,1)
* convert to hartree
      conv=1.d0/219474.6
      vv0=VL0_0(r)*conv
      vvl(1)=VL0_1(r)*conv
      vvl(2)=VL0_2(r)*conv
      vvl(3)=VL0_3(r)*conv
      vvl(4)=VL0_4(r)*conv
      vvl(5)=VL0_5(r)*conv
      vvl(6)=VL0_6(r)*conv
      vvl(7)=VL0_7(r)*conv
      vvl(8)=VL0_8(r)*conv
      vvl(9)=VL0_9(r)*conv
      vvl(10)=VL0_10(r)*conv
      vvl(11)=VL0_11(r)*conv
      vvl(12)=VL0_12(r)*conv
      vvl(13)=VL2_2(r)*conv
      vvl(14)=VL2_3(r)*conv
      vvl(15)=VL2_4(r)*conv
      vvl(16)=VL2_5(r)*conv
      vvl(17)=VL2_6(r)*conv
      vvl(18)=VL2_7(r)*conv
      vvl(19)=VL2_8(r)*conv
      vvl(20)=VL2_9(r)*conv
      vvl(21)=VL2_10(r)*conv
      vvl(22)=VL2_11(r)*conv
      vvl(23)=VL2_12(r)*conv
      end

C PROGRAM TO GENERATE 1-D RKHS FITS OF Vl0 
C RADIAL COEFFICIENTS FOR 
C ANGULAR EXPANSION OF He-XH(X,r=re) RCCSD(T)/AVQZ+BF
C VSUM DIABAT CBS EXTRAPOLATED PES AT r=re
C EXPANSION COEFFFICIENTS IN CM-1
C REPRODUCING KERNEL HILBERT SPACE METHOD 
C---OPTIMIZED FOR EXECUTION TIME BY DIRECT
C---EXPRESIONS OF HYPERGEOMETRIC AND BETA FUNCTIONS
C
C------SAMPLE PROGRAM CALLING PES FUNCTION-------
      FUNCTION VL0_0(RR)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NPT=41)
      DIMENSION VAB(NPT),VCOEF(NPT)
      DIMENSION R(NPT),THETA(NPT)
      DATA R/
     .  3.000D0,
     .  3.250D0,
     .  3.500D0,
     .  3.750D0,
     .  4.000D0,
     .  4.250D0,
     .  4.500D0,
     .  4.750D0,
     .  5.000D0,
     .  5.250D0,
     .  5.500D0,
     .  5.750D0,
     .  6.000D0,
     .  6.250D0,
     .  6.500D0,
     .  6.750D0,
     .  7.000D0,
     .  7.250D0,
     .  7.500D0,
     .  7.750D0,
     .  8.000D0,
     .  8.250D0,
     .  8.500D0,
     .  8.750D0,
     .  9.000D0,
     .  9.250D0,
     .  9.500D0,
     .  9.750D0,
     . 10.000D0,
     . 10.500D0,
     . 11.000D0,
     . 12.000D0,
     . 13.000D0,
     . 14.000D0,
     . 16.000D0,
     . 18.000D0,
     . 20.000D0,
     . 25.000D0,
     . 30.000D0,
     . 40.000D0,
     . 50.000D0/
      DATA VCOEF/
     *    0.132627930905349731D+10,
     *   -0.124015554655652571D+10,
     *    0.491931727477643967D+09,
     *   -0.204964570671424270D+09,
     *   -0.491721369287342764D+07,
     *   -0.114816863025117114D+09,
     *   -0.101276225744748682D+09,
     *   -0.113629162104255736D+09,
     *   -0.111286173257689327D+09,
     *   -0.660818450060067251D+08,
     *   -0.157446332358338773D+09,
     *    0.769114819248459041D+08,
     *   -0.157443283841008693D+09,
     *    0.415438849767587110D+08,
     *   -0.217697434775675870D+08,
     *    0.154779815362055134D+08,
     *    0.168014048985792808D+08,
     *    0.245270171467357203D+08,
     *    0.288332295829418898D+08,
     *    0.281581698371547274D+08,
     *    0.300990361850977130D+08,
     *    0.284394974001292586D+08,
     *    0.250258585589992516D+08,
     *    0.268842677464344203D+08,
     *    0.205048087229007259D+08,
     *    0.161819651198655441D+08,
     *    0.206653227222716287D+08,
     *    0.713717780350813642D+07,
     *    0.194022452036311999D+08,
     *    0.140265027251065411D+08,
     *    0.130530702162187360D+08,
     *    0.725526378226301819D+07,
     *    0.292054594696760294D+06,
     *   -0.144692014569687122D+07,
     *   -0.143931320458636316D+07,
     *   -0.175819347838502889D+07,
     *   -0.652686626483544358D+06,
     *   -0.291896098370623030D+07,
     *    0.780407215001282189D+07,
     *   -0.444303979188962802D+08,
     *    0.796281832102072239D+08/
C Kernel parameters
      M=5
C
C      EVALUATE PES    
       SUMA=ZERO
       DO I=1,NPT
        SUMA=SUMA+VCOEF(I)*RKHS_DKN2(R(I),RR,M)
       END DO
       VL0_0=SUMA
       RETURN
       END
C PROGRAM TO GENERATE 1-D RKHS FITS OF Vl0 
C RADIAL COEFFICIENTS FOR 
C ANGULAR EXPANSION OF He-XH(X,r=re) RCCSD(T)/AVQZ+BF
C VSUM DIABAT CBS EXTRAPOLATED PES AT r=re
C EXPANSION COEFFFICIENTS IN CM-1
C REPRODUCING KERNEL HILBERT SPACE METHOD 
C---OPTIMIZED FOR EXECUTION TIME BY DIRECT
C---EXPRESIONS OF HYPERGEOMETRIC AND BETA FUNCTIONS
C
C------SAMPLE PROGRAM CALLING PES FUNCTION-------
      FUNCTION VL0_10(RR)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NPT=41)
      DIMENSION VAB(NPT),VCOEF(NPT)
      DIMENSION R(NPT),THETA(NPT)
      DATA R/
     .  3.000D0,
     .  3.250D0,
     .  3.500D0,
     .  3.750D0,
     .  4.000D0,
     .  4.250D0,
     .  4.500D0,
     .  4.750D0,
     .  5.000D0,
     .  5.250D0,
     .  5.500D0,
     .  5.750D0,
     .  6.000D0,
     .  6.250D0,
     .  6.500D0,
     .  6.750D0,
     .  7.000D0,
     .  7.250D0,
     .  7.500D0,
     .  7.750D0,
     .  8.000D0,
     .  8.250D0,
     .  8.500D0,
     .  8.750D0,
     .  9.000D0,
     .  9.250D0,
     .  9.500D0,
     .  9.750D0,
     . 10.000D0,
     . 10.500D0,
     . 11.000D0,
     . 12.000D0,
     . 13.000D0,
     . 14.000D0,
     . 16.000D0,
     . 18.000D0,
     . 20.000D0,
     . 25.000D0,
     . 30.000D0,
     . 40.000D0,
     . 50.000D0/
      DATA VCOEF/
     *    0.568263997946612716D+09,
     *   -0.105547826130176783D+10,
     *    0.528221713073625386D+09,
     *   -0.122700425847385287D+09,
     *    0.780076207516928315D+08,
     *   -0.126543355750204306D+08,
     *    0.101076185444267336D+08,
     *    0.727850028938754927D+07,
     *   -0.242277135161880478D+08,
     *    0.116432850277587190D+09,
     *   -0.342397202812934160D+09,
     *    0.564148693747289062D+09,
     *   -0.508757156024167538D+09,
     *    0.254587781911329001D+09,
     *   -0.818300905496400446D+08,
     *    0.273728009301753864D+08,
     *   -0.919709912257020921D+07,
     *    0.478312976295834687D+07,
     *   -0.412159904849727219D+07,
     *    0.437252059954402875D+07,
     *   -0.460304949152101390D+07,
     *    0.300722679716092814D+07,
     *   -0.136703599379381922D+06,
     *    0.257370591652689502D+06,
     *   -0.838998869126295671D+07,
     *    0.186573010055429675D+08,
     *   -0.208697023564122356D+08,
     *    0.153589855008444209D+08,
     *   -0.664393098926479928D+07,
     *    0.209534716246246477D+07,
     *   -0.113789538178112451D+07,
     *    0.749547892492894607D+05,
     *    0.283111860785570403D+06,
     *   -0.259641051629817695D+06,
     *    0.426365841908903152D+06,
     *   -0.109028774866296421D+07,
     *    0.826967396653986536D+06,
     *    0.325427673974318895D+07,
     *   -0.973881660979376920D+07,
     *    0.164949152013493013D+08,
     *   -0.132383518146551810D+08/
C Kernel parameters
      M=5
C
C      EVALUATE PES    
       SUMA=ZERO
       DO I=1,NPT
        SUMA=SUMA+VCOEF(I)*RKHS_DKN2(R(I),RR,M)
       END DO
       VL0_10=SUMA
       RETURN
       END
C PROGRAM TO GENERATE 1-D RKHS FITS OF Vl0 
C RADIAL COEFFICIENTS FOR 
C ANGULAR EXPANSION OF He-XH(X,r=re) RCCSD(T)/AVQZ+BF
C VSUM DIABAT CBS EXTRAPOLATED PES AT r=re
C EXPANSION COEFFFICIENTS IN CM-1
C REPRODUCING KERNEL HILBERT SPACE METHOD 
C---OPTIMIZED FOR EXECUTION TIME BY DIRECT
C---EXPRESIONS OF HYPERGEOMETRIC AND BETA FUNCTIONS
C
C------SAMPLE PROGRAM CALLING PES FUNCTION-------
      FUNCTION VL0_11(RR)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NPT=41)
      DIMENSION VAB(NPT),VCOEF(NPT)
      DIMENSION R(NPT),THETA(NPT)
      DATA R/
     .  3.000D0,
     .  3.250D0,
     .  3.500D0,
     .  3.750D0,
     .  4.000D0,
     .  4.250D0,
     .  4.500D0,
     .  4.750D0,
     .  5.000D0,
     .  5.250D0,
     .  5.500D0,
     .  5.750D0,
     .  6.000D0,
     .  6.250D0,
     .  6.500D0,
     .  6.750D0,
     .  7.000D0,
     .  7.250D0,
     .  7.500D0,
     .  7.750D0,
     .  8.000D0,
     .  8.250D0,
     .  8.500D0,
     .  8.750D0,
     .  9.000D0,
     .  9.250D0,
     .  9.500D0,
     .  9.750D0,
     . 10.000D0,
     . 10.500D0,
     . 11.000D0,
     . 12.000D0,
     . 13.000D0,
     . 14.000D0,
     . 16.000D0,
     . 18.000D0,
     . 20.000D0,
     . 25.000D0,
     . 30.000D0,
     . 40.000D0,
     . 50.000D0/
      DATA VCOEF/
     *   -0.679551076744881868D+09,
     *    0.128780627115058398D+10,
     *   -0.663336828772182703D+09,
     *    0.151118544061458170D+09,
     *   -0.968598283741160184D+08,
     *    0.184260289398340471D+08,
     *   -0.126832175893214457D+08,
     *   -0.134028722161256708D+07,
     *   -0.632389435648364667D+07,
     *    0.274178481008727029D+08,
     *   -0.844313634416287243D+08,
     *    0.135336775583439738D+09,
     *   -0.121323830447384670D+09,
     *    0.613654986624147519D+08,
     *   -0.191474572272482179D+08,
     *    0.450756911015518103D+07,
     *   -0.102836322086283553D+07,
     *   -0.100974013807288907D+07,
     *    0.105210357934624865D+07,
     *   -0.470682975029282563D+06,
     *    0.192194154009255557D+07,
     *   -0.421187825844703894D+07,
     *    0.775293395533084217D+07,
     *   -0.903337760235082731D+07,
     *    0.514515200713767018D+07,
     *    0.205944188884783722D+07,
     *   -0.803290342830046546D+07,
     *    0.100067859078836590D+08,
     *   -0.703276172606267966D+07,
     *    0.309076582514160732D+07,
     *   -0.156033287933329120D+07,
     *    0.147721251858955249D+06,
     *    0.633429892610455514D+06,
     *   -0.179325069938741653D+06,
     *   -0.112226346509380988D+07,
     *    0.135687243489523767D+07,
     *    0.590043761631263071D+06,
     *   -0.479855003078061715D+07,
     *    0.452154144491225295D+07,
     *    0.113387176994943935D+08,
     *   -0.190338451577845477D+08/
C Kernel parameters
      M=5
C
C      EVALUATE PES    
       SUMA=ZERO
       DO I=1,NPT
        SUMA=SUMA+VCOEF(I)*RKHS_DKN2(R(I),RR,M)
       END DO
       VL0_11=SUMA
       RETURN
       END
C PROGRAM TO GENERATE 1-D RKHS FITS OF Vl0 
C RADIAL COEFFICIENTS FOR 
C ANGULAR EXPANSION OF He-XH(X,r=re) RCCSD(T)/AVQZ+BF
C VSUM DIABAT CBS EXTRAPOLATED PES AT r=re
C EXPANSION COEFFFICIENTS IN CM-1
C REPRODUCING KERNEL HILBERT SPACE METHOD 
C---OPTIMIZED FOR EXECUTION TIME BY DIRECT
C---EXPRESIONS OF HYPERGEOMETRIC AND BETA FUNCTIONS
C
C------SAMPLE PROGRAM CALLING PES FUNCTION-------
      FUNCTION VL0_12(RR)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NPT=41)
      DIMENSION VAB(NPT),VCOEF(NPT)
      DIMENSION R(NPT),THETA(NPT)
      DATA R/
     .  3.000D0,
     .  3.250D0,
     .  3.500D0,
     .  3.750D0,
     .  4.000D0,
     .  4.250D0,
     .  4.500D0,
     .  4.750D0,
     .  5.000D0,
     .  5.250D0,
     .  5.500D0,
     .  5.750D0,
     .  6.000D0,
     .  6.250D0,
     .  6.500D0,
     .  6.750D0,
     .  7.000D0,
     .  7.250D0,
     .  7.500D0,
     .  7.750D0,
     .  8.000D0,
     .  8.250D0,
     .  8.500D0,
     .  8.750D0,
     .  9.000D0,
     .  9.250D0,
     .  9.500D0,
     .  9.750D0,
     . 10.000D0,
     . 10.500D0,
     . 11.000D0,
     . 12.000D0,
     . 13.000D0,
     . 14.000D0,
     . 16.000D0,
     . 18.000D0,
     . 20.000D0,
     . 25.000D0,
     . 30.000D0,
     . 40.000D0,
     . 50.000D0/
      DATA VCOEF/
     *    0.334829694804091036D+09,
     *   -0.637177965706064939D+09,
     *    0.330180010423739493D+09,
     *   -0.751100066694152504D+08,
     *    0.483050146940323040D+08,
     *   -0.953100351890600473D+07,
     *    0.650023063797525596D+07,
     *   -0.116257224507967755D+07,
     *    0.121125838159113489D+08,
     *   -0.559766161235363036D+08,
     *    0.167542430863985896D+09,
     *   -0.273235708020397782D+09,
     *    0.245886222198947549D+09,
     *   -0.123426763882877812D+09,
     *    0.394175795130615830D+08,
     *   -0.124036820196105670D+08,
     *    0.510430974803024158D+07,
     *   -0.344761226850454323D+07,
     *    0.420620319867479336D+07,
     *   -0.447973265136776026D+07,
     *    0.298503638750801422D+07,
     *   -0.287688421154927043D+07,
     *    0.459627378474868461D+07,
     *   -0.671279549470973294D+07,
     *    0.835698502088448126D+07,
     *   -0.101608429860462975D+08,
     *    0.107853714189108852D+08,
     *   -0.857992300795439258D+07,
     *    0.445891324178196117D+07,
     *   -0.149477237941084686D+07,
     *    0.610550830514676869D+06,
     *   -0.290884930931294875D+05,
     *   -0.264493130790433788D+06,
     *    0.411974316458164714D+06,
     *   -0.766540297575994977D+06,
     *    0.159377955243740138D+07,
     *   -0.146682865622562403D+07,
     *   -0.200287376580634713D+07,
     *    0.913406635781733692D+07,
     *   -0.216825975545087606D+08,
     *    0.207034662242114246D+08/
C Kernel parameters
      M=5
C
C      EVALUATE PES    
       SUMA=ZERO
       DO I=1,NPT
        SUMA=SUMA+VCOEF(I)*RKHS_DKN2(R(I),RR,M)
       END DO
       VL0_12=SUMA
       RETURN
       END
C PROGRAM TO GENERATE 1-D RKHS FITS OF Vl0 
C RADIAL COEFFICIENTS FOR 
C ANGULAR EXPANSION OF He-XH(X,r=re) RCCSD(T)/AVQZ+BF
C VSUM DIABAT CBS EXTRAPOLATED PES AT r=re
C EXPANSION COEFFFICIENTS IN CM-1
C REPRODUCING KERNEL HILBERT SPACE METHOD 
C---OPTIMIZED FOR EXECUTION TIME BY DIRECT
C---EXPRESIONS OF HYPERGEOMETRIC AND BETA FUNCTIONS
C
C------SAMPLE PROGRAM CALLING PES FUNCTION-------
      FUNCTION VL0_1(RR)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NPT=41)
      DIMENSION VAB(NPT),VCOEF(NPT)
      DIMENSION R(NPT),THETA(NPT)
      DATA R/
     .  3.000D0,
     .  3.250D0,
     .  3.500D0,
     .  3.750D0,
     .  4.000D0,
     .  4.250D0,
     .  4.500D0,
     .  4.750D0,
     .  5.000D0,
     .  5.250D0,
     .  5.500D0,
     .  5.750D0,
     .  6.000D0,
     .  6.250D0,
     .  6.500D0,
     .  6.750D0,
     .  7.000D0,
     .  7.250D0,
     .  7.500D0,
     .  7.750D0,
     .  8.000D0,
     .  8.250D0,
     .  8.500D0,
     .  8.750D0,
     .  9.000D0,
     .  9.250D0,
     .  9.500D0,
     .  9.750D0,
     . 10.000D0,
     . 10.500D0,
     . 11.000D0,
     . 12.000D0,
     . 13.000D0,
     . 14.000D0,
     . 16.000D0,
     . 18.000D0,
     . 20.000D0,
     . 25.000D0,
     . 30.000D0,
     . 40.000D0,
     . 50.000D0/
      DATA VCOEF/
     *   -0.809321926060724378D+09,
     *    0.989958332332902551D+09,
     *   -0.392445642224790573D+09,
     *    0.143832830158969104D+09,
     *   -0.240562867113745287D+08,
     *    0.544211329125818387D+08,
     *    0.390648116047098190D+08,
     *    0.444136186010636091D+08,
     *    0.398829302151533812D+08,
     *    0.544650708138131630D+07,
     *    0.791583466128372103D+08,
     *   -0.982400052982227802D+08,
     *    0.898694878176632673D+08,
     *   -0.568276623579053208D+08,
     *    0.635089867292213487D+06,
     *   -0.200942529082984328D+08,
     *   -0.150591722268849611D+08,
     *   -0.148395715308853034D+08,
     *   -0.157160924452340510D+08,
     *   -0.120748358581544124D+08,
     *   -0.109840309128919393D+08,
     *   -0.697458264200859610D+07,
     *   -0.747952926050401386D+07,
     *    0.194103438114129519D+07,
     *   -0.634670898593753483D+07,
     *    0.356881182935953490D+06,
     *   -0.819665910139702260D+06,
     *    0.161925260737224342D+07,
     *   -0.385345359545139549D+07,
     *    0.123242257900854945D+07,
     *   -0.341237164295048174D+07,
     *    0.881861483256780892D+06,
     *    0.477360402213535795D+06,
     *    0.568932015052365791D+07,
     *    0.130448297357530501D+08,
     *   -0.190407722752001360D+08,
     *    0.318640428065219335D+07,
     *    0.399275502189573739D+07,
     *   -0.461094795289606322D+07,
     *    0.968171328926549479D+07,
     *   -0.970327142800819874D+07/
C Kernel parameters
      M=5
C
C      EVALUATE PES    
       SUMA=ZERO
       DO I=1,NPT
        SUMA=SUMA+VCOEF(I)*RKHS_DKN2(R(I),RR,M)
       END DO
       VL0_1=SUMA
       RETURN
       END
C PROGRAM TO GENERATE 1-D RKHS FITS OF Vl0 
C RADIAL COEFFICIENTS FOR 
C ANGULAR EXPANSION OF He-XH(X,r=re) RCCSD(T)/AVQZ+BF
C VSUM DIABAT CBS EXTRAPOLATED PES AT r=re
C EXPANSION COEFFFICIENTS IN CM-1
C REPRODUCING KERNEL HILBERT SPACE METHOD 
C---OPTIMIZED FOR EXECUTION TIME BY DIRECT
C---EXPRESIONS OF HYPERGEOMETRIC AND BETA FUNCTIONS
C
C------SAMPLE PROGRAM CALLING PES FUNCTION-------
      FUNCTION VL0_2(RR)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NPT=41)
      DIMENSION VAB(NPT),VCOEF(NPT)
      DIMENSION R(NPT),THETA(NPT)
      DATA R/
     .  3.000D0,
     .  3.250D0,
     .  3.500D0,
     .  3.750D0,
     .  4.000D0,
     .  4.250D0,
     .  4.500D0,
     .  4.750D0,
     .  5.000D0,
     .  5.250D0,
     .  5.500D0,
     .  5.750D0,
     .  6.000D0,
     .  6.250D0,
     .  6.500D0,
     .  6.750D0,
     .  7.000D0,
     .  7.250D0,
     .  7.500D0,
     .  7.750D0,
     .  8.000D0,
     .  8.250D0,
     .  8.500D0,
     .  8.750D0,
     .  9.000D0,
     .  9.250D0,
     .  9.500D0,
     .  9.750D0,
     . 10.000D0,
     . 10.500D0,
     . 11.000D0,
     . 12.000D0,
     . 13.000D0,
     . 14.000D0,
     . 16.000D0,
     . 18.000D0,
     . 20.000D0,
     . 25.000D0,
     . 30.000D0,
     . 40.000D0,
     . 50.000D0/
      DATA VCOEF/
     *    0.164203641271455026D+10,
     *   -0.159075959916841817D+10,
     *    0.632560912057312489D+09,
     *   -0.247067459688376665D+09,
     *    0.123821173477148227D+08,
     *   -0.127351529760156795D+09,
     *   -0.112632148966266796D+09,
     *   -0.135913839814358085D+09,
     *   -0.111481276235886276D+09,
     *   -0.165686077172349036D+09,
     *    0.727666287105184346D+08,
     *   -0.334627472349300802D+09,
     *    0.199100112375567168D+09,
     *   -0.139871788073955566D+09,
     *    0.390586352774148360D+08,
     *    0.332955806556566758D+07,
     *    0.294543501960846558D+08,
     *    0.313273812987922020D+08,
     *    0.357171628228751644D+08,
     *    0.383862850976798832D+08,
     *    0.337550653838189021D+08,
     *    0.345989738754793257D+08,
     *    0.307187791620855555D+08,
     *    0.254599368710845821D+08,
     *    0.231685200537378564D+08,
     *    0.204273059720595255D+08,
     *    0.130626053924355898D+08,
     *    0.149410853493686374D+08,
     *    0.122282284853205904D+08,
     *    0.114507334217880853D+08,
     *    0.954587608444211446D+07,
     *    0.474305160278903600D+07,
     *   -0.136824999422475649D+07,
     *   -0.538204687999494417D+05,
     *   -0.141479471111825737D+07,
     *   -0.372693139360927977D+07,
     *    0.149682946391211194D+07,
     *   -0.242076770240899269D+07,
     *    0.465412042973558791D+07,
     *   -0.240303245096969604D+08,
     *    0.398021604530177563D+08/
C Kernel parameters
      M=5
C
C      EVALUATE PES    
       SUMA=ZERO
       DO I=1,NPT
        SUMA=SUMA+VCOEF(I)*RKHS_DKN2(R(I),RR,M)
       END DO
       VL0_2=SUMA
       RETURN
       END
C PROGRAM TO GENERATE 1-D RKHS FITS OF Vl0 
C RADIAL COEFFICIENTS FOR 
C ANGULAR EXPANSION OF He-XH(X,r=re) RCCSD(T)/AVQZ+BF
C VSUM DIABAT CBS EXTRAPOLATED PES AT r=re
C EXPANSION COEFFFICIENTS IN CM-1
C REPRODUCING KERNEL HILBERT SPACE METHOD 
C---OPTIMIZED FOR EXECUTION TIME BY DIRECT
C---EXPRESIONS OF HYPERGEOMETRIC AND BETA FUNCTIONS
C
C------SAMPLE PROGRAM CALLING PES FUNCTION-------
      FUNCTION VL0_3(RR)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NPT=41)
      DIMENSION VAB(NPT),VCOEF(NPT)
      DIMENSION R(NPT),THETA(NPT)
      DATA R/
     .  3.000D0,
     .  3.250D0,
     .  3.500D0,
     .  3.750D0,
     .  4.000D0,
     .  4.250D0,
     .  4.500D0,
     .  4.750D0,
     .  5.000D0,
     .  5.250D0,
     .  5.500D0,
     .  5.750D0,
     .  6.000D0,
     .  6.250D0,
     .  6.500D0,
     .  6.750D0,
     .  7.000D0,
     .  7.250D0,
     .  7.500D0,
     .  7.750D0,
     .  8.000D0,
     .  8.250D0,
     .  8.500D0,
     .  8.750D0,
     .  9.000D0,
     .  9.250D0,
     .  9.500D0,
     .  9.750D0,
     . 10.000D0,
     . 10.500D0,
     . 11.000D0,
     . 12.000D0,
     . 13.000D0,
     . 14.000D0,
     . 16.000D0,
     . 18.000D0,
     . 20.000D0,
     . 25.000D0,
     . 30.000D0,
     . 40.000D0,
     . 50.000D0/
      DATA VCOEF/
     *   -0.967093972073919892D+09,
     *    0.112309510300428343D+10,
     *   -0.524616391691188335D+09,
     *    0.135280514160759151D+09,
     *   -0.517872542667202577D+08,
     *    0.566940516004767567D+08,
     *    0.526300452455143034D+08,
     *    0.779883015722802430D+08,
     *    0.593371507472361550D+08,
     *    0.136548112354762048D+09,
     *   -0.136142327914724886D+09,
     *    0.370987044649486125D+09,
     *   -0.257495045558138430D+09,
     *    0.164901444521400243D+09,
     *   -0.397989448479489461D+08,
     *    0.119711628185425829D+08,
     *   -0.150432851759227030D+08,
     *   -0.142087242293036077D+08,
     *   -0.200171389389755391D+08,
     *   -0.214481737208460756D+08,
     *   -0.205238974472893924D+08,
     *   -0.229596496953747086D+08,
     *   -0.879369123326757550D+07,
     *   -0.297290469157204516D+08,
     *   -0.155635939756865427D+07,
     *   -0.147618576872157939D+08,
     *   -0.141519920461351108D+08,
     *   -0.363787881717575248D+07,
     *   -0.915867636890299059D+07,
     *   -0.107996062333735488D+08,
     *   -0.589394692380764149D+07,
     *   -0.349034903757752106D+07,
     *    0.511619498865994858D+06,
     *    0.836980089393436792D+06,
     *    0.529067610435413080D+06,
     *    0.462949440951779205D+07,
     *   -0.696800684028999507D+07,
     *    0.885392904052592814D+07,
     *   -0.687126731759561505D+07,
     *    0.513010772728152387D+07,
     *   -0.514857755336084031D+07/
C Kernel parameters
      M=5
C
C      EVALUATE PES    
       SUMA=ZERO
       DO I=1,NPT
        SUMA=SUMA+VCOEF(I)*RKHS_DKN2(R(I),RR,M)
       END DO
       VL0_3=SUMA
       RETURN
       END
C PROGRAM TO GENERATE 1-D RKHS FITS OF Vl0 
C RADIAL COEFFICIENTS FOR 
C ANGULAR EXPANSION OF He-XH(X,r=re) RCCSD(T)/AVQZ+BF
C VSUM DIABAT CBS EXTRAPOLATED PES AT r=re
C EXPANSION COEFFFICIENTS IN CM-1
C REPRODUCING KERNEL HILBERT SPACE METHOD 
C---OPTIMIZED FOR EXECUTION TIME BY DIRECT
C---EXPRESIONS OF HYPERGEOMETRIC AND BETA FUNCTIONS
C
C------SAMPLE PROGRAM CALLING PES FUNCTION-------
      FUNCTION VL0_4(RR)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NPT=41)
      DIMENSION VAB(NPT),VCOEF(NPT)
      DIMENSION R(NPT),THETA(NPT)
      DATA R/
     .  3.000D0,
     .  3.250D0,
     .  3.500D0,
     .  3.750D0,
     .  4.000D0,
     .  4.250D0,
     .  4.500D0,
     .  4.750D0,
     .  5.000D0,
     .  5.250D0,
     .  5.500D0,
     .  5.750D0,
     .  6.000D0,
     .  6.250D0,
     .  6.500D0,
     .  6.750D0,
     .  7.000D0,
     .  7.250D0,
     .  7.500D0,
     .  7.750D0,
     .  8.000D0,
     .  8.250D0,
     .  8.500D0,
     .  8.750D0,
     .  9.000D0,
     .  9.250D0,
     .  9.500D0,
     .  9.750D0,
     . 10.000D0,
     . 10.500D0,
     . 11.000D0,
     . 12.000D0,
     . 13.000D0,
     . 14.000D0,
     . 16.000D0,
     . 18.000D0,
     . 20.000D0,
     . 25.000D0,
     . 30.000D0,
     . 40.000D0,
     . 50.000D0/
      DATA VCOEF/
     *    0.118298768667910933D+10,
     *   -0.157594610719338942D+10,
     *    0.610184649957860351D+09,
     *   -0.198028130273861706D+09,
     *    0.775925979765934497D+08,
     *   -0.367469670759841204D+08,
     *   -0.148233126354324557D+08,
     *   -0.314286751617347337D+08,
     *   -0.366669411447974294D+08,
     *    0.687499691118997335D+07,
     *   -0.128890981958516195D+09,
     *    0.151164101684380114D+09,
     *   -0.167678336648372352D+09,
     *    0.698735623366781920D+08,
     *   -0.256839253395046107D+08,
     *    0.114030791153499819D+08,
     *    0.263322765291039506D+07,
     *    0.126445463604682218D+08,
     *    0.583279040926983021D+07,
     *    0.146380650801284872D+08,
     *    0.882080875856482051D+07,
     *    0.638659009870219976D+07,
     *    0.201929612413901761D+08,
     *   -0.645089453644263092D+07,
     *    0.154948947606118768D+08,
     *    0.856956467194286361D+07,
     *   -0.598816948559556808D+07,
     *    0.184681762087102272D+08,
     *   -0.466220556681039091D+07,
     *    0.692841408523737174D+07,
     *    0.193763472660832829D+07,
     *    0.286333716616755025D+07,
     *   -0.181407448723709350D+07,
     *    0.375161104053518095D+06,
     *   -0.192247705854666012D+06,
     *   -0.233543372457046853D+07,
     *    0.384287011071091983D+07,
     *   -0.928620317444013804D+07,
     *    0.224923009146889597D+08,
     *   -0.603619551103961468D+08,
     *    0.641159735069807246D+08/
C Kernel parameters
      M=5
C
C      EVALUATE PES    
       SUMA=ZERO
       DO I=1,NPT
        SUMA=SUMA+VCOEF(I)*RKHS_DKN2(R(I),RR,M)
       END DO
       VL0_4=SUMA
       RETURN
       END
C PROGRAM TO GENERATE 1-D RKHS FITS OF Vl0 
C RADIAL COEFFICIENTS FOR 
C ANGULAR EXPANSION OF He-XH(X,r=re) RCCSD(T)/AVQZ+BF
C VSUM DIABAT CBS EXTRAPOLATED PES AT r=re
C EXPANSION COEFFFICIENTS IN CM-1
C REPRODUCING KERNEL HILBERT SPACE METHOD 
C---OPTIMIZED FOR EXECUTION TIME BY DIRECT
C---EXPRESIONS OF HYPERGEOMETRIC AND BETA FUNCTIONS
C
C------SAMPLE PROGRAM CALLING PES FUNCTION-------
      FUNCTION VL0_5(RR)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NPT=41)
      DIMENSION VAB(NPT),VCOEF(NPT)
      DIMENSION R(NPT),THETA(NPT)
      DATA R/
     .  3.000D0,
     .  3.250D0,
     .  3.500D0,
     .  3.750D0,
     .  4.000D0,
     .  4.250D0,
     .  4.500D0,
     .  4.750D0,
     .  5.000D0,
     .  5.250D0,
     .  5.500D0,
     .  5.750D0,
     .  6.000D0,
     .  6.250D0,
     .  6.500D0,
     .  6.750D0,
     .  7.000D0,
     .  7.250D0,
     .  7.500D0,
     .  7.750D0,
     .  8.000D0,
     .  8.250D0,
     .  8.500D0,
     .  8.750D0,
     .  9.000D0,
     .  9.250D0,
     .  9.500D0,
     .  9.750D0,
     . 10.000D0,
     . 10.500D0,
     . 11.000D0,
     . 12.000D0,
     . 13.000D0,
     . 14.000D0,
     . 16.000D0,
     . 18.000D0,
     . 20.000D0,
     . 25.000D0,
     . 30.000D0,
     . 40.000D0,
     . 50.000D0/
      DATA VCOEF/
     *   -0.763687313696697712D+09,
     *    0.108529068863144469D+10,
     *   -0.449213546070548236D+09,
     *    0.139009306963094652D+09,
     *   -0.556059009887651503D+08,
     *    0.234948517878516950D+08,
     *    0.708903642594724335D+07,
     *    0.130588659719026666D+08,
     *    0.361525967096074149D+08,
     *   -0.910901795568629503D+08,
     *    0.317438036806302905D+09,
     *   -0.495544950629698277D+09,
     *    0.459071587246721387D+09,
     *   -0.224480138462186545D+09,
     *    0.720273730398442745D+08,
     *   -0.262913104247554652D+08,
     *    0.439008803543513454D+07,
     *   -0.763526738766649738D+07,
     *   -0.495188845266803261D+07,
     *   -0.535486479446953069D+07,
     *   -0.506210561687836796D+07,
     *   -0.501676178285233863D+07,
     *   -0.248697319948927872D+07,
     *   -0.693035428978249803D+07,
     *   -0.176463020300823450D+07,
     *   -0.151728481132809795D+07,
     *   -0.294929239863495436D+07,
     *   -0.446984576543219201D+07,
     *    0.283453111396902706D+07,
     *   -0.573889716063829791D+07,
     *   -0.282998079130472674D+06,
     *   -0.617383851606605109D+06,
     *    0.390538938068329357D+06,
     *    0.604402119151518127D+05,
     *    0.155203357712464919D+07,
     *   -0.599452707905796450D+07,
     *    0.898993262363843434D+07,
     *   -0.117520964853660297D+08,
     *    0.136986216629985608D+08,
     *   -0.159015311213590130D+08,
     *    0.134022599558915105D+08/
C Kernel parameters
      M=5
C
C      EVALUATE PES    
       SUMA=ZERO
       DO I=1,NPT
        SUMA=SUMA+VCOEF(I)*RKHS_DKN2(R(I),RR,M)
       END DO
       VL0_5=SUMA
       RETURN
       END
C PROGRAM TO GENERATE 1-D RKHS FITS OF Vl0 
C RADIAL COEFFICIENTS FOR 
C ANGULAR EXPANSION OF He-XH(X,r=re) RCCSD(T)/AVQZ+BF
C VSUM DIABAT CBS EXTRAPOLATED PES AT r=re
C EXPANSION COEFFFICIENTS IN CM-1
C REPRODUCING KERNEL HILBERT SPACE METHOD 
C---OPTIMIZED FOR EXECUTION TIME BY DIRECT
C---EXPRESIONS OF HYPERGEOMETRIC AND BETA FUNCTIONS
C
C------SAMPLE PROGRAM CALLING PES FUNCTION-------
      FUNCTION VL0_6(RR)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NPT=41)
      DIMENSION VAB(NPT),VCOEF(NPT)
      DIMENSION R(NPT),THETA(NPT)
      DATA R/
     .  3.000D0,
     .  3.250D0,
     .  3.500D0,
     .  3.750D0,
     .  4.000D0,
     .  4.250D0,
     .  4.500D0,
     .  4.750D0,
     .  5.000D0,
     .  5.250D0,
     .  5.500D0,
     .  5.750D0,
     .  6.000D0,
     .  6.250D0,
     .  6.500D0,
     .  6.750D0,
     .  7.000D0,
     .  7.250D0,
     .  7.500D0,
     .  7.750D0,
     .  8.000D0,
     .  8.250D0,
     .  8.500D0,
     .  8.750D0,
     .  9.000D0,
     .  9.250D0,
     .  9.500D0,
     .  9.750D0,
     . 10.000D0,
     . 10.500D0,
     . 11.000D0,
     . 12.000D0,
     . 13.000D0,
     . 14.000D0,
     . 16.000D0,
     . 18.000D0,
     . 20.000D0,
     . 25.000D0,
     . 30.000D0,
     . 40.000D0,
     . 50.000D0/
      DATA VCOEF/
     *    0.842880395108633995D+09,
     *   -0.133869582267772698D+10,
     *    0.564200212389197350D+09,
     *   -0.152930156482810527D+09,
     *    0.846002719550872296D+08,
     *   -0.135516668275961075D+08,
     *    0.853330146673200279D+07,
     *   -0.575919330401954800D+07,
     *   -0.686145907578388229D+07,
     *    0.110403541804241743D+08,
     *   -0.468617709105407819D+08,
     *    0.692539558197858930D+08,
     *   -0.661559404494167566D+08,
     *    0.325658301404795386D+08,
     *   -0.100392905029324014D+08,
     *    0.557145411541613191D+07,
     *    0.236518924579422717D+06,
     *    0.269229075173922675D+07,
     *    0.417544533615840646D+07,
     *   -0.375553027212097426D+06,
     *    0.420732162095886655D+07,
     *    0.163375465368489875D+07,
     *   -0.142844413510228018D+07,
     *    0.783345178042574599D+07,
     *   -0.168408556506803329D+07,
     *   -0.256276005784391332D+07,
     *    0.132178325869171601D+08,
     *   -0.164786114901659396D+08,
     *    0.112358342388901487D+08,
     *   -0.161546075964680617D+07,
     *    0.111049177061093436D+07,
     *    0.485988776711075043D+06,
     *   -0.289881411535520630D+06,
     *   -0.307960365911980392D+06,
     *    0.147180887456779077D+06,
     *    0.927336184644264635D+06,
     *   -0.118232531369021698D+07,
     *   -0.190310024934194889D+07,
     *    0.432953691019430384D+07,
     *   -0.163198296481873863D+07,
     *   -0.159484598433193425D+07/
C Kernel parameters
      M=5
C
C      EVALUATE PES    
       SUMA=ZERO
       DO I=1,NPT
        SUMA=SUMA+VCOEF(I)*RKHS_DKN2(R(I),RR,M)
       END DO
       VL0_6=SUMA
       RETURN
       END
C PROGRAM TO GENERATE 1-D RKHS FITS OF Vl0 
C RADIAL COEFFICIENTS FOR 
C ANGULAR EXPANSION OF He-XH(X,r=re) RCCSD(T)/AVQZ+BF
C VSUM DIABAT CBS EXTRAPOLATED PES AT r=re
C EXPANSION COEFFFICIENTS IN CM-1
C REPRODUCING KERNEL HILBERT SPACE METHOD 
C---OPTIMIZED FOR EXECUTION TIME BY DIRECT
C---EXPRESIONS OF HYPERGEOMETRIC AND BETA FUNCTIONS
C
C------SAMPLE PROGRAM CALLING PES FUNCTION-------
      FUNCTION VL0_7(RR)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NPT=41)
      DIMENSION VAB(NPT),VCOEF(NPT)
      DIMENSION R(NPT),THETA(NPT)
      DATA R/
     .  3.000D0,
     .  3.250D0,
     .  3.500D0,
     .  3.750D0,
     .  4.000D0,
     .  4.250D0,
     .  4.500D0,
     .  4.750D0,
     .  5.000D0,
     .  5.250D0,
     .  5.500D0,
     .  5.750D0,
     .  6.000D0,
     .  6.250D0,
     .  6.500D0,
     .  6.750D0,
     .  7.000D0,
     .  7.250D0,
     .  7.500D0,
     .  7.750D0,
     .  8.000D0,
     .  8.250D0,
     .  8.500D0,
     .  8.750D0,
     .  9.000D0,
     .  9.250D0,
     .  9.500D0,
     .  9.750D0,
     . 10.000D0,
     . 10.500D0,
     . 11.000D0,
     . 12.000D0,
     . 13.000D0,
     . 14.000D0,
     . 16.000D0,
     . 18.000D0,
     . 20.000D0,
     . 25.000D0,
     . 30.000D0,
     . 40.000D0,
     . 50.000D0/
      DATA VCOEF/
     *   -0.633636170173635483D+09,
     *    0.103058370721821320D+10,
     *   -0.433585812204672515D+09,
     *    0.117599041974593937D+09,
     *   -0.674888208393168449D+08,
     *    0.722149979752164148D+07,
     *   -0.118979707759380843D+08,
     *    0.636462996527948044D+07,
     *   -0.241399952750839293D+08,
     *    0.113368251368672013D+09,
     *   -0.334845976853445947D+09,
     *    0.549720289792010546D+09,
     *   -0.494936633219700098D+09,
     *    0.247013078928832531D+09,
     *   -0.798440172638496011D+08,
     *    0.249156341583596356D+08,
     *   -0.105755043093236256D+08,
     *    0.290491046447747480D+07,
     *   -0.265508318927056901D+07,
     *   -0.302084694797916629D+06,
     *   -0.291837641721566068D+07,
     *    0.686533332148344815D+07,
     *   -0.168238530953935273D+08,
     *    0.224123211797606610D+08,
     *   -0.206619662603405751D+08,
     *    0.552367504654322285D+07,
     *    0.179581561529263621D+07,
     *    0.405421864816179452D+07,
     *   -0.898231766000457853D+07,
     *    0.536105562944153231D+07,
     *   -0.315443276282142894D+07,
     *    0.153024398488577781D+07,
     *   -0.234141719898642134D+07,
     *    0.281676660661474569D+07,
     *   -0.344324190759707615D+07,
     *    0.460528126216357853D+07,
     *   -0.395666700192039367D+07,
     *    0.626755329286736809D+07,
     *   -0.687241926988860779D+07,
     *   -0.760045884636481479D+07,
     *    0.157808319892748483D+08/
C Kernel parameters
      M=5
C
C      EVALUATE PES    
       SUMA=ZERO
       DO I=1,NPT
        SUMA=SUMA+VCOEF(I)*RKHS_DKN2(R(I),RR,M)
       END DO
       VL0_7=SUMA
       RETURN
       END
C PROGRAM TO GENERATE 1-D RKHS FITS OF Vl0 
C RADIAL COEFFICIENTS FOR 
C ANGULAR EXPANSION OF He-XH(X,r=re) RCCSD(T)/AVQZ+BF
C VSUM DIABAT CBS EXTRAPOLATED PES AT r=re
C EXPANSION COEFFFICIENTS IN CM-1
C REPRODUCING KERNEL HILBERT SPACE METHOD 
C---OPTIMIZED FOR EXECUTION TIME BY DIRECT
C---EXPRESIONS OF HYPERGEOMETRIC AND BETA FUNCTIONS
C
C------SAMPLE PROGRAM CALLING PES FUNCTION-------
      FUNCTION VL0_8(RR)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NPT=41)
      DIMENSION VAB(NPT),VCOEF(NPT)
      DIMENSION R(NPT),THETA(NPT)
      DATA R/
     .  3.000D0,
     .  3.250D0,
     .  3.500D0,
     .  3.750D0,
     .  4.000D0,
     .  4.250D0,
     .  4.500D0,
     .  4.750D0,
     .  5.000D0,
     .  5.250D0,
     .  5.500D0,
     .  5.750D0,
     .  6.000D0,
     .  6.250D0,
     .  6.500D0,
     .  6.750D0,
     .  7.000D0,
     .  7.250D0,
     .  7.500D0,
     .  7.750D0,
     .  8.000D0,
     .  8.250D0,
     .  8.500D0,
     .  8.750D0,
     .  9.000D0,
     .  9.250D0,
     .  9.500D0,
     .  9.750D0,
     . 10.000D0,
     . 10.500D0,
     . 11.000D0,
     . 12.000D0,
     . 13.000D0,
     . 14.000D0,
     . 16.000D0,
     . 18.000D0,
     . 20.000D0,
     . 25.000D0,
     . 30.000D0,
     . 40.000D0,
     . 50.000D0/
      DATA VCOEF/
     *    0.599527868193629503D+09,
     *   -0.104002085811517489D+10,
     *    0.474772170096479297D+09,
     *   -0.118289499283744723D+09,
     *    0.718823275427545607D+08,
     *   -0.830588652057193499D+07,
     *    0.128390038689231295D+08,
     *   -0.336347825400382746D+07,
     *    0.185836814885749556D+08,
     *   -0.816018124694174230D+08,
     *    0.243893023062936187D+09,
     *   -0.398610385524749458D+09,
     *    0.359817704009887040D+09,
     *   -0.179893840959446222D+09,
     *    0.590506328368592635D+08,
     *   -0.194495407049620487D+08,
     *    0.807707080761450808D+07,
     *   -0.275218925624127826D+07,
     *    0.236567322867172863D+07,
     *   -0.154584449539110670D+07,
     *    0.158052257166285929D+07,
     *    0.380082395165857254D+07,
     *   -0.124226683001241405D+08,
     *    0.163310179385364037D+08,
     *   -0.931013912342473119D+07,
     *    0.126549012814044091D+07,
     *    0.353937886347309686D+07,
     *   -0.246976556783567462D+07,
     *    0.427682620121446031D+06,
     *   -0.475330082480106736D+06,
     *    0.140051054623294342D+07,
     *   -0.120462604771501455D+07,
     *    0.134212773336063582D+07,
     *   -0.117731980404878221D+07,
     *    0.298300409840956796D+06,
     *    0.139190945677688741D+07,
     *   -0.278084295800684206D+07,
     *    0.767801490325587243D+07,
     *   -0.189966908918852098D+08,
     *    0.459410364452392161D+08,
     *   -0.468669867019979581D+08/
C Kernel parameters
      M=5
C
C      EVALUATE PES    
       SUMA=ZERO
       DO I=1,NPT
        SUMA=SUMA+VCOEF(I)*RKHS_DKN2(R(I),RR,M)
       END DO
       VL0_8=SUMA
       RETURN
       END
C PROGRAM TO GENERATE 1-D RKHS FITS OF Vl0 
C RADIAL COEFFICIENTS FOR 
C ANGULAR EXPANSION OF He-XH(X,r=re) RCCSD(T)/AVQZ+BF
C VSUM DIABAT CBS EXTRAPOLATED PES AT r=re
C EXPANSION COEFFFICIENTS IN CM-1
C REPRODUCING KERNEL HILBERT SPACE METHOD 
C---OPTIMIZED FOR EXECUTION TIME BY DIRECT
C---EXPRESIONS OF HYPERGEOMETRIC AND BETA FUNCTIONS
C
C------SAMPLE PROGRAM CALLING PES FUNCTION-------
      FUNCTION VL0_9(RR)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NPT=41)
      DIMENSION VAB(NPT),VCOEF(NPT)
      DIMENSION R(NPT),THETA(NPT)
      DATA R/
     .  3.000D0,
     .  3.250D0,
     .  3.500D0,
     .  3.750D0,
     .  4.000D0,
     .  4.250D0,
     .  4.500D0,
     .  4.750D0,
     .  5.000D0,
     .  5.250D0,
     .  5.500D0,
     .  5.750D0,
     .  6.000D0,
     .  6.250D0,
     .  6.500D0,
     .  6.750D0,
     .  7.000D0,
     .  7.250D0,
     .  7.500D0,
     .  7.750D0,
     .  8.000D0,
     .  8.250D0,
     .  8.500D0,
     .  8.750D0,
     .  9.000D0,
     .  9.250D0,
     .  9.500D0,
     .  9.750D0,
     . 10.000D0,
     . 10.500D0,
     . 11.000D0,
     . 12.000D0,
     . 13.000D0,
     . 14.000D0,
     . 16.000D0,
     . 18.000D0,
     . 20.000D0,
     . 25.000D0,
     . 30.000D0,
     . 40.000D0,
     . 50.000D0/
      DATA VCOEF/
     *   -0.502392469576112568D+09,
     *    0.892969882883877397D+09,
     *   -0.416496193439221025D+09,
     *    0.993961109192274660D+08,
     *   -0.637917269505936950D+08,
     *    0.724204136441038549D+07,
     *   -0.991069909485720471D+07,
     *   -0.511084140224854928D+07,
     *    0.168061110966011323D+08,
     *   -0.830728701892399937D+08,
     *    0.243407409604065478D+09,
     *   -0.401104147865884244D+09,
     *    0.361326935197530746D+09,
     *   -0.180926333006209701D+09,
     *    0.569414317734031603D+08,
     *   -0.181904403065724261D+08,
     *    0.592756654077124130D+07,
     *   -0.372409261162277032D+07,
     *    0.199821623426421639D+07,
     *   -0.246443683975671855D+06,
     *   -0.811500994372814312D+06,
     *    0.100763866837270814D+07,
     *   -0.152455143202202744D+07,
     *    0.528806295571224880D+06,
     *    0.227434597121418361D+07,
     *   -0.426616812378818728D+07,
     *    0.721789416574473865D+07,
     *   -0.157847968582933079D+08,
     *    0.141848001890512258D+08,
     *   -0.568427208565331157D+07,
     *    0.243279137864899496D+07,
     *   -0.137938756903695315D+07,
     *    0.191154274322523316D+07,
     *   -0.221072310400824202D+07,
     *    0.220030299062021263D+07,
     *   -0.771172644108950393D+06,
     *   -0.132322102221088106D+06,
     *   -0.598878023349019419D+07,
     *    0.138091718494599443D+08,
     *   -0.216928154784253836D+08,
     *    0.185209413128232099D+08/
C Kernel parameters
      M=5
C
C      EVALUATE PES    
       SUMA=ZERO
       DO I=1,NPT
        SUMA=SUMA+VCOEF(I)*RKHS_DKN2(R(I),RR,M)
       END DO
       VL0_9=SUMA
       RETURN
       END
C PROGRAM TO GENERATE 1-D RKHS FITS OF Vl2 
C RADIAL COEFFICIENTS FOR 
C ANGULAR EXPANSION OF He-CH(X,r=re) RCCSD(T)/AVQZ+BF
C VDIF DIABAT CBS EXTRAPOLATED PES AT r=re
C EXPANSION COEFFFICIENTS IN CM-1
C REPRODUCING KERNEL HILBERT SPACE METHOD 
C
C---OPTIMIZED FOR EXECUTION TIME BY DIRECT
C---EXPRESIONS OF HYPERGEOMETRIC AND BETA FUNCTIONS
C
C------SAMPLE PROGRAM CALLING PES FUNCTION-------
      FUNCTION VL2_10(RR)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NPT=41)
      DIMENSION VAB(NPT),VCOEF(NPT)
      DIMENSION R(NPT),THETA(NPT)
      DATA R/
     .  3.000D0,
     .  3.250D0,
     .  3.500D0,
     .  3.750D0,
     .  4.000D0,
     .  4.250D0,
     .  4.500D0,
     .  4.750D0,
     .  5.000D0,
     .  5.250D0,
     .  5.500D0,
     .  5.750D0,
     .  6.000D0,
     .  6.250D0,
     .  6.500D0,
     .  6.750D0,
     .  7.000D0,
     .  7.250D0,
     .  7.500D0,
     .  7.750D0,
     .  8.000D0,
     .  8.250D0,
     .  8.500D0,
     .  8.750D0,
     .  9.000D0,
     .  9.250D0,
     .  9.500D0,
     .  9.750D0,
     . 10.000D0,
     . 10.500D0,
     . 11.000D0,
     . 12.000D0,
     . 13.000D0,
     . 14.000D0,
     . 16.000D0,
     . 18.000D0,
     . 20.000D0,
     . 25.000D0,
     . 30.000D0,
     . 40.000D0,
     . 50.000D0/
      DATA VCOEF/
     *   -0.171262004718682729D+08,
     *    0.326194843783050105D+08,
     *   -0.161289089427021351D+08,
     *    0.300052205871850299D+07,
     *   -0.236861968199454388D+07,
     *    0.226631385973365337D+06,
     *   -0.275350477850016090D+06,
     *    0.297533821326223260D+05,
     *    0.433447330813141234D+05,
     *   -0.230031542255686596D+06,
     *    0.335816013511770871D+06,
     *   -0.359155964077177341D+06,
     *    0.331514351035701809D+06,
     *   -0.342427247963740607D+06,
     *    0.622867020953425439D+06,
     *   -0.667134013292448944D+06,
     *    0.512957637720412575D+06,
     *   -0.843185452387990314D+06,
     *    0.263013682123210793D+07,
     *   -0.484779567072717194D+07,
     *    0.495595015708128083D+07,
     *   -0.234802474935074011D+07,
     *   -0.311923896691692993D+07,
     *    0.798184193620602693D+07,
     *   -0.461290043635343201D+07,
     *   -0.535774211587314494D+07,
     *    0.103990555243352558D+08,
     *   -0.652425929481373169D+07,
     *    0.126397105293626967D+07,
     *    0.394328760752170230D+06,
     *   -0.159947133866017888D+06,
     *   -0.475629785413773265D+06,
     *    0.685696068328073015D+06,
     *    0.481441557988737011D+06,
     *   -0.284210143029622734D+07,
     *    0.487142625403244328D+07,
     *   -0.433313852614753041D+07,
     *    0.574071907500746194D+07,
     *   -0.714082818288716674D+07,
     *   -0.106500252078594221D+07,
     *    0.731443540536797140D+07/
C Kernel parameters
      M=5
C
C      EVALUATE PES    
       SUMA=ZERO
       DO I=1,NPT
        SUMA=SUMA+VCOEF(I)*RKHS_DKN2(R(I),RR,M)
       END DO
       VL2_10=SUMA
       RETURN
       END
C PROGRAM TO GENERATE 1-D RKHS FITS OF Vl2 
C RADIAL COEFFICIENTS FOR 
C ANGULAR EXPANSION OF He-CH(X,r=re) RCCSD(T)/AVQZ+BF
C VDIF DIABAT CBS EXTRAPOLATED PES AT r=re
C EXPANSION COEFFFICIENTS IN CM-1
C REPRODUCING KERNEL HILBERT SPACE METHOD 
C
C---OPTIMIZED FOR EXECUTION TIME BY DIRECT
C---EXPRESIONS OF HYPERGEOMETRIC AND BETA FUNCTIONS
C
C------SAMPLE PROGRAM CALLING PES FUNCTION-------
      FUNCTION VL2_11(RR)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NPT=41)
      DIMENSION VAB(NPT),VCOEF(NPT)
      DIMENSION R(NPT),THETA(NPT)
      DATA R/
     .  3.000D0,
     .  3.250D0,
     .  3.500D0,
     .  3.750D0,
     .  4.000D0,
     .  4.250D0,
     .  4.500D0,
     .  4.750D0,
     .  5.000D0,
     .  5.250D0,
     .  5.500D0,
     .  5.750D0,
     .  6.000D0,
     .  6.250D0,
     .  6.500D0,
     .  6.750D0,
     .  7.000D0,
     .  7.250D0,
     .  7.500D0,
     .  7.750D0,
     .  8.000D0,
     .  8.250D0,
     .  8.500D0,
     .  8.750D0,
     .  9.000D0,
     .  9.250D0,
     .  9.500D0,
     .  9.750D0,
     . 10.000D0,
     . 10.500D0,
     . 11.000D0,
     . 12.000D0,
     . 13.000D0,
     . 14.000D0,
     . 16.000D0,
     . 18.000D0,
     . 20.000D0,
     . 25.000D0,
     . 30.000D0,
     . 40.000D0,
     . 50.000D0/
      DATA VCOEF/
     *    0.527628683285292238D+08,
     *   -0.109498622024696022D+09,
     *    0.659403068202640638D+08,
     *   -0.157686636589847915D+08,
     *    0.800101100418203510D+07,
     *   -0.204853090811167262D+07,
     *    0.935406273703753133D+06,
     *   -0.353906895994392282D+06,
     *    0.267357499985084469D+05,
     *    0.152834522433171805D+06,
     *   -0.193798512330889178D+06,
     *    0.173040638397252798D+06,
     *   -0.323419938930321878D+05,
     *   -0.208013380778950697D+06,
     *   -0.162419656500655838D+06,
     *    0.101856490095283894D+07,
     *   -0.169731543167426670D+07,
     *    0.189232348937985068D+07,
     *   -0.211948223265915364D+07,
     *    0.279528698472829675D+07,
     *   -0.384428613829345629D+07,
     *    0.611058291787309013D+07,
     *   -0.967962552767212316D+07,
     *    0.102348529996785000D+08,
     *   -0.456032114111386891D+07,
     *   -0.158675081308714789D+07,
     *    0.377403699141467456D+07,
     *   -0.521766824288962409D+07,
     *    0.470509446183274128D+07,
     *   -0.266941082959810598D+07,
     *    0.144643659634703863D+07,
     *   -0.639519463465341600D+06,
     *    0.883746064800033462D+06,
     *   -0.106154451626295643D+07,
     *    0.202641247178796725D+07,
     *   -0.475057711477530934D+07,
     *    0.410345952080539148D+07,
     *    0.312505329189175274D+06,
     *    0.139840326446049055D+07,
     *   -0.208913170268003382D+08,
     *    0.273133227902415916D+08/
C Kernel parameters
      M=5
C
C      EVALUATE PES    
       SUMA=ZERO
       DO I=1,NPT
        SUMA=SUMA+VCOEF(I)*RKHS_DKN2(R(I),RR,M)
       END DO
       VL2_11=SUMA
       RETURN
       END
C PROGRAM TO GENERATE 1-D RKHS FITS OF Vl2 
C RADIAL COEFFICIENTS FOR 
C ANGULAR EXPANSION OF He-CH(X,r=re) RCCSD(T)/AVQZ+BF
C VDIF DIABAT CBS EXTRAPOLATED PES AT r=re
C EXPANSION COEFFFICIENTS IN CM-1
C REPRODUCING KERNEL HILBERT SPACE METHOD 
C
C---OPTIMIZED FOR EXECUTION TIME BY DIRECT
C---EXPRESIONS OF HYPERGEOMETRIC AND BETA FUNCTIONS
C
C------SAMPLE PROGRAM CALLING PES FUNCTION-------
      FUNCTION VL2_12(RR)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NPT=41)
      DIMENSION VAB(NPT),VCOEF(NPT)
      DIMENSION R(NPT),THETA(NPT)
      DATA R/
     .  3.000D0,
     .  3.250D0,
     .  3.500D0,
     .  3.750D0,
     .  4.000D0,
     .  4.250D0,
     .  4.500D0,
     .  4.750D0,
     .  5.000D0,
     .  5.250D0,
     .  5.500D0,
     .  5.750D0,
     .  6.000D0,
     .  6.250D0,
     .  6.500D0,
     .  6.750D0,
     .  7.000D0,
     .  7.250D0,
     .  7.500D0,
     .  7.750D0,
     .  8.000D0,
     .  8.250D0,
     .  8.500D0,
     .  8.750D0,
     .  9.000D0,
     .  9.250D0,
     .  9.500D0,
     .  9.750D0,
     . 10.000D0,
     . 10.500D0,
     . 11.000D0,
     . 12.000D0,
     . 13.000D0,
     . 14.000D0,
     . 16.000D0,
     . 18.000D0,
     . 20.000D0,
     . 25.000D0,
     . 30.000D0,
     . 40.000D0,
     . 50.000D0/
      DATA VCOEF/
     *   -0.101315515719660074D+08,
     *    0.195294912644511946D+08,
     *   -0.964138825627620332D+07,
     *    0.145288435342083429D+07,
     *   -0.131873127040470229D+07,
     *    0.174142942772760172D+06,
     *   -0.155080564176538581D+06,
     *    0.697920608790055558D+05,
     *    0.521011470209029503D+05,
     *   -0.675504120580126182D+05,
     *   -0.207518640642317077D+05,
     *   -0.145554556977540415D+05,
     *    0.103056479905284272D+06,
     *    0.788502758568199206D+05,
     *   -0.227020127199741633D+06,
     *    0.356939693937542383D+06,
     *   -0.120475033204052015D+07,
     *    0.297533449130344391D+07,
     *   -0.469534341120833717D+07,
     *    0.546819697380818054D+07,
     *   -0.605171511729769129D+07,
     *    0.831816836988613009D+07,
     *   -0.112315488071095403D+08,
     *    0.115415631612726282D+08,
     *   -0.984527782192772068D+07,
     *    0.858491514666336775D+07,
     *   -0.789877743931752350D+07,
     *    0.638783011860191543D+07,
     *   -0.314208635916861286D+07,
     *    0.775619900662739179D+06,
     *   -0.222178799378911412D+06,
     *    0.178411085714560759D+06,
     *   -0.524876663932111696D+06,
     *    0.131174962469382648D+06,
     *    0.118108618878115783D+07,
     *   -0.181258755590249086D+07,
     *    0.133957413176596561D+07,
     *   -0.498204633559293486D+07,
     *    0.132820042012731042D+08,
     *   -0.269765581802984700D+08,
     *    0.250361046679393277D+08/
C Kernel parameters
      M=5
C
C      EVALUATE PES    
       SUMA=ZERO
       DO I=1,NPT
        SUMA=SUMA+VCOEF(I)*RKHS_DKN2(R(I),RR,M)
       END DO
       VL2_12=SUMA
       RETURN
       END
C PROGRAM TO GENERATE 1-D RKHS FITS OF Vl2 
C RADIAL COEFFICIENTS FOR 
C ANGULAR EXPANSION OF He-CH(X,r=re) RCCSD(T)/AVQZ+BF
C VDIF DIABAT CBS EXTRAPOLATED PES AT r=re
C EXPANSION COEFFFICIENTS IN CM-1
C REPRODUCING KERNEL HILBERT SPACE METHOD 
C
C---OPTIMIZED FOR EXECUTION TIME BY DIRECT
C---EXPRESIONS OF HYPERGEOMETRIC AND BETA FUNCTIONS
C
C------SAMPLE PROGRAM CALLING PES FUNCTION-------
      FUNCTION VL2_2(RR)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NPT=41)
      DIMENSION VAB(NPT),VCOEF(NPT)
      DIMENSION R(NPT),THETA(NPT)
      DATA R/
     .  3.000D0,
     .  3.250D0,
     .  3.500D0,
     .  3.750D0,
     .  4.000D0,
     .  4.250D0,
     .  4.500D0,
     .  4.750D0,
     .  5.000D0,
     .  5.250D0,
     .  5.500D0,
     .  5.750D0,
     .  6.000D0,
     .  6.250D0,
     .  6.500D0,
     .  6.750D0,
     .  7.000D0,
     .  7.250D0,
     .  7.500D0,
     .  7.750D0,
     .  8.000D0,
     .  8.250D0,
     .  8.500D0,
     .  8.750D0,
     .  9.000D0,
     .  9.250D0,
     .  9.500D0,
     .  9.750D0,
     . 10.000D0,
     . 10.500D0,
     . 11.000D0,
     . 12.000D0,
     . 13.000D0,
     . 14.000D0,
     . 16.000D0,
     . 18.000D0,
     . 20.000D0,
     . 25.000D0,
     . 30.000D0,
     . 40.000D0,
     . 50.000D0/
      DATA VCOEF/
     *   -0.926668521556309819D+09,
     *    0.101918894645605576D+10,
     *   -0.383889899470300615D+09,
     *    0.139787425094972312D+09,
     *   -0.404318189216124937D+08,
     *    0.343211554037252218D+08,
     *    0.197174538140623085D+08,
     *    0.352004875588098392D+08,
     *    0.381285114449876249D+08,
     *    0.420664214937714040D+08,
     *    0.423787292459645271D+08,
     *    0.399489623251498789D+08,
     *    0.350308045859221444D+08,
     *    0.275592334785727151D+08,
     *    0.209488685809655972D+08,
     *    0.124891358579844013D+08,
     *    0.699588163500971254D+07,
     *   -0.591906417641937060D+04,
     *   -0.137501021520924754D+07,
     *   -0.109468904351908974D+08,
     *   -0.835371545026651677D+07,
     *   -0.134078937761792764D+08,
     *   -0.167909599331685081D+08,
     *   -0.105688508208658509D+08,
     *   -0.167093409445472565D+08,
     *   -0.154846279176287986D+08,
     *   -0.598761614783371985D+07,
     *   -0.164585426773467604D+08,
     *   -0.986354002686758898D+07,
     *   -0.124897551305859853D+08,
     *   -0.124893185839307494D+08,
     *   -0.841716200444526225D+07,
     *   -0.335974759641736560D+07,
     *   -0.409215931936835824D+07,
     *   -0.286274007915143576D+07,
     *    0.840771194269160740D+07,
     *   -0.616792794586441247D+06,
     *   -0.173084375972520793D+07,
     *    0.538319627885075100D+07,
     *   -0.152733963002233580D+08,
     *    0.123912712402943820D+08/
C Kernel parameters
      M=5
C
C      EVALUATE PES    
       SUMA=ZERO
       DO I=1,NPT
        SUMA=SUMA+VCOEF(I)*RKHS_DKN2(R(I),RR,M)
       END DO
       VL2_2=SUMA
       RETURN
       END
C PROGRAM TO GENERATE 1-D RKHS FITS OF Vl2 
C RADIAL COEFFICIENTS FOR 
C ANGULAR EXPANSION OF He-CH(X,r=re) RCCSD(T)/AVQZ+BF
C VDIF DIABAT CBS EXTRAPOLATED PES AT r=re
C EXPANSION COEFFFICIENTS IN CM-1
C REPRODUCING KERNEL HILBERT SPACE METHOD 
C
C---OPTIMIZED FOR EXECUTION TIME BY DIRECT
C---EXPRESIONS OF HYPERGEOMETRIC AND BETA FUNCTIONS
C
C------SAMPLE PROGRAM CALLING PES FUNCTION-------
      FUNCTION VL2_3(RR)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NPT=41)
      DIMENSION VAB(NPT),VCOEF(NPT)
      DIMENSION R(NPT),THETA(NPT)
      DATA R/
     .  3.000D0,
     .  3.250D0,
     .  3.500D0,
     .  3.750D0,
     .  4.000D0,
     .  4.250D0,
     .  4.500D0,
     .  4.750D0,
     .  5.000D0,
     .  5.250D0,
     .  5.500D0,
     .  5.750D0,
     .  6.000D0,
     .  6.250D0,
     .  6.500D0,
     .  6.750D0,
     .  7.000D0,
     .  7.250D0,
     .  7.500D0,
     .  7.750D0,
     .  8.000D0,
     .  8.250D0,
     .  8.500D0,
     .  8.750D0,
     .  9.000D0,
     .  9.250D0,
     .  9.500D0,
     .  9.750D0,
     . 10.000D0,
     . 10.500D0,
     . 11.000D0,
     . 12.000D0,
     . 13.000D0,
     . 14.000D0,
     . 16.000D0,
     . 18.000D0,
     . 20.000D0,
     . 25.000D0,
     . 30.000D0,
     . 40.000D0,
     . 50.000D0/
      DATA VCOEF/
     *   -0.106764111257186189D+09,
     *    0.141281236674166679D+09,
     *   -0.440380718471346796D+08,
     *    0.263076249385417551D+08,
     *    0.101374657789242757D+07,
     *    0.860939640090002120D+07,
     *    0.339139238119750563D+07,
     *    0.188815769364814251D+07,
     *   -0.109452862777158036D+07,
     *   -0.328793218276581028D+07,
     *   -0.486913117320769001D+07,
     *   -0.587857443061293755D+07,
     *   -0.591296480491080042D+07,
     *   -0.578925587659020163D+07,
     *   -0.511763986483168229D+07,
     *   -0.428790827647415455D+07,
     *   -0.379332292277253326D+07,
     *   -0.713325020214405493D+06,
     *   -0.323575070551858610D+07,
     *    0.995349636893214658D+06,
     *   -0.208612690405566624D+06,
     *    0.149330724977660994D+07,
     *   -0.574029603276064526D+07,
     *    0.145544977928200383D+08,
     *   -0.125590699196288176D+08,
     *    0.381966936778486893D+07,
     *    0.658449051974575315D+07,
     *   -0.325913777482548670D+06,
     *   -0.241101781611737795D+07,
     *    0.444102638527653925D+07,
     *    0.500810449602849840D+05,
     *    0.142991228710883902D+07,
     *    0.298465998990528693D+06,
     *    0.224828567761718412D+06,
     *   -0.133308629008566961D+07,
     *    0.478475266641600151D+07,
     *   -0.634882338231707178D+07,
     *    0.544483387526108045D+07,
     *   -0.481580790252791159D+07,
     *    0.650600042816944979D+07,
     *   -0.693532908634625468D+07/
C Kernel parameters
      M=5
C
C      EVALUATE PES    
       SUMA=ZERO
       DO I=1,NPT
        SUMA=SUMA+VCOEF(I)*RKHS_DKN2(R(I),RR,M)
       END DO
       VL2_3=SUMA
       RETURN
       END
C PROGRAM TO GENERATE 1-D RKHS FITS OF Vl2 
C RADIAL COEFFICIENTS FOR 
C ANGULAR EXPANSION OF He-CH(X,r=re) RCCSD(T)/AVQZ+BF
C VDIF DIABAT CBS EXTRAPOLATED PES AT r=re
C EXPANSION COEFFFICIENTS IN CM-1
C REPRODUCING KERNEL HILBERT SPACE METHOD 
C
C---OPTIMIZED FOR EXECUTION TIME BY DIRECT
C---EXPRESIONS OF HYPERGEOMETRIC AND BETA FUNCTIONS
C
C------SAMPLE PROGRAM CALLING PES FUNCTION-------
      FUNCTION VL2_4(RR)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NPT=41)
      DIMENSION VAB(NPT),VCOEF(NPT)
      DIMENSION R(NPT),THETA(NPT)
      DATA R/
     .  3.000D0,
     .  3.250D0,
     .  3.500D0,
     .  3.750D0,
     .  4.000D0,
     .  4.250D0,
     .  4.500D0,
     .  4.750D0,
     .  5.000D0,
     .  5.250D0,
     .  5.500D0,
     .  5.750D0,
     .  6.000D0,
     .  6.250D0,
     .  6.500D0,
     .  6.750D0,
     .  7.000D0,
     .  7.250D0,
     .  7.500D0,
     .  7.750D0,
     .  8.000D0,
     .  8.250D0,
     .  8.500D0,
     .  8.750D0,
     .  9.000D0,
     .  9.250D0,
     .  9.500D0,
     .  9.750D0,
     . 10.000D0,
     . 10.500D0,
     . 11.000D0,
     . 12.000D0,
     . 13.000D0,
     . 14.000D0,
     . 16.000D0,
     . 18.000D0,
     . 20.000D0,
     . 25.000D0,
     . 30.000D0,
     . 40.000D0,
     . 50.000D0/
      DATA VCOEF/
     *   -0.244361953711445749D+09,
     *    0.370857053000673115D+09,
     *   -0.136386620393852890D+09,
     *    0.479313819414670244D+08,
     *   -0.194136845355218351D+08,
     *    0.410429528357383516D+07,
     *   -0.455498723891135212D+07,
     *   -0.235215597719469899D+07,
     *   -0.368917454574439069D+07,
     *   -0.357755610395886563D+07,
     *   -0.329845785561536765D+07,
     *   -0.276338393653197354D+07,
     *   -0.201682317328634113D+07,
     *   -0.131978069293233380D+07,
     *   -0.697939169285070617D+06,
     *   -0.762009757705629920D+06,
     *    0.761631228437788901D+06,
     *   -0.164934480202540150D+07,
     *    0.254355811763870064D+07,
     *   -0.136316024631423084D+07,
     *    0.403087169027371492D+05,
     *    0.338111823472200427D+07,
     *   -0.647919126873940881D+07,
     *    0.953198142859398574D+07,
     *   -0.522680817133905552D+07,
     *   -0.194664168343134806D+07,
     *    0.586109559539993294D+07,
     *   -0.539032406907253433D+07,
     *    0.242473299705749238D+07,
     *   -0.701485753055079607D+06,
     *    0.976520101606246317D+06,
     *   -0.432364522481688880D+06,
     *    0.952201356049165188D+05,
     *   -0.342652659699858050D+06,
     *    0.138020292625948437D+07,
     *   -0.422398033386989962D+07,
     *    0.488211148497334775D+07,
     *   -0.297606051891977061D+07,
     *   -0.505226192234042566D+06,
     *    0.107451475178228524D+08,
     *   -0.134935341392034795D+08/
C Kernel parameters
      M=5
C
C      EVALUATE PES    
       SUMA=ZERO
       DO I=1,NPT
        SUMA=SUMA+VCOEF(I)*RKHS_DKN2(R(I),RR,M)
       END DO
       VL2_4=SUMA
       RETURN
       END
C PROGRAM TO GENERATE 1-D RKHS FITS OF Vl2 
C RADIAL COEFFICIENTS FOR 
C ANGULAR EXPANSION OF He-CH(X,r=re) RCCSD(T)/AVQZ+BF
C VDIF DIABAT CBS EXTRAPOLATED PES AT r=re
C EXPANSION COEFFFICIENTS IN CM-1
C REPRODUCING KERNEL HILBERT SPACE METHOD 
C
C---OPTIMIZED FOR EXECUTION TIME BY DIRECT
C---EXPRESIONS OF HYPERGEOMETRIC AND BETA FUNCTIONS
C
C------SAMPLE PROGRAM CALLING PES FUNCTION-------
      FUNCTION VL2_5(RR)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NPT=41)
      DIMENSION VAB(NPT),VCOEF(NPT)
      DIMENSION R(NPT),THETA(NPT)
      DATA R/
     .  3.000D0,
     .  3.250D0,
     .  3.500D0,
     .  3.750D0,
     .  4.000D0,
     .  4.250D0,
     .  4.500D0,
     .  4.750D0,
     .  5.000D0,
     .  5.250D0,
     .  5.500D0,
     .  5.750D0,
     .  6.000D0,
     .  6.250D0,
     .  6.500D0,
     .  6.750D0,
     .  7.000D0,
     .  7.250D0,
     .  7.500D0,
     .  7.750D0,
     .  8.000D0,
     .  8.250D0,
     .  8.500D0,
     .  8.750D0,
     .  9.000D0,
     .  9.250D0,
     .  9.500D0,
     .  9.750D0,
     . 10.000D0,
     . 10.500D0,
     . 11.000D0,
     . 12.000D0,
     . 13.000D0,
     . 14.000D0,
     . 16.000D0,
     . 18.000D0,
     . 20.000D0,
     . 25.000D0,
     . 30.000D0,
     . 40.000D0,
     . 50.000D0/
      DATA VCOEF/
     *    0.730929257606691867D+08,
     *   -0.836155609167937189D+08,
     *    0.178266431123383492D+08,
     *   -0.130083901443010829D+08,
     *    0.112675426099346997D+07,
     *   -0.202625931005632831D+07,
     *    0.336532284364494495D+06,
     *    0.453274936629747157D+06,
     *    0.103997700423250173D+07,
     *    0.101690315938090032D+07,
     *    0.917062990347173763D+06,
     *    0.525311411493802210D+06,
     *    0.416151657961326651D+06,
     *    0.249146955079147039D+06,
     *   -0.352267944827860803D+06,
     *    0.900928555992876994D+06,
     *   -0.125566505267277383D+07,
     *    0.720393535541417776D+06,
     *    0.152218415675286407D+06,
     *   -0.120467417682986334D+07,
     *    0.229032001045336109D+07,
     *   -0.303218159254464274D+07,
     *    0.491185424320217781D+07,
     *   -0.556548961018988676D+07,
     *    0.464580131688850559D+07,
     *    0.911643595505278208D+05,
     *   -0.581704141153894551D+07,
     *    0.721059841443978623D+07,
     *   -0.309987630706578121D+07,
     *    0.190180548692143755D+07,
     *   -0.178987102790362015D+07,
     *    0.157574042683122493D+07,
     *   -0.128020557326119766D+07,
     *    0.757881233786303317D+06,
     *   -0.258777990152307815D+06,
     *    0.612560698100163718D+06,
     *   -0.128268570477852505D+07,
     *    0.494868241788499244D+07,
     *   -0.113716118060191553D+08,
     *    0.247762620446406566D+08,
     *   -0.247579795982645079D+08/
C Kernel parameters
      M=5
C
C      EVALUATE PES    
       SUMA=ZERO
       DO I=1,NPT
        SUMA=SUMA+VCOEF(I)*RKHS_DKN2(R(I),RR,M)
       END DO
       VL2_5=SUMA
       RETURN
       END
C PROGRAM TO GENERATE 1-D RKHS FITS OF Vl2 
C RADIAL COEFFICIENTS FOR 
C ANGULAR EXPANSION OF He-CH(X,r=re) RCCSD(T)/AVQZ+BF
C VDIF DIABAT CBS EXTRAPOLATED PES AT r=re
C EXPANSION COEFFFICIENTS IN CM-1
C REPRODUCING KERNEL HILBERT SPACE METHOD 
C
C---OPTIMIZED FOR EXECUTION TIME BY DIRECT
C---EXPRESIONS OF HYPERGEOMETRIC AND BETA FUNCTIONS
C
C------SAMPLE PROGRAM CALLING PES FUNCTION-------
      FUNCTION VL2_6(RR)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NPT=41)
      DIMENSION VAB(NPT),VCOEF(NPT)
      DIMENSION R(NPT),THETA(NPT)
      DATA R/
     .  3.000D0,
     .  3.250D0,
     .  3.500D0,
     .  3.750D0,
     .  4.000D0,
     .  4.250D0,
     .  4.500D0,
     .  4.750D0,
     .  5.000D0,
     .  5.250D0,
     .  5.500D0,
     .  5.750D0,
     .  6.000D0,
     .  6.250D0,
     .  6.500D0,
     .  6.750D0,
     .  7.000D0,
     .  7.250D0,
     .  7.500D0,
     .  7.750D0,
     .  8.000D0,
     .  8.250D0,
     .  8.500D0,
     .  8.750D0,
     .  9.000D0,
     .  9.250D0,
     .  9.500D0,
     .  9.750D0,
     . 10.000D0,
     . 10.500D0,
     . 11.000D0,
     . 12.000D0,
     . 13.000D0,
     . 14.000D0,
     . 16.000D0,
     . 18.000D0,
     . 20.000D0,
     . 25.000D0,
     . 30.000D0,
     . 40.000D0,
     . 50.000D0/
      DATA VCOEF/
     *   -0.683681138112876862D+08,
     *    0.125450932914615393D+09,
     *   -0.610747094346193373D+08,
     *    0.138748793182165679D+08,
     *   -0.951829845847166516D+07,
     *    0.948188490008864086D+06,
     *   -0.127570616851534857D+07,
     *    0.280453836065986718D+06,
     *   -0.126789529564333716D+06,
     *    0.711025254587567615D+05,
     *   -0.592516244024980842D+05,
     *   -0.111461587177643582D+06,
     *    0.235365306009695312D+06,
     *   -0.634709954289523535D+06,
     *    0.778429629436722957D+06,
     *   -0.622501544449431007D+06,
     *   -0.191329831957764582D+05,
     *    0.135988253389318660D+07,
     *   -0.283664992255608318D+07,
     *    0.348811967646444403D+07,
     *   -0.173102113384824549D+07,
     *   -0.348184068174835993D+07,
     *    0.107772412844621260D+08,
     *   -0.135777152308160346D+08,
     *    0.538768869514334016D+07,
     *    0.883791404075131007D+07,
     *   -0.185033845370736308D+08,
     *    0.176101868557766452D+08,
     *   -0.751264307926848438D+07,
     *   -0.367813711037925503D+06,
     *    0.753152793171370868D+06,
     *    0.762300968332695658D+06,
     *   -0.206972546181037766D+07,
     *    0.224140415721620852D+07,
     *   -0.325490522572820261D+07,
     *    0.757862112241721340D+07,
     *   -0.955274242158882134D+07,
     *    0.145488011928263362D+08,
     *   -0.245706789177798852D+08,
     *    0.410080296845425814D+08,
     *   -0.364220437715193331D+08/
C Kernel parameters
      M=5
C
C      EVALUATE PES    
       SUMA=ZERO
       DO I=1,NPT
        SUMA=SUMA+VCOEF(I)*RKHS_DKN2(R(I),RR,M)
       END DO
       VL2_6=SUMA
       RETURN
       END
C PROGRAM TO GENERATE 1-D RKHS FITS OF Vl2 
C RADIAL COEFFICIENTS FOR 
C ANGULAR EXPANSION OF He-CH(X,r=re) RCCSD(T)/AVQZ+BF
C VDIF DIABAT CBS EXTRAPOLATED PES AT r=re
C EXPANSION COEFFFICIENTS IN CM-1
C REPRODUCING KERNEL HILBERT SPACE METHOD 
C
C---OPTIMIZED FOR EXECUTION TIME BY DIRECT
C---EXPRESIONS OF HYPERGEOMETRIC AND BETA FUNCTIONS
C
C------SAMPLE PROGRAM CALLING PES FUNCTION-------
      FUNCTION VL2_7(RR)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NPT=41)
      DIMENSION VAB(NPT),VCOEF(NPT)
      DIMENSION R(NPT),THETA(NPT)
      DATA R/
     .  3.000D0,
     .  3.250D0,
     .  3.500D0,
     .  3.750D0,
     .  4.000D0,
     .  4.250D0,
     .  4.500D0,
     .  4.750D0,
     .  5.000D0,
     .  5.250D0,
     .  5.500D0,
     .  5.750D0,
     .  6.000D0,
     .  6.250D0,
     .  6.500D0,
     .  6.750D0,
     .  7.000D0,
     .  7.250D0,
     .  7.500D0,
     .  7.750D0,
     .  8.000D0,
     .  8.250D0,
     .  8.500D0,
     .  8.750D0,
     .  9.000D0,
     .  9.250D0,
     .  9.500D0,
     .  9.750D0,
     . 10.000D0,
     . 10.500D0,
     . 11.000D0,
     . 12.000D0,
     . 13.000D0,
     . 14.000D0,
     . 16.000D0,
     . 18.000D0,
     . 20.000D0,
     . 25.000D0,
     . 30.000D0,
     . 40.000D0,
     . 50.000D0/
      DATA VCOEF/
     *    0.704656775468569696D+08,
     *   -0.113822614181595847D+09,
     *    0.418170318298552632D+08,
     *   -0.106795014720902126D+08,
     *    0.809510392017354537D+07,
     *    0.419600819084161834D+06,
     *    0.193740853708661254D+07,
     *    0.563929409032173222D+06,
     *    0.489544021255678090D+06,
     *    0.317795685742859147D+06,
     *    0.914322506531014078D+05,
     *    0.167006253072729334D+06,
     *   -0.750676133826493169D+05,
     *    0.274843502825176227D+06,
     *   -0.625893656648146425D+05,
     *   -0.343052111342189135D+06,
     *    0.598774212120214477D+06,
     *   -0.176541906121549400D+06,
     *   -0.626761574384361971D+06,
     *    0.314869199474891240D+06,
     *    0.136928615640074993D+07,
     *   -0.532856725335575081D+07,
     *    0.129832799134621490D+08,
     *   -0.192411768743956536D+08,
     *    0.164397007499576584D+08,
     *   -0.545434905494285002D+07,
     *   -0.580832062187063275D+06,
     *   -0.446487524725050386D+07,
     *    0.662777798521893565D+07,
     *   -0.325509510101439897D+07,
     *    0.142782305361328111D+07,
     *   -0.156655809177851101D+06,
     *   -0.385805340184670233D+06,
     *    0.168080118334473838D+06,
     *    0.651760632435788051D+06,
     *   -0.210475967752711568D+07,
     *    0.191906361454704218D+07,
     *    0.303620105122520262D+07,
     *   -0.113589913016574495D+08,
     *    0.276063827177073061D+08,
     *   -0.277119202420050651D+08/
C Kernel parameters
      M=5
C
C      EVALUATE PES    
       SUMA=ZERO
       DO I=1,NPT
        SUMA=SUMA+VCOEF(I)*RKHS_DKN2(R(I),RR,M)
       END DO
       VL2_7=SUMA
       RETURN
       END
C PROGRAM TO GENERATE 1-D RKHS FITS OF Vl2 
C RADIAL COEFFICIENTS FOR 
C ANGULAR EXPANSION OF He-CH(X,r=re) RCCSD(T)/AVQZ+BF
C VDIF DIABAT CBS EXTRAPOLATED PES AT r=re
C EXPANSION COEFFFICIENTS IN CM-1
C REPRODUCING KERNEL HILBERT SPACE METHOD 
C
C---OPTIMIZED FOR EXECUTION TIME BY DIRECT
C---EXPRESIONS OF HYPERGEOMETRIC AND BETA FUNCTIONS
C
C------SAMPLE PROGRAM CALLING PES FUNCTION-------
      FUNCTION VL2_8(RR)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NPT=41)
      DIMENSION VAB(NPT),VCOEF(NPT)
      DIMENSION R(NPT),THETA(NPT)
      DATA R/
     .  3.000D0,
     .  3.250D0,
     .  3.500D0,
     .  3.750D0,
     .  4.000D0,
     .  4.250D0,
     .  4.500D0,
     .  4.750D0,
     .  5.000D0,
     .  5.250D0,
     .  5.500D0,
     .  5.750D0,
     .  6.000D0,
     .  6.250D0,
     .  6.500D0,
     .  6.750D0,
     .  7.000D0,
     .  7.250D0,
     .  7.500D0,
     .  7.750D0,
     .  8.000D0,
     .  8.250D0,
     .  8.500D0,
     .  8.750D0,
     .  9.000D0,
     .  9.250D0,
     .  9.500D0,
     .  9.750D0,
     . 10.000D0,
     . 10.500D0,
     . 11.000D0,
     . 12.000D0,
     . 13.000D0,
     . 14.000D0,
     . 16.000D0,
     . 18.000D0,
     . 20.000D0,
     . 25.000D0,
     . 30.000D0,
     . 40.000D0,
     . 50.000D0/
      DATA VCOEF/
     *   -0.240034635015816465D+08,
     *    0.456954859986224771D+08,
     *   -0.242062342020272203D+08,
     *    0.605471091117898654D+07,
     *   -0.337248242763861455D+07,
     *    0.495835426093496091D+06,
     *   -0.545334921186241554D+06,
     *    0.199273335300349572D+05,
     *   -0.728495559593800135D+05,
     *   -0.544469423074401566D+05,
     *   -0.666265057951228664D+05,
     *    0.186129488223347085D+06,
     *   -0.343248200568706030D+06,
     *    0.691117942811254761D+06,
     *   -0.116799428192713740D+07,
     *    0.148670476154161431D+07,
     *   -0.187821664109631279D+07,
     *    0.209861770880600670D+07,
     *   -0.218708622261299426D+07,
     *    0.258216067638409697D+07,
     *   -0.116262655182872480D+07,
     *   -0.413583520017517824D+07,
     *    0.117197181477416493D+08,
     *   -0.158632117834955938D+08,
     *    0.132712653035863265D+08,
     *   -0.982983363135868683D+07,
     *    0.119113406214305237D+08,
     *   -0.152673044052103925D+08,
     *    0.101542834467551447D+08,
     *   -0.305106664917566022D+07,
     *    0.126080373107953346D+07,
     *   -0.117587000700257299D+07,
     *    0.155603814529721322D+07,
     *   -0.123301940474671335D+07,
     *    0.138994545485519920D+07,
     *   -0.302421760914367763D+07,
     *    0.362696166240343219D+07,
     *   -0.388338441437866446D+07,
     *    0.236421710304003116D+07,
     *    0.792715953496414050D+07,
     *   -0.123791128688501716D+08/
C Kernel parameters
      M=5
C
C      EVALUATE PES    
       SUMA=ZERO
       DO I=1,NPT
        SUMA=SUMA+VCOEF(I)*RKHS_DKN2(R(I),RR,M)
       END DO
       VL2_8=SUMA
       RETURN
       END
C PROGRAM TO GENERATE 1-D RKHS FITS OF Vl2 
C RADIAL COEFFICIENTS FOR 
C ANGULAR EXPANSION OF He-CH(X,r=re) RCCSD(T)/AVQZ+BF
C VDIF DIABAT CBS EXTRAPOLATED PES AT r=re
C EXPANSION COEFFFICIENTS IN CM-1
C REPRODUCING KERNEL HILBERT SPACE METHOD 
C
C---OPTIMIZED FOR EXECUTION TIME BY DIRECT
C---EXPRESIONS OF HYPERGEOMETRIC AND BETA FUNCTIONS
C
C------SAMPLE PROGRAM CALLING PES FUNCTION-------
      FUNCTION VL2_9(RR)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NPT=41)
      DIMENSION VAB(NPT),VCOEF(NPT)
      DIMENSION R(NPT),THETA(NPT)
      DATA R/
     .  3.000D0,
     .  3.250D0,
     .  3.500D0,
     .  3.750D0,
     .  4.000D0,
     .  4.250D0,
     .  4.500D0,
     .  4.750D0,
     .  5.000D0,
     .  5.250D0,
     .  5.500D0,
     .  5.750D0,
     .  6.000D0,
     .  6.250D0,
     .  6.500D0,
     .  6.750D0,
     .  7.000D0,
     .  7.250D0,
     .  7.500D0,
     .  7.750D0,
     .  8.000D0,
     .  8.250D0,
     .  8.500D0,
     .  8.750D0,
     .  9.000D0,
     .  9.250D0,
     .  9.500D0,
     .  9.750D0,
     . 10.000D0,
     . 10.500D0,
     . 11.000D0,
     . 12.000D0,
     . 13.000D0,
     . 14.000D0,
     . 16.000D0,
     . 18.000D0,
     . 20.000D0,
     . 25.000D0,
     . 30.000D0,
     . 40.000D0,
     . 50.000D0/
      DATA VCOEF/
     *    0.536783669699734077D+08,
     *   -0.102188772061594263D+09,
     *    0.519188098436834589D+08,
     *   -0.110398897377973925D+08,
     *    0.759795039087794255D+07,
     *   -0.101921805616795213D+07,
     *    0.108181031468590908D+07,
     *   -0.177376985142431076D+06,
     *    0.282152020308083331D+06,
     *   -0.144367482270177454D+06,
     *    0.104040770428685923D+06,
     *    0.550744566691064101D+05,
     *   -0.345082249865375634D+06,
     *    0.292896002651402901D+06,
     *   -0.506547921064942566D+05,
     *   -0.538449472535267632D+05,
     *   -0.524838552451207768D+06,
     *    0.139147107085366617D+07,
     *   -0.125212798107199953D+07,
     *    0.655267741998508922D+06,
     *   -0.934278002854691935D+06,
     *    0.198664839272768097D+07,
     *   -0.356797428814269882D+07,
     *    0.604359563488964457D+07,
     *   -0.815319403434904106D+07,
     *    0.663552561380594224D+07,
     *   -0.573144830189693533D+07,
     *    0.105513347714066263D+08,
     *   -0.100206666235454790D+08,
     *    0.413426895626142714D+07,
     *   -0.133348236016843421D+07,
     *    0.353250410175587749D+06,
     *   -0.851823808995371917D+06,
     *    0.774369549454204272D+06,
     *   -0.807477109650510538D+05,
     *    0.143968793301205756D+07,
     *   -0.255956312288171845D+07,
     *   -0.156514870798283652D+07,
     *    0.693070155626945198D+07,
     *   -0.673003275314549077D+07,
     *    0.219886768288529385D+07/
C Kernel parameters
      M=5
C
C      EVALUATE PES    
       SUMA=ZERO
       DO I=1,NPT
        SUMA=SUMA+VCOEF(I)*RKHS_DKN2(R(I),RR,M)
       END DO
       VL2_9=SUMA
       RETURN
       END

C------RKHS ROUTINES

C------------------------RKHS---------------------------------
C Fortran  Deck with distance-like and angular-like 
C kernels for RKHS interpolation method
C****************************************************
C* By J. KLOS  12/05/2007   University of Maryland  *
C* REVISON: 1.0                                     * 
C* jasztol@gmail.com                                *
C****************************************************
C-------------------------------------------------------------
C FUNCTIONS:
C
C RKHS_DK(X,Y,N,M): Reproducing kernel for  distance-like (DK) 
C                   variables, see Ho, Rabitz Eq(17) of
C                   J. Chem. Phys. 104, 2584 (1996) 
C                   Range = [0, inf]
C
C  INPUT: X,Y-DOUBLE PRECISION
C          N:INTEGER:ORDER OF SMOOTHNESS OF THE FUNCTION
C          M>=0:INTEGER:RECIPROCAL POWER OF THE WEIGHT W(X)=X**(-M)
C  OUTPUT: DOUBLE PRECISION
C -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -            
C RKHS_AK(X,Y,N): Reproducing kernel for  angular-like (AK) 
C                   variables, see Ho, Rabitz Eq(23) of
C                   J. Chem. Phys. 104, 2584 (1996) 
C                    Range = [0, 1]
C    
C  INPUT: X,Y-DOUBLE PRECISION
C          N:INTEGER:ORDER OF SMOOTHNESS OF THE FUNCTION
C  OUPUT: DOUBLE PRECISION
C  HINT: SCALE ANGLES TO [0,1] INTEGRAL FOR ANGLES, FOR EXAMPLE: 
C          X=(1.d0-cosd(ANGLE))/2.d0
C -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -
C RKHS_OP(X,Y,N,M):Reproducing kernel for angular like 
C                    variables with a use of orthogonal 
C                    polynomials Plm(L,M,X) where X is 
C                    K=SUM_L=M^N PLM(X)PLM(X')
C                    variable transformed from angles as
C                    x=cos(theta)
C-------------------------------------------------------------
       DOUBLE PRECISION FUNCTION RKHS_DKN2(X,Y,M)
       IMPLICIT DOUBLE PRECISION (A-H,O-Z)
       IF (X .LT. Y) THEN
           XB=X
           XU=Y
       ELSE
           XB=Y
           XU=X
       ENDIF

C       M=ABS(M)! FORCE M>=0
       NSQR=4
       XUPOWM=XU**(-(M+1))

C      TERM WITH BETA FUNCTION
C       CALL BETA(DFLOAT(M+1),DFLOAT(N),BETATERM)
C      N=2 case direct expression
       BETATERM=1.D0/DFLOAT((M+1)*(M+2))

C      GET TERM WITH 2F1 HYPERGEOMETRIC  GAUSS FUNCTION
C       CALL HYGFX(DFLOAT(-N+1),DFLOAT(M+1),DFLOAT(N+M+1),XB/XU,HF)
C      DIRECT EXPRESSION FOR 2F1 WITH N=2 case
       HF=1.D0-(XB/XU)*(DFLOAT(M+1)/DFLOAT(M+3))
       RKHS_DKN2=NSQR*XUPOWM*BETATERM*HF
       RETURN
       END

       DOUBLE PRECISION FUNCTION RKHS_DK(X,Y,N,M)
       IMPLICIT DOUBLE PRECISION (A-H,O-Z)
       IF (X .LT. Y) THEN
           XB=X
           XU=Y
       ELSE
           XB=Y
           XU=X
       ENDIF

C       M=ABS(M)! FORCE M>=0
       NSQR=N*N
       XUPOWM=XU**(-(M+1))

C      TERM WITH BETA FUNCTION
       CALL BETA(DFLOAT(M+1),DFLOAT(N),BETATERM)

C      GET TERM WITH 2F1 HYPERGEOMETRIC  GAUSS FUNCTION
       CALL HYGFX(DFLOAT(-N+1),DFLOAT(M+1),DFLOAT(N+M+1),XB/XU,HF)
       RKHS_DK=NSQR*XUPOWM*BETATERM*HF
       RETURN
       END

C-------------------------------------------------------------
       DOUBLE PRECISION FUNCTION RKHS_EXPR(X,Y,XE,N)
       IMPLICIT DOUBLE PRECISION (A-H,O-Z)
       PARAMETER (ZERO=0.D0,ONE=1.D0)
       
       SUMA=ZERO
       Z1=(X-XE)/XE
       Z2=(Y-XE)/XE
       DO I=0,N
       SUMA=SUMA+(Z1**I)*(Z2**I)
       ENDDO

       RKHS_EXPR=SUMA
       RETURN
       END


C-------------------------------------------------------------
       DOUBLE PRECISION FUNCTION RKHS_AK(X,Y,N)
       IMPLICIT DOUBLE PRECISION (A-H,O-Z)
       PARAMETER (ZERO=0.D0,ONE=1.D0)
       
       IF ((X.EQ.ZERO).OR.(Y.EQ.ZERO)) THEN
          RKHS_AK=ONE
          RETURN
       ENDIF
       IF (X .LT. Y) THEN
           XB=X
           XU=Y
       ELSE
           XB=Y
           XU=X
       ENDIF

       SUMA=ZERO
C      GET POLYNOMIAL TERM
       DO I=0,N-1
       SUMA=SUMA+(XU**I)*(XB**I)
       END DO

C      GET TERM WITH 2F1 HYPERGEOMETRIC  GAUSS FUNCTION
       CALL HYGFX(DFLOAT(1),DFLOAT(-N+1),DFLOAT(N+1),XB/XU,HF)
       
       RKHS_AK=SUMA+N*(XB**N)*(XU**(N-1))*HF
       RETURN
       END

       DOUBLE PRECISION FUNCTION RKHS_AKN2(X,Y)
       IMPLICIT DOUBLE PRECISION (A-H,O-Z)
       PARAMETER (ZERO=0.D0,ONE=1.D0)
       
       IF ((X.EQ.ZERO).OR.(Y.EQ.ZERO)) THEN
          RKHS_AKN2=ONE
          RETURN
       ENDIF 
       IF (X .LT. Y) THEN
           XB=X
           XU=Y
       ELSE
           XB=Y
           XU=X
       ENDIF

C      GET POLYNOMIAL TERM
       SUMA=1.D0+XU*XB

C      GET TERM WITH 2F1 HYPERGEOMETRIC  GAUSS FUNCTION
C       CALL HYGFX(DFLOAT(1),DFLOAT(-N+1),DFLOAT(N+1),XB/XU,HF)
       HF=1.D0-(XB/XU)/3.D0
       
       RKHS_AKN2=SUMA+2.D0*(XB**2)*XU*HF
       RETURN
       END


       DOUBLE PRECISION FUNCTION RKHS_OP(X,Y,N,M)
       IMPLICIT DOUBLE PRECISION (A-H,O-Z)
       PARAMETER (ZERO=0.D0,ONE=1.D0)

       SUMA=ZERO
C      GET ORTHOGONAL POLYNOMIAL TERM
       DO I=ABS(M),N
       SUMA=SUMA+PLGNDR(I,M,X)*PLGNDR(I,M,Y)
       END DO
       RKHS_OP=SUMA
       RETURN
       END

       DOUBLE PRECISION FUNCTION RKHS_OP2L(X,Y,N,M)
       IMPLICIT DOUBLE PRECISION (A-H,O-Z)
       PARAMETER (ZERO=0.D0,ONE=1.D0)
 
       SUMA=ZERO
C      GET ORTHOGONAL POLYNOMIAL TERM
       DO I=ABS(M),N,2
       SUMA=SUMA+PLGNDR(I,M,X)*PLGNDR(I,M,Y)
       END DO
       RKHS_OP2L=SUMA
       RETURN
       END


            


      FUNCTION PLGNDR(L,M,x)
      IMPLICIT DOUBLE PRECISION (A-H, O-Z)
      if(m.lt.0.or.m.gt.l.or.abs(x).gt.1.)pause
     *'bad arguments in plgndr'
      pmm=1.
      if(m.gt.0) then
        somx2=dsqrt((1.-x)*(1.+x))
        fact=1.
        do 11 i=1,m
          pmm=-pmm*fact*somx2
          fact=fact+2.
11      continue
      endif
      if(l.eq.m) then
        plgndr=pmm
      else
        pmmp1=x*(2*m+1)*pmm
        if(l.eq.m+1) then
          plgndr=pmmp1
        else
         do 12 ll=m+2,l
            pll=(x*(2*ll-1)*pmmp1-(ll+m-1)*pmm)/(ll-m)
            pmm=pmmp1
            pmmp1=pll
12        continue
          plgndr=pll
        endif
      endif
      return
      END



        SUBROUTINE BETA(P,Q,BT)
C
C       ==========================================
C       Purpose: Compute the beta function B(p,q)
C       Input :  p  --- Parameter  ( p > 0 )
C                q  --- Parameter  ( q > 0 )
C       Output:  BT --- B(p,q)
C       Routine called: GAMMA for computing (x)
C       ==========================================
C
        IMPLICIT DOUBLE PRECISION (A-H,O-Z)
        CALL GAMMA(P,GP)
        CALL GAMMA(Q,GQ)
        PPQ=P+Q
        CALL GAMMA(PPQ,GPQ)
        BT=GP*GQ/GPQ
        RETURN
        END


        SUBROUTINE GAMMA(X,GA)
C
C       ==================================================
C       Purpose: Compute gamma function (x)
C       Input :  x  --- Argument of ( x )
C                       ( x is not equal to 0,-1,-2,...)
C       Output:  GA --- (x)
C       ==================================================
C
        IMPLICIT DOUBLE PRECISION (A-H,O-Z)
        DIMENSION G(26)
        PI=3.141592653589793D0
        IF (X.EQ.INT(X)) THEN
           IF (X.GT.0.0D0) THEN
              GA=1.0D0
              M1=X-1
              DO 10 K=2,M1
10               GA=GA*K
           ELSE
              GA=1.0D+300
           ENDIF
        ELSE
           IF (DABS(X).GT.1.0D0) THEN
              Z=DABS(X)
              M=INT(Z)
              R=1.0D0
              DO 15 K=1,M
15               R=R*(Z-K)
              Z=Z-M
           ELSE
              Z=X
           ENDIF
           DATA G/1.0D0,0.5772156649015329D0,
     &          -0.6558780715202538D0, -0.420026350340952D-1,
     &          0.1665386113822915D0,-.421977345555443D-1,
     &          -.96219715278770D-2, .72189432466630D-2,
     &          -.11651675918591D-2, -.2152416741149D-3,
     &          .1280502823882D-3, -.201348547807D-4,
     &          -.12504934821D-5, .11330272320D-5,
     &          -.2056338417D-6, .61160950D-8,
     &          .50020075D-8, -.11812746D-8,
     &          .1043427D-9, .77823D-11,
     &          -.36968D-11, .51D-12,
     &          -.206D-13, -.54D-14, .14D-14, .1D-15/
           GR=G(26)
           DO 20 K=25,1,-1
20            GR=GR*Z+G(K)
           GA=1.0D0/(GR*Z)
           IF (DABS(X).GT.1.0D0) THEN
              GA=GA*R
              IF (X.LT.0.0D0) GA=-PI/(X*GA*DSIN(PI*X))
           ENDIF
        ENDIF
        RETURN
        END



        SUBROUTINE HYGFX(A,B,C,X,HF)
C
C       ====================================================
C       Purpose: Compute hypergeometric function F(a,b,c,x)
C       Input :  a --- Parameter
C                b --- Parameter
C                c --- Parameter, c <> 0,-1,-2,...
C                x --- Argument   ( x < 1 )
C       Output:  HF --- F(a,b,c,x)
C       Routines called:
C            (1) GAMMA for computing gamma function
C            (2) PSI_AAA for computing psi function
C       ====================================================
C
        IMPLICIT DOUBLE PRECISION (A-H,O-Z)
        LOGICAL L0,L1,L2,L3,L4,L5
        PI=3.141592653589793D0
        EL=.5772156649015329D0
        L0=C.EQ.INT(C).AND.C.LT.0.0
        L1=1.0D0-X.LT.1.0D-15.AND.C-A-B.LE.0.0
        L2=A.EQ.INT(A).AND.A.LT.0.0
        L3=B.EQ.INT(B).AND.B.LT.0.0
        L4=C-A.EQ.INT(C-A).AND.C-A.LE.0.0
        L5=C-B.EQ.INT(C-B).AND.C-B.LE.0.0
        IF (L0.OR.L1) THEN
           WRITE(*,*)'The hypergeometric series is divergent'
           RETURN
        ENDIF
        EPS=1.0D-15
        IF (X.GT.0.95) EPS=1.0D-8
        IF (X.EQ.0.0.OR.A.EQ.0.0.OR.B.EQ.0.0) THEN
           HF=1.0D0
           RETURN
        ELSE IF (1.0D0-X.EQ.EPS.AND.C-A-B.GT.0.0) THEN
           CALL GAMMA(C,GC)
           CALL GAMMA(C-A-B,GCAB)
           CALL GAMMA(C-A,GCA)
           CALL GAMMA(C-B,GCB)
           HF=GC*GCAB/(GCA*GCB)
           RETURN
        ELSE IF (1.0D0+X.LE.EPS.AND.DABS(C-A+B-1.0).LE.EPS) THEN
           G0=DSQRT(PI)*2.0D0**(-A)
           CALL GAMMA(C,G1)
           CALL GAMMA(1.0D0+A/2.0-B,G2)
           CALL GAMMA(0.5D0+0.5*A,G3)
           HF=G0*G1/(G2*G3)
           RETURN
        ELSE IF (L2.OR.L3) THEN
           IF (L2) NM=INT(ABS(A))
           IF (L3) NM=INT(ABS(B))
           HF=1.0D0
           R=1.0D0
           DO 10 K=1,NM
              R=R*(A+K-1.0D0)*(B+K-1.0D0)/(K*(C+K-1.0D0))*X
10            HF=HF+R
           RETURN
        ELSE IF (L4.OR.L5) THEN
           IF (L4) NM=INT(ABS(C-A))
           IF (L5) NM=INT(ABS(C-B))
           HF=1.0D0
           R=1.0D0
           DO 15 K=1,NM
              R=R*(C-A+K-1.0D0)*(C-B+K-1.0D0)/(K*(C+K-1.0D0))*X
15            HF=HF+R
           HF=(1.0D0-X)**(C-A-B)*HF
           RETURN
        ENDIF
        AA=A
        BB=B
        X1=X
        IF (X.LT.0.0D0) THEN
           X=X/(X-1.0D0)
           IF (C.GT.A.AND.B.LT.A.AND.B.GT.0.0) THEN
              A=BB
              B=AA
           ENDIF
           B=C-B
        ENDIF
        IF (X.GE.0.75D0) THEN
           GM=0.0D0
           IF (DABS(C-A-B-INT(C-A-B)).LT.1.0D-15) THEN
              M=INT(C-A-B)
              CALL GAMMA(A,GA)
              CALL GAMMA(B,GB)
              CALL GAMMA(C,GC)
              CALL GAMMA(A+M,GAM)
              CALL GAMMA(B+M,GBM)
              CALL PSI_AAA(A,PA)
              CALL PSI_AAA(B,PB)
              IF (M.NE.0) GM=1.0D0
              DO 30 J=1,ABS(M)-1
30               GM=GM*J
              RM=1.0D0
              DO 35 J=1,ABS(M)
35               RM=RM*J
              F0=1.0D0
              R0=1.0D0
              R1=1.0D0
              SP0=0.D0
              SP=0.0D0
              IF (M.GE.0) THEN
                 C0=GM*GC/(GAM*GBM)
                 C1=-GC*(X-1.0D0)**M/(GA*GB*RM)
                 DO 40 K=1,M-1
                    R0=R0*(A+K-1.0D0)*(B+K-1.0)/(K*(K-M))*(1.0-X)
40                  F0=F0+R0
                 DO 45 K=1,M
45                  SP0=SP0+1.0D0/(A+K-1.0)+1.0/(B+K-1.0)-1.0/K
                 F1=PA+PB+SP0+2.0D0*EL+DLOG(1.0D0-X)
                 DO 55 K=1,250
                    SP=SP+(1.0D0-A)/(K*(A+K-1.0))+(1.0-B)/(K*(B+K-1.0))
                    SM=0.0D0
                    DO 50 J=1,M
50                     SM=SM+(1.0D0-A)/((J+K)*(A+J+K-1.0))+1.0/
     &                    (B+J+K-1.0)
                    RP=PA+PB+2.0D0*EL+SP+SM+DLOG(1.0D0-X)
                    R1=R1*(A+M+K-1.0D0)*(B+M+K-1.0)/(K*(M+K))*(1.0-X)
                    F1=F1+R1*RP
                    IF (DABS(F1-HW).LT.DABS(F1)*EPS) GO TO 60
55                  HW=F1
60               HF=F0*C0+F1*C1
              ELSE IF (M.LT.0) THEN
                 M=-M
                 C0=GM*GC/(GA*GB*(1.0D0-X)**M)
                 C1=-(-1)**M*GC/(GAM*GBM*RM)
                 DO 65 K=1,M-1
                    R0=R0*(A-M+K-1.0D0)*(B-M+K-1.0)/(K*(K-M))*(1.0-X)
65                  F0=F0+R0
                 DO 70 K=1,M
70                  SP0=SP0+1.0D0/K
                 F1=PA+PB-SP0+2.0D0*EL+DLOG(1.0D0-X)
                 DO 80 K=1,250
                    SP=SP+(1.0D0-A)/(K*(A+K-1.0))+(1.0-B)/(K*(B+K-1.0))
                    SM=0.0D0
                    DO 75 J=1,M
75                     SM=SM+1.0D0/(J+K)
                    RP=PA+PB+2.0D0*EL+SP-SM+DLOG(1.0D0-X)
                    R1=R1*(A+K-1.0D0)*(B+K-1.0)/(K*(M+K))*(1.0-X)
                    F1=F1+R1*RP
                    IF (DABS(F1-HW).LT.DABS(F1)*EPS) GO TO 85
80                  HW=F1
85               HF=F0*C0+F1*C1
              ENDIF
           ELSE
              CALL GAMMA(A,GA)
              CALL GAMMA(B,GB)
              CALL GAMMA(C,GC)
              CALL GAMMA(C-A,GCA)
              CALL GAMMA(C-B,GCB)
              CALL GAMMA(C-A-B,GCAB)
              CALL GAMMA(A+B-C,GABC)
              C0=GC*GCAB/(GCA*GCB)
              C1=GC*GABC/(GA*GB)*(1.0D0-X)**(C-A-B)
              HF=0.0D0
              R0=C0
              R1=C1
              DO 90 K=1,250
                 R0=R0*(A+K-1.0D0)*(B+K-1.0)/(K*(A+B-C+K))*(1.0-X)
                 R1=R1*(C-A+K-1.0D0)*(C-B+K-1.0)/(K*(C-A-B+K))
     &              *(1.0-X)
                 HF=HF+R0+R1
                 IF (DABS(HF-HW).LT.DABS(HF)*EPS) GO TO 95
90               HW=HF
95            HF=HF+C0+C1
           ENDIF
        ELSE
           A0=1.0D0
           IF (C.GT.A.AND.C.LT.2.0D0*A.AND.
     &         C.GT.B.AND.C.LT.2.0D0*B) THEN
              A0=(1.0D0-X)**(C-A-B)
              A=C-A
              B=C-B
           ENDIF
           HF=1.0D0
           R=1.0D0
           DO 100 K=1,250
              R=R*(A+K-1.0D0)*(B+K-1.0D0)/(K*(C+K-1.0D0))*X
              HF=HF+R
              IF (DABS(HF-HW).LE.DABS(HF)*EPS) GO TO 105
100           HW=HF
105        HF=A0*HF
        ENDIF
        IF (X1.LT.0.0D0) THEN
           X=X1
           C0=1.0D0/(1.0D0-X)**AA
           HF=C0*HF
        ENDIF
        A=AA
        B=BB
        IF (K.GT.120) WRITE(*,115)
115     FORMAT(1X,'Warning! You should check the accuracy')
        RETURN
        END



        SUBROUTINE PSI_AAA(X,PS)
C
C       ======================================
C       Purpose: Compute Psi function
C       Input :  x  --- Argument of psi(x)
C       Output:  PS --- psi(x)
C       ======================================
C
        IMPLICIT DOUBLE PRECISION (A-H,O-Z)
        XA=DABS(X)
        PI=3.141592653589793D0
        EL=.5772156649015329D0
        S=0.0D0
        IF (X.EQ.INT(X).AND.X.LE.0.0) THEN
           PS=1.0D+300
           RETURN
        ELSE IF (XA.EQ.INT(XA)) THEN
           N=XA
           DO 10 K=1 ,N-1
10            S=S+1.0D0/K
           PS=-EL+S
        ELSE IF (XA+.5.EQ.INT(XA+.5)) THEN
           N=XA-.5
           DO 20 K=1,N
20            S=S+1.0/(2.0D0*K-1.0D0)
           PS=-EL+2.0D0*S-1.386294361119891D0
        ELSE
           IF (XA.LT.10.0) THEN
              N=10-INT(XA)
              DO 30 K=0,N-1
30               S=S+1.0D0/(XA+K)
              XA=XA+N
           ENDIF
           X2=1.0D0/(XA*XA)
           A1=-.8333333333333D-01
           A2=.83333333333333333D-02
           A3=-.39682539682539683D-02
           A4=.41666666666666667D-02
           A5=-.75757575757575758D-02
           A6=.21092796092796093D-01
           A7=-.83333333333333333D-01
           A8=.4432598039215686D0
           PS=DLOG(XA)-.5D0/XA+X2*(((((((A8*X2+A7)*X2+
     &        A6)*X2+A5)*X2+A4)*X2+A3)*X2+A2)*X2+A1)
           PS=PS-S
        ENDIF
        IF (X.LT.0.0) PS=PS-PI*DCOS(PI*X)/DSIN(PI*X)-1.0D0/X
        RETURN
        END
