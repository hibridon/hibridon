*  System:  OH+ - H
*
*   calculation of potential energy curves using program provided
*   by f. lique
*   fitted to lam = 0:36, but only use lam = 0:19 here
*  
*   written by p. dagdigian
*   current revision date:  15-jan-2018
      include "common/syusr"
      include "common/bausr"
      include "common/ground"
* ------------------------------------------------------------------------
      subroutine driver
      implicit double precision (a-h,o-z)
      common /covvl/ vvl(20)
      include "common/parpot"
      econv=219474.6d0
      potnam='OH+-H quartet PES reduced'
      print *, potnam
1     print *, 'R (bohr):'
      read (5, *, end=99) r
      call pot(vv0,r)
      if (r.le.0.d0) goto 99
*     vlm coefficient is returned in atomic units (hartree)
*     convert from atomic units for printout
      write (6, 100) vv0*econv, (econv*vvl(i), i=1,19)
100   format((1pe16.8))
      goto 1
99    rr=3.0d0
      dr=0.1d0
      open (unit=12,file='ohph_vlms_red.dat')
      write(12,109)
109   format(' %R/bohr V00  ...')
      do i=1,600
        call pot(vv0,rr)
        write (12,110) rr,vv0*econv, (econv*vvl(j),j=1,19)
110     format(f7.2,20(1pe16.8))
        rr = rr + dr
      enddo
      close(12)
      end
* --------------------------------------------------------------------------
      subroutine loapot(iunit,filnam)
* --------------------------------------------------------------------------
      implicit double precision (a-h,o-z)
      character*(*) filnam
      include "common/parbas"
      include "common/parpot" 
      common /conlam/ nlam, nlammx, lamnum(2)
      common /cosysi/ nscode, isicod, nterm
      potnam='OH+-H quartet PES reduced'
      npot=1
      nterm=1
      lammin(1)=1
      lammax(1)=19
      mproj(1)=0
      ipotsy = 1
*
      ntv(1)=1
      ivcol(1,1)=0
      ivrow(1,1)=0
*  count number of anisotropic terms
      nlam = 0
      do il=lammin(1),lammax(1)
        nlam = nlam + 1
      enddo
      nlammx = nlam
      return
      end
* --------------------------------------------------------------------------
      subroutine pot (vv0, r)


*  subroutine to calculate the r-dependent coefficients in the
*  collision of a homonuclear diatomic with a structureless target
*  in units of hartree for energy and bohr for distance

*  on return:
*  vv0 contains the isotropic term (n=0) in the potential
*  the coefficients for each angular term in the coupling potential
*  [ vvl(i) for i = 1, nlam ] are returned in common block /covvl/

*  variable in common block /conlam/
*    nlammx:    the maximum number of anisotropic terms
*    nlam:      the total number of angular coupling terms
*  variable in common block /covvl/
*    vvl        array to store r-dependence of each angular term in the
*               potential
* 
* author:  paul dagdigian
* latest revision date:  15-jan-2018
* ----------------------------------------------------------------------
      implicit double precision (a-h,o-z)
      logical ljunk, ihomo, csflag, lljunk
      include "common/parbas"
      dimension v(20)
      dimension csplin(49,20)
      dimension rr(49), vl(980),vec(49)
      common /colpar/ ljunk(5),csflag,lljunk(2),ihomo
      common /covvl/ vvl(19)
*
# r values= 49
      data rr /
     +  1.500,  1.750,  2.000,  2.250,  2.500,
     +  2.750,  3.000,  3.250,  3.500,  3.750,
     +  4.000,  4.250,  4.500,  4.750,  5.000,
     +  5.250,  5.500,  5.750,  6.000,  6.250,
     +  6.500,  6.750,  7.000,  7.500,  8.000,
     +  8.500,  9.000,  9.500, 10.000, 11.000,
     + 12.000, 13.000, 14.000, 15.000, 16.000,
     + 17.000, 18.000, 19.000, 20.000, 21.000,
     + 22.000, 23.000, 24.000, 25.000, 26.000,
     + 27.000, 28.000, 29.000, 30.000 /
*  values of the vlam coefficients
*  vlam > 0:  19
      data vl /  
     +  8.7300790e+04,  9.6532657e+04,  7.8539327e+04,  5.1060817e+04,
     +  3.2109646e+04,  2.0779702e+04,  1.4034997e+04,  9.7952457e+03,
     +  6.9419890e+03,  4.9250059e+03,  3.4715770e+03,  2.4285651e+03,
     +  1.6910713e+03,  1.1763846e+03,  8.1748585e+02,  5.6258391e+02,
     +  3.7487220e+02,  2.3077576e+02,  1.1694680e+02,  2.6806815e+01,
     + -4.2572657e+01, -9.2781166e+01, -1.2543926e+02, -1.4753993e+02,
     + -1.3182414e+02, -1.0072737e+02, -6.9208656e+01, -4.4008475e+01,
     + -2.6393289e+01, -8.3667426e+00, -2.3600071e+00, -6.1468015e-01,
     + -1.5095556e-01, -3.5391179e-02, -7.9839985e-03, -1.7427340e-03,
     + -3.6963361e-04, -7.6445458e-05, -1.5461647e-05, -3.0661480e-06,
     + -5.9747620e-07, -1.1463536e-07, -2.1689529e-08, -4.0520509e-09,
     + -7.4483337e-10, -1.3413656e-10, -2.4975550e-11, -4.4804012e-12,
     + -7.8522735e-13, 
     + -1.7832080e+05, -2.2330010e+05, -1.8488317e+05, -1.1631106e+05,
     + -7.0465875e+04, -4.4720398e+04, -3.0533584e+04, -2.2203396e+04,
     + -1.6772328e+04, -1.2877026e+04, -9.9238555e+03, -7.6426562e+03,
     + -5.8807834e+03, -4.5239457e+03, -3.4746783e+03, -2.6516477e+03,
     + -1.9926230e+03, -1.4549070e+03, -1.0124001e+03, -6.5064505e+02,
     + -3.6160837e+02, -1.3946880e+02,  2.2003086e+01,  1.9501413e+02,
     +  2.3037394e+02,  1.9739380e+02,  1.4405574e+02,  9.4910546e+01,
     +  5.8175688e+01,  1.8827504e+01,  5.3289520e+00,  1.3799095e+00,
     +  3.3536475e-01,  7.7683345e-02,  1.7319271e-02,  3.7409224e-03,
     +  7.8653125e-04,  1.6154249e-04,  3.2502709e-05,  6.4213482e-06,
     +  1.2481212e-06,  2.3909024e-07,  4.5201115e-08,  8.4430005e-09,
     +  1.5578889e-09,  2.8226151e-10,  5.2024334e-11,  9.4383776e-12,
     +  1.7337517e-12, 
     +  2.0269606e+05,  2.7729282e+05,  2.2553254e+05,  1.2832941e+05,
     +  6.7110212e+04,  3.6097163e+04,  2.1608879e+04,  1.4878505e+04,
     +  1.1464202e+04,  9.3704929e+03,  7.7941942e+03,  6.4580201e+03,
     +  5.2892807e+03,  4.2771663e+03,  3.4175295e+03,  2.6980515e+03,
     +  2.0996266e+03,  1.6019241e+03,  1.1877357e+03,  8.4465509e+02,
     +  5.6446315e+02,  3.4139020e+02,  1.7032031e+02, -3.9306470e+01,
     + -1.1894718e+02, -1.2484312e+02, -1.0009429e+02, -6.9696208e+01,
     + -4.4313364e+01, -1.5004858e+01, -4.3591689e+00, -1.1469275e+00,
     + -2.8151130e-01, -6.5608810e-02, -1.4682997e-02, -3.1792856e-03,
     + -6.6960945e-04, -1.3772315e-04, -2.7746800e-05, -5.4891037e-06,
     + -1.0684326e-06, -2.0496876e-07, -3.8811176e-08, -7.2622530e-09,
     + -1.3469276e-09, -2.4507912e-10, -4.4806330e-11, -8.0256383e-12,
     + -1.5366204e-12, 
     + -2.0705423e+05, -3.0825591e+05, -2.4900561e+05, -1.3168788e+05,
     + -6.0467276e+04, -2.6364843e+04, -1.1999278e+04, -6.6573322e+03,
     + -4.9945802e+03, -4.5966573e+03, -4.4679878e+03, -4.2608700e+03,
     + -3.9061805e+03, -3.4398879e+03, -2.9234565e+03, -2.4104015e+03,
     + -1.9360219e+03, -1.5181573e+03, -1.1621524e+03, -8.6616296e+02,
     + -6.2512634e+02, -4.3299263e+02, -2.8365052e+02, -8.9565206e+01,
     +  3.1878892e+00,  3.5529350e+01,  3.8231904e+01,  3.0147015e+01,
     +  2.0531499e+01,  7.4832134e+00,  2.2603325e+00,  6.0931189e-01,
     +  1.5205437e-01,  3.5864684e-02,  8.0988712e-03,  1.7658948e-03,
     +  3.7400021e-04,  7.7275585e-05,  1.5628804e-05,  3.1021875e-06,
     +  6.0562345e-07,  1.1648899e-07,  2.2111759e-08,  4.1505130e-09,
     +  7.7332850e-10,  1.4093315e-10,  2.5663954e-11,  4.5647442e-12,
     +  8.1808585e-13, 
     +  2.0151601e+05,  3.2470767e+05,  2.6392105e+05,  1.3554947e+05,
     +  5.9547252e+04,  2.3671119e+04,  8.5282923e+03,  2.8314585e+03,
     +  1.1242145e+03,  9.4267092e+02,  1.2172512e+03,  1.5115828e+03,
     +  1.6764938e+03,  1.6908743e+03,  1.5853964e+03,  1.4048915e+03,
     +  1.1904528e+03,  9.7253987e+02,  7.7015327e+02,  5.9292399e+02,
     +  4.4406799e+02,  3.2303284e+02,  2.2736374e+02,  9.8912184e+01,
     +  3.1760898e+01,  2.1383003e+00, -7.6282834e+00, -8.6438169e+00,
     + -6.7635228e+00, -2.7717010e+00, -8.8106351e-01, -2.4439701e-01,
     + -6.2130034e-02, -1.4848139e-02, -3.3861579e-03, -7.4401572e-04,
     + -1.5854816e-04, -3.2924785e-05, -6.6870799e-06, -1.3320984e-06,
     + -2.6086450e-07, -5.0309231e-08, -9.5735574e-09, -1.8065765e-09,
     + -3.3700770e-10, -6.1493571e-11, -1.1185983e-11, -2.0872022e-12,
     + -3.2900170e-13, 
     + -1.8344109e+05, -3.2216066e+05, -2.6407902e+05, -1.3344528e+05,
     + -5.8850255e+04, -2.4237147e+04, -9.2849815e+03, -3.0677090e+03,
     + -6.1694337e+02,  2.1943726e+02,  3.7676140e+02,  2.7330408e+02,
     +  1.0015528e+02, -5.8279225e+01, -1.7094629e+02, -2.3376181e+02,
     + -2.5503365e+02, -2.4706728e+02, -2.2162626e+02, -1.8796148e+02,
     + -1.5241025e+02, -1.1883583e+02, -8.9277263e+01, -4.4803898e+01,
     + -1.8417229e+01, -5.1610017e+00,  2.6345200e-01,  1.7978702e+00,
     +  1.7685332e+00,  8.3899859e-01,  2.8158822e-01,  8.0341183e-02,
     +  2.0783731e-02,  5.0272875e-03,  1.1567625e-03,  2.5592616e-04,
     +  5.4837099e-05,  1.1438559e-05,  2.3317552e-06,  4.6592716e-07,
     +  9.1480117e-08,  1.7682378e-08,  3.3732550e-09,  6.3903688e-10,
     +  1.1842150e-10,  2.1740146e-11,  3.8460974e-12,  8.1431244e-13,
     +  1.4637521e-13, 
     +  1.5697639e+05,  3.0287927e+05,  2.4838938e+05,  1.2108924e+05,
     +  5.2320212e+04,  2.1893719e+04,  9.1420839e+03,  3.8110843e+03,
     +  1.5342468e+03,  5.4035546e+02,  1.1063852e+02, -5.8411379e+01,
     + -1.0443793e+02, -9.5074847e+01, -6.5312632e+01, -3.3027998e+01,
     + -6.3873110e+00,  1.2035681e+01,  2.2616594e+01,  2.6995374e+01,
     +  2.7085518e+01,  2.4570156e+01,  2.0745109e+01,  1.2469813e+01,
     +  6.0438624e+00,  2.2111586e+00,  3.8645325e-01, -2.7104225e-01,
     + -3.9052012e-01, -2.1876361e-01, -7.7434547e-02, -2.2673845e-02,
     + -5.9568221e-03, -1.4558705e-03, -3.3750909e-04, -7.5095946e-05,
     + -1.6161846e-05, -3.3830223e-06, -6.9159096e-07, -1.3851403e-07,
     + -2.7242867e-08, -5.2764456e-09, -1.0103532e-09, -1.9035704e-10,
     + -3.3513589e-11, -6.4899772e-12, -1.2639689e-12, -3.0864903e-13,
     + -3.8781103e-14, 
     + -1.2936555e+05, -2.7608661e+05, -2.2485215e+05, -1.0381168e+05,
     + -4.2559748e+04, -1.7041061e+04, -6.9287259e+03, -2.9168993e+03,
     + -1.2746371e+03, -5.6745799e+02, -2.4574276e+02, -9.3607554e+01,
     + -2.1712241e+01,  9.8766034e+00,  2.0701436e+01,  2.1168636e+01,
     +  1.7106497e+01,  1.1747669e+01,  6.7680909e+00,  2.8643604e+00,
     +  1.8377572e-01, -1.4099218e+00, -2.1581389e+00, -2.1257717e+00,
     + -1.3273152e+00, -5.9631835e-01, -1.6304423e-01,  2.4265863e-02,
     +  7.5318814e-02,  5.0606911e-02,  1.8860164e-02,  5.6560014e-03,
     +  1.5063200e-03,  3.7137353e-04,  8.6613868e-05,  1.9356057e-05,
     +  4.1793119e-06,  8.7695672e-07,  1.7961584e-07,  3.6029590e-08,
     +  7.0853110e-09,  1.3778987e-09,  2.6605104e-10,  4.9719959e-11,
     +  6.3140221e-12,  1.7924110e-12,  2.1492358e-13, -3.7725302e-15,
     + -8.5844780e-15, 
     +  1.0437728e+05,  2.4753407e+05,  1.9944740e+05,  8.6513006e+04,
     +  3.3323935e+04,  1.2557358e+04,  4.8084485e+03,  1.9127441e+03,
     +  8.0011096e+02,  3.5204623e+02,  1.6072346e+02,  7.3971243e+01,
     +  3.2588931e+01,  1.2237512e+01,  2.2643360e+00, -2.3033764e+00,
     + -3.9616130e+00, -4.0849032e+00, -3.4744347e+00, -2.6015658e+00,
     + -1.7395762e+00, -1.0199944e+00, -4.8892301e-01,  5.8883836e-02,
     +  1.6444586e-01,  1.0832187e-01,  3.9666796e-02,  6.7009913e-04,
     + -1.3001757e-02, -1.0582053e-02, -4.1490559e-03, -1.2727429e-03,
     + -3.4314666e-04, -8.5230097e-05, -1.9968466e-05, -4.4763979e-06,
     + -9.6852410e-07, -2.0351273e-07, -4.1728247e-08, -8.3755141e-09,
     + -1.6445141e-09, -3.2167564e-10, -6.2320084e-11, -9.3845512e-12,
     +  1.2243575e-13, -2.4339789e-13,  2.6787822e-14,  7.6105677e-14,
     + -2.9590399e-14, 
     + -8.3107714e+04, -2.2009708e+05, -1.7478257e+05, -7.0810082e+04,
     + -2.5520148e+04, -9.0230552e+03, -3.2419751e+03, -1.2076210e+03,
     + -4.7237841e+02, -1.9495411e+02, -8.4507796e+01, -3.8019054e+01,
     + -1.7456853e+01, -7.9722198e+00, -3.4263682e+00, -1.1721790e+00,
     + -4.2243586e-02,  4.9333781e-01,  6.8804969e-01,  6.8869008e-01,
     +  5.9115685e-01,  4.5187765e-01,  3.1213166e-01,  1.0653084e-01,
     +  1.3797590e-02, -8.2878996e-03, -5.7808520e-03, -5.7201581e-04,
     +  2.0498304e-03,  2.0335845e-03,  8.3897887e-04,  2.6258854e-04,
     +  7.1593825e-05,  1.7892283e-05,  4.2050343e-06,  9.4460399e-07,
     +  2.0450342e-07,  4.2989573e-08,  8.8235644e-09,  1.7734161e-09,
     +  3.5380899e-10,  6.9182573e-11,  1.2871236e-11, -2.6870828e-12,
     + -1.8716153e-13,  1.9536264e-13,  1.2887820e-13,  1.0233238e-13,
     + -1.1701415e-14, 
     +  6.5620683e+04,  1.9468372e+05,  1.5196752e+05,  5.7219063e+04,
     +  1.9225705e+04,  6.3661064e+03,  2.1461522e+03,  7.4960945e+02,
     +  2.7458298e+02,  1.0612742e+02,  4.3159457e+01,  1.8255403e+01,
     +  7.9256124e+00,  3.4956450e+00,  1.5659115e+00,  7.0116396e-01,
     +  2.9712118e-01,  8.9480690e-02, -2.2765537e-02, -8.4787761e-02,
     + -1.0405161e-01, -1.0341013e-01, -8.6172983e-02, -4.4664393e-02,
     + -1.5299452e-02, -3.1152508e-03, -1.1308398e-04, -2.3076091e-06,
     + -3.1249703e-04, -3.6847275e-04, -1.5687962e-04, -5.0582865e-05,
     + -1.3895097e-05, -3.4846599e-06, -8.2118738e-07, -1.8433824e-07,
     + -3.9925335e-08, -8.4121673e-09, -1.7189200e-09, -3.3794063e-10,
     + -7.6947012e-11, -1.6057244e-11,  6.9464533e-14,  3.1193010e-12,
     + -1.1691434e-12,  5.1778505e-14,  1.2191489e-14,  2.0973820e-14,
     +  1.8643041e-13, 
     + -5.1550608e+04, -1.7208082e+05, -1.3157523e+05, -4.5813985e+04,
     + -1.4302102e+04, -4.4262273e+03, -1.3993854e+03, -4.5867598e+02,
     + -1.5756497e+02, -5.7167203e+01, -2.1917934e+01, -8.7888949e+00,
     + -3.6135892e+00, -1.4969357e+00, -6.1602814e-01, -2.5905057e-01,
     + -1.1392622e-01, -5.4133355e-02, -2.5675503e-02, -6.8932139e-03,
     +  4.7844766e-03,  1.2419318e-02,  1.5098272e-02,  1.1604471e-02,
     +  5.4450594e-03,  1.5724228e-03,  3.3045040e-04,  8.0327177e-05,
     +  6.9190919e-05,  6.6640218e-05,  2.6742500e-05,  9.2213296e-06,
     +  2.4603684e-06,  6.2146887e-07,  1.4980880e-07,  3.3051194e-08,
     +  7.2368733e-09,  1.5517268e-09,  3.0760713e-10,  5.8939248e-11,
     +  2.1758388e-11,  4.5553271e-12, -2.0709281e-12, -1.4513107e-12,
     +  2.2300210e-12,  8.1677166e-14, -1.2166236e-14, -1.3025206e-13,
     + -2.4256031e-13, 
     +  4.0379450e+04,  1.5196140e+05,  1.1360968e+05,  3.6441632e+04,
     +  1.0536090e+04,  3.0412202e+03,  9.0103211e+02,  2.7726882e+02,
     +  8.9390372e+01,  3.0434879e+01,  1.0986226e+01,  4.1903139e+00,
     +  1.6588100e+00,  6.6021678e-01,  2.6170271e-01,  9.5125446e-02,
     +  3.5610381e-02,  1.3642005e-02,  6.0895448e-03,  6.8641348e-03,
     +  2.6854241e-03,  1.9237309e-03, -1.6459255e-03, -2.1569285e-03,
     + -1.3698201e-03, -4.3417920e-04, -1.3626403e-04, -4.1351876e-05,
     + -3.7386239e-05,  1.2737949e-06, -5.3138371e-06, -1.2775606e-06,
     + -3.0705474e-07, -9.3391703e-08, -2.2062423e-08, -4.5026829e-09,
     + -1.0776893e-09, -2.6461105e-10, -5.5130231e-11, -8.6313693e-12,
     + -4.5905636e-12, -1.0782849e-12,  6.8981863e-12,  1.8931965e-12,
     + -2.0920180e-12, -6.0194952e-14, -1.5009565e-13, -8.1305901e-14,
     +  3.4543181e-14, 
     + -3.1585268e+04, -1.3458389e+05, -9.8059455e+04, -2.8853919e+04,
     + -7.7033855e+03, -2.0695188e+03, -5.7401166e+02, -1.6588114e+02,
     + -5.0246889e+01, -1.6057708e+01, -5.4449755e+00, -1.9608146e+00,
     + -7.4706369e-01, -2.9504103e-01, -1.1014641e-01, -4.1385443e-02,
     + -1.2210348e-02, -4.2951115e-03, -4.0279042e-04, -4.3221999e-04,
     + -1.2955511e-03, -1.1257859e-03, -1.0346365e-03,  1.2517844e-04,
     +  1.3007935e-04,  8.9276637e-05,  4.4023857e-05,  4.5871826e-05,
     +  3.4148808e-05, -7.3528722e-06,  8.6224942e-08, -2.2920828e-07,
     + -2.0554982e-08,  1.2339509e-08, -9.3367568e-11, -2.1850152e-10,
     +  5.7923057e-11,  2.9116064e-11,  4.1186294e-12, -9.8258750e-12,
     + -2.0385920e-12, -1.0720284e-12, -8.5333064e-12,  4.9300077e-13,
     +  1.1165012e-12,  6.0752606e-14,  1.3585604e-13, -5.2798390e-14,
     +  1.8253658e-13, 
     +  2.4694732e+04,  1.1923695e+05,  8.4596139e+04,  2.2772650e+04,
     +  5.5995410e+03,  1.3972280e+03,  3.6237373e+02,  9.8336489e+01,
     +  2.8021452e+01,  8.4181095e+00,  2.6813247e+00,  9.0804633e-01,
     +  3.2428070e-01,  1.2038421e-01,  4.9839987e-02,  1.8063995e-02,
     +  7.3716144e-03,  2.1812592e-03,  1.4058861e-03,  3.8457949e-04,
     + -8.9780480e-05, -8.6353205e-04, -1.2185453e-04, -3.9901832e-05,
     +  1.3653018e-04, -3.6174927e-05,  2.1561961e-04, -7.1633607e-06,
     + -1.3857528e-05,  2.4180494e-07,  7.5972754e-07,  2.0007914e-07,
     +  7.5672023e-08, -2.7932725e-09,  3.4081205e-09,  5.9563048e-10,
     +  2.4295914e-12,  1.0535189e-11,  1.1668237e-11,  4.2841798e-12,
     +  2.7510798e-12, -1.7592693e-12,  5.5322978e-12, -3.5730965e-12,
     +  3.3998879e-13, -1.4369725e-13,  4.3913876e-15,  2.7855628e-13,
     + -1.5249409e-13, 
     + -1.9312941e+04, -1.0616542e+05, -7.3099061e+04, -1.7936019e+04,
     + -4.0521088e+03, -9.3729215e+02, -2.2700009e+02, -5.7818208e+01,
     + -1.5504709e+01, -4.3871752e+00, -1.3135089e+00, -4.1996467e-01,
     + -1.4123056e-01, -5.0142142e-02, -1.7320309e-02, -4.0974197e-03,
     + -2.8038254e-03,  9.7438868e-05,  1.6837235e-03,  1.4127267e-05,
     +  7.4782462e-04,  1.1639495e-03,  6.2786814e-04,  1.9840970e-04,
     +  7.4139805e-05,  1.9786431e-04, -3.7758029e-05,  3.7721940e-05,
     + -1.8164169e-05, -1.6453143e-06, -4.0340501e-07, -1.2956163e-07,
     +  1.4855152e-09,  1.2423561e-08, -2.6420386e-09, -1.1626623e-10,
     +  8.1732832e-11, -4.9677301e-11, -1.0924369e-12,  9.1696334e-12,
     + -2.5048622e-12,  2.6720557e-12,  1.0867185e-12,  2.8783483e-12,
     + -1.7262561e-12, -3.6542416e-13, -8.2842072e-14,  4.4664670e-14,
     +  1.6565603e-14, 
     +  1.5112670e+04,  9.4536182e+04,  6.3179330e+04,  1.4106677e+04,
     +  2.9222667e+03,  6.2548127e+02,  1.4126120e+02,  3.3746936e+01,
     +  8.5224482e+00,  2.2726512e+00,  6.4100128e-01,  1.9382729e-01,
     +  6.6768898e-02,  2.1850333e-02,  9.9656648e-03,  4.4336695e-03,
     + -8.1979971e-04,  1.0857930e-03,  1.5891616e-03, -7.1702551e-04,
     + -7.1576518e-04,  1.3867716e-05, -1.4349680e-05,  2.4281756e-04,
     +  1.0733137e-04, -1.6803213e-04,  3.5671251e-05, -1.2975820e-05,
     +  1.7828395e-05, -6.2126863e-06,  1.1681465e-06,  2.2220670e-09,
     + -4.7036447e-08, -1.7293307e-08, -5.0532420e-10, -8.3141331e-10,
     + -5.1799700e-11,  4.6563041e-11,  7.3200510e-12, -2.6512083e-11,
     + -1.9425214e-12,  9.4593694e-13, -6.8184956e-12, -1.9991049e-12,
     +  1.9763204e-12, -1.5082072e-13,  1.4742087e-13, -2.4750430e-13,
     + -1.0824436e-14, 
     + -1.1838369e+04, -8.4742590e+04, -5.4763015e+04, -1.1087709e+04,
     + -2.1020149e+03, -4.1564372e+02, -8.7416160e+01, -1.9568880e+01,
     + -4.6539354e+00, -1.1709851e+00, -3.1087278e-01, -9.0359398e-02,
     + -2.2942325e-02, -9.5170385e-03, -2.5208794e-03, -2.9241000e-03,
     + -1.9256626e-03, -1.4954574e-03, -1.8788288e-03,  5.6016646e-04,
     +  1.7584547e-04, -2.2912050e-04, -1.3381416e-03, -3.1192929e-04,
     + -4.8770117e-04,  1.7080094e-04,  6.0426256e-05, -5.6677355e-05,
     + -2.8900913e-05, -9.6048000e-07, -7.8565063e-07,  1.0273637e-07,
     +  6.1992613e-09,  1.3649594e-08,  4.7340597e-09,  1.6013147e-09,
     + -2.7876285e-11, -5.9915646e-12, -9.7106138e-12,  2.3066619e-11,
     + -3.0445316e-12,  2.8804569e-12,  6.6090318e-12,  2.6517502e-12,
     + -1.2495261e-12,  1.5250731e-13, -1.8129388e-13,  1.5120175e-14,
     +  5.7956308e-14, 
     +  9.2822030e+03,  7.5875529e+04,  4.7471877e+04,  8.7106199e+03,
     +  1.5090203e+03,  2.7526213e+02,  5.3842585e+01,  1.1283341e+01,
     +  2.5202283e+00,  5.9871722e-01,  1.4466578e-01,  4.1324876e-02,
     +  1.4821584e-02,  4.8451208e-03, -1.1209114e-03,  1.3126027e-03,
     + -1.5290851e-03, -4.0630625e-03, -1.6779716e-03,  2.4122278e-04,
     + -5.7225380e-04,  1.5149768e-04, -4.4004125e-04, -9.5196533e-05,
     +  3.1385699e-05, -1.6872894e-05, -1.2935103e-04,  2.7377731e-05,
     +  5.9789488e-05,  6.6019276e-06,  2.4829973e-06,  3.5245690e-07,
     +  4.7147234e-08, -5.1732566e-09, -2.5892379e-09, -1.0675233e-09,
     +  1.2754710e-12,  1.6005496e-11, -1.5857631e-11, -1.2937783e-11,
     +  1.3542450e-11, -1.0897167e-11, -6.9072954e-12, -7.1070530e-13,
     + -6.3250142e-14,  4.6725594e-14, -2.6235262e-14,  1.0743209e-13,
     +  1.8148122e-14, 
     + -7.2885759e+03, -6.8527605e+04, -4.1318108e+04, -6.8445492e+03,
     + -1.0817805e+03, -1.8179284e+02, -3.3029618e+01, -6.4735528e+00,
     + -1.3622052e+00, -3.0084112e-01, -7.2057643e-02, -1.5228312e-02,
     + -4.7519982e-03,  1.2619003e-03, -1.1004104e-03,  1.4252213e-03,
     + -1.4601289e-04, -2.7770295e-03, -1.0680288e-03,  8.8450715e-04,
     + -6.2716576e-04,  9.8456680e-04,  6.1484632e-04, -6.5056449e-04,
     + -9.7531698e-07, -2.9945374e-04, -1.4180387e-04, -7.3981891e-06,
     +  2.4063848e-05, -6.5203841e-06, -2.1015956e-06, -2.7063548e-07,
     + -4.3188651e-08, -1.6516355e-08,  1.2206018e-09, -4.0154318e-10,
     + -4.3704529e-11, -4.8001818e-11,  1.0126556e-11,  9.3412968e-12,
     + -5.1957475e-12,  3.1998125e-12,  5.1320073e-13, -2.1457968e-12,
     +  1.0185254e-12,  2.3533026e-14,  1.0511477e-14, -9.0008213e-14,
     + -1.1429178e-13  /
*
* spline fit
      if (ifirst .eq. 0) then
* spline fit of the vl coefficients
         ind=1
         do ilam=1,20
           call dcopy(49,vl(ind),1,vec,1)
*    evaluate derivative at first point
           der1=(vec(2)-vec(1))/(rr(2)-rr(1))
           call dspline(rr,vec,49,der1,0d0,csplin(1,ilam))
           ind = ind + 49
         enddo
         ifirst = 1
       end if
* switching function for long-range
       switch_lr=0.5*(tanh(0.5*(r - 22.d0)) + 1.d0)
* determine splined coefficients at R=r
       ind=1
       do ilam=1,20
         call dcopy(49,vl(ind),1,vec,1)
         call dsplint(rr,vec,csplin(1,ilam),49,r,vvx)
* kill anisotropic terms at large R
         vvx = (1.d0 - switch_lr)*vvx
         v(ilam)=vvx
         call dcopy(49,vl(ind),1,vec,1)
         ind = ind + 49
       enddo
       call dcopy(19,v(2),1,vvl(1),1)
* convert to hartree
       econv=1.d0/219474.6d0
       call dscal(19,econv,vvl,1)
* isotropic term 
       vv0 = v(1)*econv
*
       return
       end
*===========================eof===============================
