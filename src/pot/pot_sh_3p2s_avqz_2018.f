*  System:  S(3P) + H(2S)
*
*   calculation of potential energy curves and spin-orbit matrix
*   elements, taken from m. alexander's notes (2018)
*
*   MRCI+Q calculation with avqz basis (m.alexander, sep-2018)
*
*   two spin-orbit matrix parameters are included:  apar and aperp
*   the atomic spin-orbit splittings are computed from the large-R
*   values of these parameters.
*   here, the atomic values (apar = aperp) are used for all R
*  
*   written by p. dagdigian
*   current revision date:  5-sep-2018
*
      include "common/syusr"
      include "common/bausr"
      include "common/ground"
* --------------------------------------------------------------------------
      subroutine loapot(iunit,filnam)
* --------------------------------------------------------------------------
      character*(*) filnam
      common /coselb/ ibasty
      include "common/parbas"
      include "common/parpot"
      common /conlam/ nlam, nlammx, lamnum(1)
      potnam='S(3P)-H(2S) avqz 2018'
      npot=1
      ibasty=23
      lammin(1)=1
      lammax(1)=6
      mproj(1)=0
      ntv(1)=1
      ivcol(1,1)=0
      ivrow(1,1)=0
*  count number of anisotropic terms
      nlam = 0
      do il = lammin(1), lammax(1)
        nlam = nlam + 1
      enddo
      return
      end
* --------------------------------------------------------------------------
      subroutine driver
      implicit double precision (a-h,o-z)
      common /cosysi/ junk(5), npot
      common /covvl/ vvl(8)
      include "common/parpot"
      potnam='S(3P)-H(2S) avqz 2018'
      econv=219474.6d0
      print *, potnam
1     print *, 'R (bohr):'
      read (5, *, end=99) r
      if (r.le.0.d0) goto 99
      call pot(vv0,r)
      write (6, 100) (econv*vvl(i), i=1,6)
100   format('  ',6(1pe16.8))
      goto 1
99    rr= 1.075d0
      dr=0.2d0
      open (unit=12,file='sh_vlms_avqz_so_const.txt')
      write(12,109)
109   format(' %R/bohr X2Pi  4Pi  2Sig-  4Sig-  apar   aperp')
      do i=1,426
        call pot(vv0,rr)
        write (12,110) rr,(econv*vvl(j),j=1,6)
110     format(f11.5,6(1pe16.8))
        rr = rr + dr
      enddo
      close(12)
      end
* --------------------------------------------------------------------------
      subroutine pot (vv0, r)
*  subroutine to calculate the r-dependent coefficients
*  in atomic units (distance and energy)
* ----------------------------------------------------------------------
*  on entry:
*    r:      interparticle distance
*  on return:
*    vv0        (not used)
*    vvl(1,4)   contains the X2Pi, 4Pi, 2Sig-, 4Sig- energies
*    vvl(5,6)   contains the spin-orbit matrix parameters apar and aperp at R
*  variable in common block /conlam/ used here
*    nlam:      the number of angular coupling terms actually used
*  variable in common block /covvl/
*    vvl:       array to store r-dependence of each
*               angular term in the potential
*  variable in common block /coconv/
*    econv:     conversion factor from cm-1 to hartrees
* 
* author:  paul dagdigian
* latest revision date:  31-aug-2018
* ----------------------------------------------------------------------
      implicit double precision (a-h,o-z)
      include "common/parbas"
      common /covvl/ vvl(6)
      dimension rr(376),v2pi(376),v4pi(376),v2sigm(376),v4sigm(376)
      dimension vl(376), vec(376), v(6)
      data npts / 186 /
*
c  number of r values= 186
      data rr /
     +  1.134,  1.209,  1.285,  1.361,  1.436,
     +  1.512,  1.587,  1.663,  1.739,  1.814,
     +  1.890,  1.965,  2.041,  2.116,  2.192,
     +  2.268,  2.343,  2.419,  2.494,  2.570,
     +  2.646,  2.721,  2.797,  2.872,  2.948,
     +  3.024,  3.099,  3.175,  3.250,  3.326,
     +  3.402,  3.477,  3.553,  3.628,  3.704,
     +  3.779,  3.855,  3.931,  4.006,  4.082,
     +  4.157,  4.233,  4.309,  4.384,  4.460,
     +  4.535,  4.611,  4.687,  4.762,  4.838,
     +  4.913,  4.989,  5.064,  5.140,  5.216,
     +  5.291,  5.367,  5.442,  5.518,  5.594,
     +  5.669,  5.745,  5.820,  5.896,  5.972,
     +  6.047,  6.123,  6.198,  6.274,  6.349,
     +  6.425,  6.501,  6.576,  6.652,  6.727,
     +  6.803,  6.879,  6.954,  7.030,  7.105,
     +  7.181,  7.257,  7.332,  7.408,  7.483,
     +  7.559,  7.634,  7.710,  7.786,  7.861,
     +  7.937,  8.012,  8.088,  8.164,  8.239,
     +  8.315,  8.390,  8.466,  8.542,  8.617,
     +  8.693,  8.768,  8.844,  8.920,  8.995,
     +  9.071,  9.146,  9.222,  9.297,  9.373,
     +  9.449,  9.524,  9.600,  9.675,  9.751,
     +  9.827,  9.902,  9.978, 10.053, 10.129,
     + 10.205, 10.280, 10.356, 10.431, 10.507,
     + 10.582, 10.658, 10.734, 10.809, 10.885,
     + 10.960, 11.036, 11.112, 11.187, 11.263,
     + 11.338, 11.414, 11.490, 11.565, 11.641,
     + 11.716, 11.792, 11.867, 11.943, 12.019,
     + 12.094, 12.170, 12.245, 12.321, 12.397,
     + 12.472, 12.548, 12.623, 12.699, 12.775,
     + 12.850, 12.926, 13.001, 13.077, 13.152,
     + 13.228, 13.304, 13.379, 13.455, 13.530,
     + 13.606, 13.682, 13.757, 13.833, 13.908,
     + 13.984, 14.060, 14.135, 14.211, 14.286,
     + 14.362, 14.438, 14.513, 14.589, 14.664,
     + 14.740, 14.815, 14.891, 14.967, 15.042,
     + 15.118  /
c  X2Pi
      data v2pi /
     +  2.6964357d+05,  2.0965621d+05,  1.6117493d+05,  1.2177112d+05,
     +  8.9636671d+04,  6.3583899d+04,  4.2512411d+04,  2.5563014d+04,
     +  1.1944195d+04,  1.0343092d+03, -7.6184243d+03, -1.4430033d+04,
     + -1.9703078d+04, -2.3709721d+04, -2.6675480d+04, -2.8779221d+04,
     + -3.0188098d+04, -3.1030516d+04, -3.1423686d+04, -3.1450538d+04,
     + -3.1169234d+04, -3.0642665d+04, -2.9918965d+04, -2.9039368d+04,
     + -2.8038084d+04, -2.6943799d+04, -2.5783344d+04, -2.4577072d+04,
     + -2.3343586d+04, -2.2098405d+04, -2.0853972d+04, -1.9621819d+04,
     + -1.8410399d+04, -1.7227327d+04, -1.6078769d+04, -1.4969441d+04,
     + -1.3903627d+04, -1.2884145d+04, -1.1913422d+04, -1.0993292d+04,
     + -1.0125000d+04, -9.3094045d+03, -8.5459275d+03, -7.8336305d+03,
     + -7.1715751d+03, -6.5588228d+03, -5.9941306d+03, -5.4750353d+03,
     + -4.9987692d+03, -4.5625642d+03, -4.1636526d+03, -3.7992828d+03,
     + -3.4667680d+03, -3.1634381d+03, -2.8866226d+03, -2.6336513d+03,
     + -2.4020326d+03, -2.1899901d+03, -1.9959261d+03, -1.8182431d+03,
     + -1.6553433d+03, -1.5057526d+03, -1.3684911d+03, -1.2427020d+03,
     + -1.1275289d+03, -1.0221152d+03, -9.2565618d+02, -8.3755522d+02,
     + -7.5726751d+02, -6.8424826d+02, -6.1795268d+02, -5.5784597d+02,
     + -5.0343312d+02, -4.5422910d+02, -4.0974888d+02, -3.6950744d+02,
     + -3.3305939d+02, -3.0011799d+02, -2.7043618d+02, -2.4376687d+02,
     + -2.1986299d+02, -1.9847745d+02, -1.7936317d+02, -1.6227309d+02,
     + -1.4696012d+02, -1.3317719d+02, -1.2070406d+02, -1.0942791d+02,
     + -9.9262779d+01, -9.0122686d+01, -8.1921660d+01, -7.4573730d+01,
     + -6.7992924d+01, -6.2093271d+01, -5.6788798d+01, -5.1993533d+01,
     + -4.7631130d+01, -4.3663748d+01, -4.0063170d+01, -3.6801181d+01,
     + -3.3849565d+01, -3.1180105d+01, -2.8764586d+01, -2.6574792d+01,
     + -2.4582508d+01, -2.2759516d+01, -2.1081102d+01, -1.9536548d+01,
     + -1.8118639d+01, -1.6820158d+01, -1.5633888d+01, -1.4552614d+01,
     + -1.3569119d+01, -1.2676187d+01, -1.1866600d+01, -1.1133143d+01,
     + -1.0468600d+01, -9.8657539d+00, -9.3173883d+00, -8.8162870d+00,
     + -8.3552335d+00, -7.9270115d+00, -7.5244045d+00, -7.1403453d+00,
     + -6.7711919d+00, -6.4167281d+00, -6.0768867d+00, -5.7516005d+00,
     + -5.4408022d+00, -5.1444245d+00, -4.8624002d+00, -4.5946620d+00,
     + -4.3411428d+00, -4.1017751d+00, -3.8764919d+00, -3.6652258d+00,
     + -3.4677712d+00, -3.2833691d+00, -3.1111220d+00, -2.9501326d+00,
     + -2.7995032d+00, -2.6583366d+00, -2.5257353d+00, -2.4008019d+00,
     + -2.2826389d+00, -2.1703489d+00, -2.0630345d+00, -1.9597983d+00,
     + -1.8597618d+00, -1.7624844d+00, -1.6679632d+00, -1.5762144d+00,
     + -1.4872542d+00, -1.4010986d+00, -1.3177639d+00, -1.2372662d+00,
     + -1.1596217d+00, -1.0848465d+00, -1.0129568d+00, -9.4396871d-01,
     + -8.7789840d-01, -8.1474082d-01, -7.5440608d-01, -6.9678307d-01,
     + -6.4176067d-01, -5.8922779d-01, -5.3907332d-01, -4.9118614d-01,
     + -4.4545515d-01, -4.0176925d-01, -3.6001732d-01, -3.2008827d-01,
     + -2.8187097d-01, -2.4525433d-01, -2.1012724d-01, -1.7637859d-01,
     + -1.4389727d-01, -1.1257218d-01, -8.2292207d-02, -5.2946244d-02,
     + -2.4423186d-02,  3.3880758d-03,  3.0598648d-02,  5.7319638d-02,
     +  1.5042223d+01,  1.5117812d+01  /
c  4Pi
      data v4pi /
     +  3.5738893d+05,  2.9796140d+05,  2.4992499d+05,  2.1087366d+05,
     +  1.7900871d+05,  1.5313880d+05,  1.3216011d+05,  1.1521336d+05,
     +  1.0150673d+05,  9.0393320d+04,  8.1371196d+04,  7.3975294d+04,
     +  6.7862849d+04,  6.2715971d+04,  5.8085606d+04,  5.3391542d+04,
     +  4.8281947d+04,  4.3341322d+04,  3.9344287d+04,  3.6083621d+04,
     +  3.3016091d+04,  3.0196846d+04,  2.7584598d+04,  2.5153506d+04,
     +  2.2897674d+04,  2.0806390d+04,  1.8869251d+04,  1.7077980d+04,
     +  1.5424826d+04,  1.3901958d+04,  1.2501471d+04,  1.1215575d+04,
     +  1.0036976d+04,  8.9585125d+03,  7.9733467d+03,  7.0749613d+03,
     +  6.2569939d+03,  5.5136467d+03,  4.8392752d+03,  4.2285205d+03,
     +  3.6763093d+03,  3.1778004d+03,  2.7290312d+03,  2.3262588d+03,
     +  1.9657404d+03,  1.6437331d+03,  1.3567209d+03,  1.1020963d+03,
     +  8.7747872d+02,  6.8048752d+02,  5.0874212d+02,  3.5995880d+02,
     +  2.3224120d+02,  1.2378983d+02,  3.2805185d+01, -4.2512230d+01,
     + -1.0389335d+02, -1.5279487d+02, -1.9060491d+02, -2.1871159d+02,
     + -2.3850305d+02, -2.5129533d+02, -2.5811624d+02, -2.5992150d+02,
     + -2.5766685d+02, -2.5230800d+02, -2.4471523d+02, -2.3541698d+02,
     + -2.2485623d+02, -2.1347594d+02, -2.0171910d+02, -1.8997152d+02,
     + -1.7839025d+02, -1.6707520d+02, -1.5612627d+02, -1.4564334d+02,
     + -1.3570743d+02, -1.2632397d+02, -1.1747949d+02, -1.0916055d+02,
     + -1.0135369d+02, -9.4045448d+01, -8.7222370d+01, -8.0870999d+01,
     + -7.4977879d+01, -6.9529553d+01, -6.4510253d+01, -5.9894964d+01,
     + -5.5656362d+01, -5.1767121d+01, -4.8199916d+01, -4.4927421d+01,
     + -4.1922311d+01, -3.9157261d+01, -3.6604945d+01, -3.4238038d+01,
     + -3.2032412d+01, -2.9976734d+01, -2.8062867d+01, -2.6282673d+01,
     + -2.4628017d+01, -2.3090762d+01, -2.1662772d+01, -2.0335909d+01,
     + -1.9102038d+01, -1.7953022d+01, -1.6881459d+01, -1.5882886d+01,
     + -1.4953575d+01, -1.4089796d+01, -1.3287822d+01, -1.2543923d+01,
     + -1.1854372d+01, -1.1215439d+01, -1.0623397d+01, -1.0074516d+01,
     + -9.5650692d+00, -9.0913265d+00, -8.6495601d+00, -8.2360412d+00,
     + -7.8470415d+00, -7.4788323d+00, -7.1276852d+00, -6.7899487d+00,
     + -6.4637409d+00, -6.1489502d+00, -5.8455419d+00, -5.5534810d+00,
     + -5.2727330d+00, -5.0032628d+00, -4.7450358d+00, -4.4980172d+00,
     + -4.2621722d+00, -4.0374660d+00, -3.8238638d+00, -3.6213309d+00,
     + -3.4297475d+00, -3.2486542d+00, -3.0775067d+00, -2.9157607d+00,
     + -2.7628719d+00, -2.6182959d+00, -2.4814886d+00, -2.3519054d+00,
     + -2.2290022d+00, -2.1122345d+00, -2.0010582d+00, -1.8949288d+00,
     + -1.7933103d+00, -1.6958568d+00, -1.6024121d+00, -1.5128285d+00,
     + -1.4269584d+00, -1.3446539d+00, -1.2657674d+00, -1.1901510d+00,
     + -1.1176571d+00, -1.0481378d+00, -9.8144556d-01, -9.1743251d-01,
     + -8.5595093d-01, -7.9686467d-01, -7.4008381d-01, -6.8553003d-01,
     + -6.3312501d-01, -5.8279041d-01, -5.3444791d-01, -4.8801918d-01,
     + -4.4342590d-01, -4.0058972d-01, -3.5943233d-01, -3.1987540d-01,
     + -2.8184060d-01, -2.4524960d-01, -2.1002407d-01, -1.7608569d-01,
     + -1.4335612d-01, -1.1175705d-01, -8.1210133d-02, -5.1637052d-02,
     + -2.2959477d-02,  4.9009209d-03,  3.2022470d-02,  5.8483497d-02,
     +  1.5042223d+01,  1.5117812d+01  /
c  2Sigma-
      data v2sigm /
     +  3.2718036d+05,  2.6677433d+05,  2.1800331d+05,  1.7839094d+05,
     +  1.4609643d+05,  1.1991456d+05,  9.8729359d+04,  8.1671445d+04,
     +  6.7940500d+04,  5.6907352d+04,  4.8113968d+04,  4.1130012d+04,
     +  3.5606162d+04,  3.1218474d+04,  2.7760923d+04,  2.5145402d+04,
     +  2.3235984d+04,  2.1684954d+04,  2.0107527d+04,  1.8476112d+04,
     +  1.6946753d+04,  1.5514829d+04,  1.4186079d+04,  1.2958923d+04,
     +  1.1826160d+04,  1.0781229d+04,  9.8176278d+03,  8.9289825d+03,
     +  8.1089799d+03,  7.3519988d+03,  6.6531091d+03,  6.0075989d+03,
     +  5.4115059d+03,  4.8610737d+03,  4.3529606d+03,  3.8842395d+03,
     +  3.4521037d+03,  3.0541544d+03,  2.6881023d+03,  2.3518265d+03,
     +  2.0433744d+03,  1.7608918d+03,  1.5028897d+03,  1.2679705d+03,
     +  1.0547361d+03,  8.6178896d+02,  6.8780973d+02,  5.3179342d+02,
     +  3.9281359d+02,  2.6994379d+02,  1.6225757d+02,  6.8828119d+01,
     + -1.1272831d+01, -7.8973908d+01, -1.3520374d+02, -1.8089097d+02,
     + -2.1696914d+02, -2.4439161d+02, -2.6411663d+02, -2.7710247d+02,
     + -2.8430740d+02, -2.8664867d+02, -2.8487947d+02, -2.7971196d+02,
     + -2.7185833d+02, -2.6203072d+02, -2.5087782d+02, -2.3879423d+02,
     + -2.2611109d+02, -2.1315949d+02, -2.0027057d+02, -1.8772899d+02,
     + -1.7563361d+02, -1.6403683d+02, -1.5299108d+02, -1.4254875d+02,
     + -1.3274913d+02, -1.2357892d+02, -1.1501170d+02, -1.0702104d+02,
     + -9.9580528d+01, -9.2663724d+01, -8.6244208d+01, -8.0295554d+01,
     + -7.4791338d+01, -6.9705133d+01, -6.5010685d+01, -6.0682426d+01,
     + -5.6694957d+01, -5.3022880d+01, -4.9640797d+01, -4.6523310d+01,
     + -4.3645021d+01, -4.0980532d+01, -3.8504445d+01, -3.6191362d+01,
     + -3.4019133d+01, -3.1978604d+01, -3.0063870d+01, -2.8269023d+01,
     + -2.6588159d+01, -2.5015372d+01, -2.3544756d+01, -2.2170404d+01,
     + -2.0886411d+01, -1.9686872d+01, -1.8566214d+01, -1.7520205d+01,
     + -1.6544947d+01, -1.5636542d+01, -1.4791091d+01, -1.4004697d+01,
     + -1.3273460d+01, -1.2593482d+01, -1.1960867d+01, -1.1371714d+01,
     + -1.0822126d+01, -1.0308205d+01, -9.8260529d+00, -9.3717707d+00,
     + -8.9414605d+00, -8.5312241d+00, -8.1371633d+00, -7.7554688d+00,
     + -7.3843799d+00, -7.0241839d+00, -6.6752575d+00, -6.3379771d+00,
     + -6.0127193d+00, -5.6998606d+00, -5.3997775d+00, -5.1128466d+00,
     + -4.8394444d+00, -4.5799474d+00, -4.3347321d+00, -4.1041750d+00,
     + -3.8884389d+00, -3.6868305d+00, -3.4984429d+00, -3.3223692d+00,
     + -3.1577024d+00, -3.0035354d+00, -2.8589613d+00, -2.7230732d+00,
     + -2.5949639d+00, -2.4737266d+00, -2.3584543d+00, -2.2482399d+00,
     + -2.1421929d+00, -2.0397999d+00, -1.9409249d+00, -1.8454481d+00,
     + -1.7532497d+00, -1.6642101d+00, -1.5782094d+00, -1.4951281d+00,
     + -1.4148463d+00, -1.3372444d+00, -1.2622026d+00, -1.1896012d+00,
     + -1.1193204d+00, -1.0512556d+00, -9.8536170d-01, -9.2160876d-01,
     + -8.5996679d-01, -8.0040578d-01, -7.4289575d-01, -6.8740671d-01,
     + -6.3390865d-01, -5.8237160d-01, -5.3276555d-01, -4.8506051d-01,
     + -4.3922649d-01, -3.9523349d-01, -3.5305153d-01, -3.1265060d-01,
     + -2.7400072d-01, -2.3707190d-01, -2.0183413d-01, -1.6825743d-01,
     + -1.3631180d-01, -1.0596725d-01, -7.7193793d-02, -4.9961426d-02,
     +  1.5042223d+01,  1.5117812d+01  /
c  4Sigma-
      data v4sigm /
     +  3.2436364d+05,  2.6400121d+05,  2.1530095d+05,  1.7577583d+05,
     +  1.4357664d+05,  1.1749200d+05,  9.6400689d+04,  7.9431219d+04,
     +  6.5781602d+04,  5.4812719d+04,  4.6048317d+04,  3.9046080d+04,
     +  3.3471114d+04,  2.9015751d+04,  2.5380850d+04,  2.2275794d+04,
     +  1.9467899d+04,  1.6954721d+04,  1.4786269d+04,  1.2899292d+04,
     +  1.1209160d+04,  9.7155933d+03,  8.3970137d+03,  7.2334364d+03,
     +  6.2092697d+03,  5.3091345d+03,  4.5182772d+03,  3.8244146d+03,
     +  3.2159400d+03,  2.6825984d+03,  2.2154863d+03,  1.8061561d+03,
     +  1.4477464d+03,  1.1338299d+03,  8.5884725d+02,  6.1810632d+02,
     +  4.0718506d+02,  2.2259056d+02,  6.1079862d+01, -8.0183310d+01,
     + -2.0362853d+02, -3.1147132d+02, -4.0514164d+02, -4.8587305d+02,
     + -5.5489913d+02, -6.1345345d+02, -6.6264020d+02, -7.0304600d+02,
     + -7.3512808d+02, -7.5934366d+02, -7.7614998d+02, -7.8600671d+02,
     + -7.8938334d+02, -7.8675179d+02, -7.7858397d+02, -7.6535183d+02,
     + -7.4755170d+02, -7.2577766d+02, -7.0064823d+02, -6.7278191d+02,
     + -6.4279721d+02, -6.1128655d+02, -5.7873807d+02, -5.4561382d+02,
     + -5.1237583d+02, -4.7948616d+02, -4.4736032d+02, -4.1622764d+02,
     + -3.8627092d+02, -3.5767295d+02, -3.3061654d+02, -3.0524458d+02,
     + -2.8154045d+02, -2.5944760d+02, -2.3890951d+02, -2.1986965d+02,
     + -2.0226799d+02, -1.8603046d+02, -1.7107952d+02, -1.5733760d+02,
     + -1.4472715d+02, -1.3317061d+02, -1.2259041d+02, -1.1290901d+02,
     + -1.0404884d+02, -9.5932348d+01, -8.8487853d+01, -8.1667202d+01,
     + -7.5428121d+01, -6.9728336d+01, -6.4525573d+01, -5.9777558d+01,
     + -5.5442017d+01, -5.1476676d+01, -4.7839263d+01, -4.4487501d+01,
     + -4.1383927d+01, -3.8510308d+01, -3.5853220d+01, -3.3399240d+01,
     + -3.1134943d+01, -2.9046906d+01, -2.7121706d+01, -2.5345917d+01,
     + -2.3706117d+01, -2.2188882d+01, -2.0782059d+01, -1.9478578d+01,
     + -1.8272642d+01, -1.7158452d+01, -1.6130211d+01, -1.5182118d+01,
     + -1.4308378d+01, -1.3503191d+01, -1.2760758d+01, -1.2075283d+01,
     + -1.1440966d+01, -1.0852010d+01, -1.0302615d+01, -9.7869845d+00,
     + -9.2993194d+00, -8.8338216d+00, -8.3846930d+00, -7.9462887d+00,
     + -7.5164963d+00, -7.0967352d+00, -6.6885784d+00, -6.2935989d+00,
     + -5.9133697d+00, -5.5494640d+00, -5.2034547d+00, -4.8769149d+00,
     + -4.5714175d+00, -4.2885356d+00, -4.0298423d+00, -3.7969106d+00,
     + -3.5905875d+00, -3.4088164d+00, -3.2488146d+00, -3.1077994d+00,
     + -2.9829883d+00, -2.8715986d+00, -2.7708477d+00, -2.6779528d+00,
     + -2.5901315d+00, -2.5046009d+00, -2.4185786d+00, -2.3292817d+00,
     + -2.2340135d+00, -2.1320486d+00, -2.0246333d+00, -1.9130995d+00,
     + -1.7987792d+00, -1.6830043d+00, -1.5671070d+00, -1.4524191d+00,
     + -1.3402727d+00, -1.2319996d+00, -1.1289320d+00, -1.0324017d+00,
     + -9.4374078d-01, -8.6394963d-01, -7.9270236d-01, -7.2934153d-01,
     + -6.7320970d-01, -6.2364942d-01, -5.8000323d-01, -5.4161370d-01,
     + -5.0782337d-01, -4.7797481d-01, -4.5141055d-01, -4.2747315d-01,
     + -4.0550518d-01, -3.8484917d-01, -3.6484769d-01, -3.4484328d-01,
     + -3.2417850d-01, -3.0219590d-01, -2.7823804d-01, -2.5164746d-01,
     + -2.2176673d-01, -1.8793838d-01, -1.4950499d-01, -1.0580909d-01,
     +  1.5042223d+01,  1.5117812d+01  /
*
*  set vv0 term to zero
      vv0 = 0.d0
*
*  spline fits
      if (ifirst .eq. 0) then
*  spline fit of the coefficients for the PE curves
*  evaluate derivative at first point
        der1=(v2pi(2)-v2pi(1))/(rr(2)-rr(1))
        call dspline(rr,v2pi,npts,der1,0d0,cs2p)
*
        der1=(v4pi(2)-v4pi(1))/(rr(2)-rr(1))
        call dspline(rr,v4pi,npts,der1,0d0,cs4p)
*
        der1=(v2sigm(2)-v2sigm(1))/(rr(2)-rr(1))
        call dspline(rr,v2sigm,npts,der1,0d0,cs2s)
*
        der1=(v4sigm(2)-v4sigm(1))/(rr(2)-rr(1))
        call dspline(rr,v4sigm,npts,der1,0d0,cs4s)
        ifirst = 1
      endif
*
*  determine splined coefficients for PE curves at r=R
      call dsplint(rr,v2pi,cs2p,npts,r,vvx)
      v(1) = vvx
*  fix long-range behavior of PE curve as c6/r^6 from last point
      if (r.gt.rr(npts)) then
        c6 = v2pi(npts) * rr(npts)**6
        v(1) = c6 / r**6
      endif
*
      call dsplint(rr,v4pi,cs4p,npts,r,vvx)
      v(2) = vvx
*  fix long-range behavior of PE curve as c6/r^6 from last point
      if (r.gt.rr(npts)) then
        c6 = v4pi(npts) * rr(npts)**6
        v(2) = c6 / r**6
      endif
*
      call dsplint(rr,v2sigm,cs2s,npts,r,vvx)
      v(3) = vvx
*  fix long-range behavior of PE curve as c6/r^6 from last point
      if (r.gt.rr(npts)) then
        c6 = v2sigm(npts) * rr(npts)**6
        v(3) = c6 / r**6
      endif
*
      call dsplint(rr,v4sigm,cs4s,npts,r,vvx)
      v(4) = vvx
*  fix long-range behavior of PE curve as c6/r^6 from last point
      if (r.gt.rr(npts)) then
        c6 = v4sigm(npts) * rr(npts)**6
        v(4) = c6 / r**6
      endif
*
*  IN THIS VERSION, SET SPIN-ORBIT MATRIX ELEMENTS TO THEIR
*  ASYMPTOTIC VALUES AT ALL R
      a = 382.4d0
      apar = a / 2.0d0
      aperp = a / 2.0d0
      v(5) = apar
      v(6) = aperp
*
      call dcopy(6,v,1,vvl,1)
* convert to hartree
      econv=1.d0/219474.6d0
      call dscal(6,econv,vvl,1)
      return
      end
*===================================eof====================================
