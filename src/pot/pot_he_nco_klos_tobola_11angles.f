* System:  NCO(X 2Pi)+He, original ab initio RCCSD(T) PES's
* Reference:
* J. Klos, R. Tobola and G. Chalasinski 
* J. Phys. Chem. A,  113, 14480 (2009) 
* "Vincenzo Aquilanti Festschrift"


      subroutine driver
      implicit double precision (a-h,o-z)
      common /cosysr/ xjunk(2),rshift,xfact
      common /covvl/ vvl(19)
      include "common/parpot"
      potnam='Klos et al He-NCO(X) RCCSDT PES'
      print *, potnam
1      print *, ' r (bohr)'
      rshift=0.5
      xfact=0.8
      read (5, *, end=99) r
      call pot(vv0,r)
      write (6, 100) vv0,vvl
100   format(' vsum',/,7(1pe16.8),/,
     :    '  vdif',/,5e16.8)
      goto 1
99    end

      include "common/syusr"
      include "common/bausr"
      include "common/ground"
      subroutine loapot(iunit,filnam)
* ------------------------------------------------------------------------
      character*(*) filnam
      include "common/parbas"
      include "common/parpot"
      potnam='Klos et al He-NCO(X) RCCSDT PES'
** ccsdt potential using avtz+33221 basis  for 7 angles **
      lammin(1)=1
      lammax(1)=10
      lammin(2)=2
      lammax(2)=10
      mproj(1)=0
      mproj(2)=2
      ntv(1)=1
      ivcol(1,1)=0
      ivrow(1,1)=0
      return
      end
* ----------------------------------------------------------------------
      subroutine pot (vv0, r)
*  subroutine to calculate the r-dependent coefficients
*  in atomic units (distance and energy)
* ----------------------------------------------------------------------
*  on entry:
*    r:      interparticle distance
*  on return:
*  vv0        contains isotropic term (d00 term in vsum)
*  variable in common block /covvl/
*    vvl:     vector of length 6 to store r-dependence of each term
*             in potential expansion
*    vvl(1-10) expansion coefficients in dl0 (l=1:10) of vsum
*    vvl(11-19) expansion coefficients in dl2 (l=2:10) of vdif

* uses linear least squares routines from cmlib

* author:  millard alexander
* latest revision date:  8-oct-1993
* revised for He-NO(X) : 1-20-95 by Moonbong Yang
* revised for RCCSD(T) PES: 2005.02.10 by Jacek Klos
* 0 degree for He-NCO and 180 for He-OCN
* ----------------------------------------------------------------------

      implicit double precision (a-h,o-z)
      dimension xlam1(22),xlam2(22),r0(22),c1(22),c2(22),c3(22),
     :          clr(22),vsum(11),xsum(11),vdif(11),xdif(11),
     :          ddif(11),
     :          d0(121),d2(81),aa(121),thta(11),cthta(11)
      dimension kpvt(11),qraux(11),work(200),rsd(11),re(22)

      common /covvl/ vvl(19)
      data half, zero, one, alph /0.5d0, 0.d0, 1.d0, 1.2d0/
* for distances beyond rmax difference potential is damped
      data rmax /20d0/
* coefficicients for d0 rotation matrices
* stored (by column) for each of 7 angles and for l=0:6
* angles are  0 20 40 60 80 90 100 120 140 160 180
      data d0/
     :  1.d0,!l=0
     :  1.d0,
     :  1.d0,
     :  1.d0,
     :  1.d0,
     :  1.d0,
     :  1.d0,
     :  1.d0,
     :  1.d0,
     :  1.d0,
     :  1.d0,!l=0
     :                    1.d0, !l=1
     :    0.939692620785908d0,
     :    0.766044443118978d0,
     :                  0.5d0,
     :     0.17364817766693d0,
     :                  1d-16,
     :    -0.17364817766693d0,
     :                 -0.5d0,
     :   -0.766044443118978d0,
     :   -0.939692620785908d0,
     :                   -1d0, !l=1
     :                    1d0, !l=2
     :    0.824533332339233d0,
     :    0.380236133250197d0,
     :               -0.125d0,
     :   -0.454769465589431d0,
     :                 -0.5d0,
     :   -0.454769465589431d0,
     :               -0.125d0,
     :    0.380236133250197d0,
     :    0.824533332339233d0,
     :                    1d0, !l=2
     :                    1d0, !l=3
     :    0.664884732794716d0,
     :  -0.0252333338303835d0,
     :              -0.4375d0,
     :   -0.247381933374901d0,
     :                  1d-16,
     :    0.247381933374901d0,
     :               0.4375d0,
     :   0.0252333338303835d0,
     :   -0.664884732794716d0,
     :                   -1d0, !l=3
     : 1d0,                   !l=4
     :    0.474977735636283d0,
     :   -0.319004346471378d0,
     :           -0.2890625d0,
     :    0.265901610835095d0,
     :                0.375d0,
     :    0.265901610835095d0,
     :           -0.2890625d0,
     :   -0.319004346471378d0,
     :    0.474977735636283d0,
     :                    1d0,!l=4
     :  1.d0,                 !l=5
     :    0.271491745551255d0,
     :   -0.419682045437054d0,
     :           0.08984375d0,
     :    0.281017540988309d0,
     :                  1d-16,
     :   -0.281017540988309d0,
     :          -0.08984375d0,
     :    0.419682045437054d0,
     :   -0.271491745551255d0,
     :                   -1d0,!l=5
     :                   1.d0,!l=6
     :   0.0719030017842305d0,
     :   -0.323570725710931d0,
     :         0.3232421875d0,
     :   -0.132121338573299d0,
     :              -0.3125d0,
     :   -0.132121338573299d0,
     :         0.3232421875d0,
     :   -0.323570725710931d0,
     :   0.0719030017842305d0,
     :                    1d0, !l=6
     :                    1d0, !l=7
     :   -0.107226158692938d0,
     :   -0.100601708629502d0,
     :        0.22314453125d0,
     :   -0.283479918813435d0,
     :                  1d-16,
     :    0.283479918813435d0,
     :       -0.22314453125d0,
     :    0.100601708629502d0,
     :    0.107226158692938d0,
     :                   -1d0,!l=7
     :                    1d0,!l=8
     :   -0.251839432959275d0,
     :    0.138626797752243d0,
     :   -0.073638916015625d0,
     :   0.0233078500507821d0,
     :            0.2734375d0,
     :   0.0233078500507821d0,
     :   -0.073638916015625d0,
     :    0.138626797752243d0,
     :   -0.251839432959275d0,
     :                    1d0,!l=8
     :                    1d0, !l=9
     :   -0.351696543958561d0,
     :    0.290012951832139d0,
     :   -0.267898559570312d0,
     :    0.259627174131175d0,
     :                  1d-16,
     :   -0.259627174131175d0,
     :    0.267898559570312d0,
     :   -0.290012951832139d0,
     :    0.351696543958561d0,
     :                   -1d0, !l=9
     :                    1d0, !l=10
     :   -0.401269139852809d0,
     :    0.297345221371711d0,
     :   -0.188228607177734d0,
     :   0.0646821277096134d0,
     :          -0.24609375d0,
     :   0.0646821277096134d0,
     :   -0.188228607177734d0,
     :    0.297345221371711d0,
     :   -0.401269139852809d0,
     :                    1d0/!l=10
     
* coefficicients for d2 rotation matrices
* stored (by column) for each of 5 angles and for l=2:6
* angles are 20 40 60 80 90 100 120 140 160  
      data d2/
     :   0.0716339671058987d0,!l=2
     :    0.25301753909188d0,
     :    0.459279326771846d0,
     :    0.593907147345913d0,
     :    0.612372435695794d0,
     :    0.593907147345913d0,
     :    0.459279326771846d0,
     :    0.25301753909188d0,
     :    0.0716339671058987d0, !l=2
     :   0.150518479233129d0, !l=3
     :    0.433400687687707d0,
     :    0.513489897661093d0,
     :    0.230607689206516d0,
     :                  1d-16,
     :   -0.230607689206516d0,
     :   -0.513489897661093d0,
     :   -0.433400687687707d0,
     :   -0.150518479233129d0, !l=3
     :    0.239574181663041d0, !l=4
     :    0.507567357301874d0,
     :    0.222347647980589d0,
     :   -0.302446243003737d0,
     :   -0.395284707521047d0,
     :   -0.302446243003737d0,
     :    0.222347647980589d0,
     :    0.507567357301874d0,
     :    0.239574181663041d0, !l=4      
     :    0.328357589465018d0, !l=5
     :    0.436005533330449d0,
     :   -0.169820821244407d0,
     :   -0.277468765109838d0,
     :                  1d-16,
     :    0.277468765109838d0,
     :    0.169820821244407d0,
     :   -0.436005533330449d0,
     :   -0.328357589465018d0, !l=5  
     :    0.405921793012549d0, !l=6
     :    0.238300278063999d0,
     :   -0.345234181079693d0,
     :    0.151317563585355d0,
     :    0.320217211436238d0,
     :    0.151317563585355d0,
     :   -0.345234181079693d0,
     :    0.238300278063999d0,
     :    0.405921793012549d0, !l=6
     :     0.46231022215767d0, !l=7
     :  -0.0139065397386551d0,
     :   -0.191313584921252d0,
     :    0.284903176975073d0,
     :                  1d-16,
     :   -0.284903176975073d0,
     :    0.191313584921252d0,
     :   0.0139065397386551d0,
     :    -0.46231022215767d0, !l=7
     :    0.489730532881397d0, !l=8
     :   -0.227003593559681d0,
     :     0.11374298899392d0,
     :  -0.0352409613338776d0,
     :   -0.277316239832795d0,
     :  -0.0352409613338776d0,
     :     0.11374298899392d0,
     :   -0.227003593559681d0,
     :    0.489730532881397d0, !l=8
     :     0.48345441474116d0, !l=9
     :    -0.32461587132088d0,
     :    0.279058005816313d0,
     :   -0.263349502692564d0,
     :                  1d-16,
     :    0.263349502692564d0,
     :   -0.279058005816313d0,
     :     0.32461587132088d0,
     :    -0.48345441474116d0, !l=9
     :    0.442368089279743d0, !l=10
     :   -0.278913706604953d0,
     :    0.168704562081535d0,
     :   -0.057117496039293d0,
     :     0.24836194310956d0,
     :   -0.057117496039293d0,
     :    0.168704562081535d0,
     :   -0.278913706604953d0,
     :    0.442368089279743d0/!l=10


      thta(1)=0.D0
      thta(2)=20.D0
      thta(3)=40.D0
      thta(4)=60.D0
      thta(5)=80.D0
      thta(6)=90.D0
      thta(7)=100.D0
      thta(8)=120.D0
      thta(9)=140.D0
      thta(10)=160.D0
      thta(11)=180.D0

      do i=1,11
      cthta(i)=dcos(thta(i)*dacos(-1.D0)/180.D0)
      enddo
* determine A' and A" potentials at angles
      do 100 i=1,11
        vsum(i)=0.5D0*(vaprimi(r,i)+vabisi(r,i))
* don't compute vdif for colinear geometries
        if (i.ne.1 .and. i.ne.11) then
         r=rdif
         if(r.le.5.d0) then
          rdif=5.d0
         endif
          vdif(i-1)=0.5d0*(-vaprimi(rdif,i)+vabisi(rdif,i))
* for long range damp out difference potential

          if (r .gt. rmax) then
            damp=-half*(tanh(3.d0*(r-rmax))-one)
            vdif(i-1)=vdif(i-1)*damp
          endif
        endif
100   continue
* solve simultaneous equations for solutions
* first for vsigma
      tol=1.e-10
       lsum=11
       ldif=9
*      lsum=9
*      ldif=7
      call dscal(19,zero,vvl,1)
      call dcopy(121,d0,1,aa,1)
      call dqrank(aa,11,11,lsum,tol,kr,kpvt,qraux,work)
      call dqrlss(aa,11,11,lsum,kr,vsum,xsum,rsd,kpvt,qraux)
* convert to hartree
      conv=1.d0/219474.6
      call dscal(11,conv,xsum,1)
      vv0=xsum(1)
      call dcopy(lsum-1,xsum(2),1,vvl,1)
      call dcopy(81,d2,1,aa,1)
      call dqrank(aa,9,9,ldif,tol,kr,kpvt,qraux,work)
      call dqrlss(aa,9,9,ldif,kr,vdif,xdif,rsd,kpvt,qraux)
      call dscal(9,conv,xdif,1)
      call dcopy(ldif,xdif,1,vvl(11),1)
      end



      FUNCTION VAPRIMI(R,N)
CSYSTEM: NCO-HE Aprim state Theta=0 for He---NCO
CLEVEL:RHF/RCCSD(T)/aug-cc-pvtz+33221
C units R=au E=microEh
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      DIMENSION XX(18),XX1(18),XX2(18),XX3(18),
     * XX4(18),XX5(18),XX6(18),XX7(18),
     * XX8(18),XX9(18),XX10(18),XX11(18)
C theta=0
      DATA XX1/
     *    .998770483091502181D+00,
     *    .179910919994911889D+01,
     *    .325774699017396927D+10,
     *   -.156981812467018056D+10,
     *    .289051545475659966D+09,
     *   -.207382047545861900D+08,
     *   -.666445265703525394D+06,
     *    .232592642436168069D+06,
     *   -.175776874324766577D+05,
     *    .608787739801472526D+03,
     *   -.838703105609900668D+01,
     *   -.681549579529956100D+05,
     *    .239661648048323113D+07,
     *    .463761472331158042D+09,
     *   -.131695454779947174D+12,
     *    .574163145346422852D+13,
     *   -.511120024608208125D+14,
     *    .123565106038891922D+15/
C theta=20
      DATA XX2/
     *    .229814524135897580D+01,
     *   -.867500696680699157D+01,
     *    .293463509617317247D+10,
     *   -.327006095266789007D+10,
     *    .162332433919242001D+10,
     *   -.464610315313482404D+09,
     *    .836393707198252678D+08,
     *   -.968861368617127091D+07,
     *    .705992374731881195D+06,
     *   -.296624803461285956D+05,
     *    .553974041802582633D+03,
     *    .253055840830723319D+05,
     *    .131832083948448976D+07,
     *    .437405426615410864D+09,
     *    .347241415323572000D+07,
     *    .424459027530016541D+12,
     *   -.135848092579499863D+14,
     *    .109196458311774312D+15/
C theta=40
      DATA XX3/       
     *    .221302245512960027D+01,
     *   -.566386876397455108D+01,
     *    .217678746401806593D+10,
     *   -.242939570219775486D+10,
     *    .121900354760883021D+10,
     *   -.354610540266982317D+09,
     *    .652050888061294258D+08,
     *   -.774518577376895957D+07,
     *    .580905252628455521D+06,
     *   -.252255219068083352D+05,
     *    .490018834128236222D+03,
     *    .253055840830723319D+05,
     *    .876767959573707171D+07, 
     *    .239065410444218695D+09, 
     *    .814323742690364647D+10,
     *   -.254555491921336975D+12,
     *    .199728150058418506D+13,
     *   -.353775143950344324D+10/
C theta=60
      DATA XX4/       
     *    .219821907247559478D+01,
     *   -.349909456919833195D+01,
     *    .211750148018905902D+10,
     *   -.248343768244976759D+10,
     *    .133986157288578343D+10,
     *   -.423828662804973066D+09,
     *    .853399730997917801D+08,
     *   -.111401280374152176D+08,
     *    .919363597502661403D+06,
     *   -.438755135962071072D+05,
     *    .933362168552286903D+03,
     *    .253055840830723319D+05,
     *    .131711667160814870D+08,  
     *    .904666313624031991D+08,
     *    .267817038103611994D+10,
     *   -.888698871317812347D+11,
     *    .816042505049246582D+12,
     *   -.119952483010496021D+13/
C theta=80
      DATA XX5/       
     *    .161442579437595080D+01,
     *    .245812323422420809D+01,
     *    .431455446323346138D+10,
     *   -.382293345377700281D+10,
     *    .168609185204135466D+10,
     *   -.448843633490266025D+09,
     *    .770716168318168074D+08,
     *   -.864844981781141087D+07,
     *    .619340031085454393D+06,
     *   -.259736795974027700D+05,
     *    .497410229981267548D+03,
     *    .253055840830723319D+05,
     *    .152089774153950531D+08,
     *    .121300652628690097D+08,
     *   -.176122913917214203D+10,
     *    .380236549700596161D+11,
     *   -.124223274743271164D+12,
     *    .116956678864384109D+12/
C theta=90
      DATA XX6/       
     *    .165573280097728648D+01,
     *    .153810840082153355D+01,
     *    .353856367328781843D+10,
     *   -.340748762904868078D+10,
     *    .158494118386526608D+10,
     *   -.439440776027943313D+09,
     *    .781130525283753276D+08,
     *   -.904080303152488545D+07,
     *    .665059481286412105D+06,
     *   -.284917824126146370D+05,
     *    .551642858414975649D+03,
     *    .253055840830723319D+05,
     *    .153055338591134623D+08, 
     *    .123220322518156073D+07,
     *   -.234699699564782763D+10,
     *    .499520408138049927D+11,
     *   -.155025690844323578D+12,
     *    .138294907121072479D+12/
C theta=100
      DATA XX7/       
     *    .159793771212150015D+01,
     *    .186608831958335375D+01,
     *    .411528725522521353D+10,
     *   -.378990055726368332D+10,
     *    .169372239909935856D+10,
     *   -.452689186828447998D+09,
     *    .776584259991404116D+08,
     *   -.867146868699470907D+07,
     *    .614784124921399285D+06,
     *   -.253516520011797438D+05,
     *    .472114439550210363D+03,
     *    .253055840830723319D+05,
     *    .152727554317554329D+08,
     *    .208202396741177747D+07,
     *   -.269854220063008833D+10,
     *    .591157384578910065D+11,
     *   -.190905904222615753D+12,
     *    .177579601360412018D+12/
C theta=120
      DATA XX8/       
     *    .203116551041192173D+01,
     *   -.146046081953109486D+01,
     *    .222894077951564980D+10,
     *   -.260027635181476212D+10,
     *    .138804514971583700D+10,
     *   -.431225287678965211D+09,
     *    .848797875686660558D+08,
     *   -.107991330201997757D+08,
     *    .865329419932959834D+06,
     *   -.398921722327100288D+05,
     *    .812086048771230821D+03,
     *    .253055840830723319D+05,
     *    .143312890218816996D+08, 
     *    .421540310385706797D+08,
     *    .345137818044368923D+09,
     *   -.137402682475395432D+11,
     *    .150706107811185669D+12,
     *   -.233551103082180420D+12/
C theta=140
      DATA XX9/
     *    .176490588236002299D+01,
     *   -.182249671615729070D+01,
     *    .589633798051564598D+10,
     *   -.523580568968622112D+10,
     *    .216646757348191452D+10,
     *   -.528477485412136972D+09,
     *    .824348094152917713D+08,
     *   -.838668598971352912D+07,
     *    .543973826873976039D+06,
     *   -.206224641809231689D+05,
     *    .354204243231858243D+03,
     *    .253055840830723319D+05,
     *    .116038473107209075D+08, 
     *    .132242798555513844D+09,
     *    .136945921901296978D+11,
     *   -.527805303354887207D+12,
     *    .574285375788904590D+13,
     *   -.107963588401841582D+14/
C theta=160
      DATA XX10/
     *    .221505046042373888D+01,
     *   -.524189719002839194D+01,
     *    .259226928789270306D+10,
     *   -.288874904415566921D+10,
     *    .148132236433914089D+10,
     *   -.446006218577784002D+09,
     *    .857227660478331298D+08,
     *   -.107157340103484895D+08,
     *    .848929625573439174D+06,
     *   -.389645061049057185D+05,
     *    .798609075656831351D+03,
     *    .253055840830723319D+05,
     *    .755360360118203610D+07,
     *    .242190981370900810D+09,
     *    .105278628647694054D+11,
     *   -.319781020391498291D+12,
     *    .245049504176874707D+13,
     *   -.100632712219452419D+11/
C theta=180
      DATA XX11/
     *    .100803139202837477D+01,
     *    .391302845102582397D+01,
     *    .305648250422098618D+11,
     *   -.191118805235443916D+11,
     *    .513393021507887936D+10,
     *   -.767668194684068203D+09,
     *    .689405661535420716D+08,
     *   -.371663095611223252D+07,
     *    .111391282381363693D+06,
     *   -.143507098721165562D+04,
     *    .123502763414518810D-01,
     *   -.681549579529956100D+05,
     *    .824990990163109824D+07,
     *    .257103262849254906D+09,
     *   -.131695454779947174D+12,
     *    .574163145346422852D+13,
     *   -.511120024608208125D+14,
     *    .123565106038891922D+15/


      IF(N.EQ.1) THEN
      DO I=1,18
      XX(I)=XX1(I)
      ENDDO
      ENDIF
      IF(N.EQ.2) THEN
      DO I=1,18
      XX(I)=XX2(I)
      ENDDO
      ENDIF
      IF(N.EQ.3) THEN
      DO I=1,18
      XX(I)=XX3(I)
      ENDDO
      ENDIF
      IF(N.EQ.4) THEN
      DO I=1,18
      XX(I)=XX4(I)
      ENDDO
      ENDIF
      IF(N.EQ.5) THEN
      DO I=1,18
      XX(I)=XX5(I)
      ENDDO
      ENDIF
      IF(N.EQ.6) THEN
      DO I=1,18
      XX(I)=XX6(I)
      ENDDO
      ENDIF
      IF(N.EQ.7) THEN
      DO I=1,18
      XX(I)=XX7(I)
      ENDDO
      ENDIF
      IF(N.EQ.8) THEN
      DO I=1,18
      XX(I)=XX8(I)
      ENDDO
      ENDIF
      IF(N.EQ.9) THEN
      DO I=1,18
      XX(I)=XX9(I)
      ENDDO
      ENDIF
      IF(N.EQ.10) THEN
      DO I=1,18
      XX(I)=XX10(I)
      ENDDO
      ENDIF
      IF(N.EQ.11) THEN
      DO I=1,18
      XX(I)=XX11(I)
      ENDDO
      ENDIF



      TERM1 = DEXP(-XX(1)*R-XX(2))
      TERM2 = XX(3) + XX(4)*R+XX(5)*R**2+
     *        XX(6)*R**3+XX(7)*R**4+XX(8)*R**5
     *        +XX(9)*R**6+XX(10)*R**7+XX(11)*R**8
      TERM3=0.5D0*
     *   (1.D0+ DTANH(1.D0+XX(12)*R))
      TERM4 = XX(13)/(R**6)+XX(14)/(R**7)
     *        +XX(15)/(R**8)+XX(16)/(R**9)
     *        +XX(17)/(R**10)+XX(18)/(R**11)
       TOCM=0.219474643545745D0
       VAPRIMI = (TERM1*TERM2-TERM3*TERM4)*TOCM
       RETURN
       END


      FUNCTION VABISI(R,N)
CSYSTEM: NCO-HE Abis state Theta=0 for He---NCO
CLEVEL:RHF/RCCSD(T)/aug-cc-pvtz+33221
C units R=au E=microEh
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      DIMENSION XX(18),XX1(18),XX2(18),XX3(18),
     * XX4(18),XX5(18),XX6(18),XX7(18),
     * XX8(18),XX9(18),XX10(18),XX11(18)
C theta=0
      DATA XX1/
     *    .998770483091502181D+00,
     *    .179910919994911889D+01,
     *    .325774699017396927D+10,
     *   -.156981812467018056D+10,
     *    .289051545475659966D+09,
     *   -.207382047545861900D+08,
     *   -.666445265703525394D+06,
     *    .232592642436168069D+06,
     *   -.175776874324766577D+05,
     *    .608787739801472526D+03,
     *   -.838703105609900668D+01,
     *   -.681549579529956100D+05,
     *    .239661648048323113D+07,
     *    .463761472331158042D+09,
     *   -.131695454779947174D+12,
     *    .574163145346422852D+13,
     *   -.511120024608208125D+14,
     *    .123565106038891922D+15/
C theta=20
      DATA XX2/
     *    .217022053864125786D+01,
     *   -.615593508655212851D+01,
     *    .295293048689766026D+10,
     *   -.331239373080933046D+10,
     *    .166830147787696648D+10,
     *   -.485448718108572662D+09,
     *    .889329820289968550D+08,
     *   -.104780373575163130D+08,
     *    .775681041514374549D+06,
     *   -.330709904838399598D+05,
     *    .627014350995264181D+03,
     *    .253055840830723319D+05,
     *    .719339183094961336D+06, 
     *    .449827714256305099D+09,
     *    .214024664106940422D+11,
     *   -.677232093127510010D+12,
     *    .538612567881167480D+13,
     *   -.304801637129676704D+11/
C theta=40
      DATA XX3/       
     *    .226973975926551974D+01,
     *   -.607520891025826693D+01,
     *    .248071911948158836D+10,
     *   -.286671739654077721D+10,
     *    .149284116954613853D+10,
     *   -.451183116006188571D+09,
     *    .862177949218269438D+08,
     *   -.106416896316515878D+08,
     *    .829115004325470305D+06,
     *   -.373778322108204957D+05,
     *    .752961680368166299D+03,
     *    .253055840830723319D+05,
     *    .720792729238054249D+07,
     *    .269990591580648065D+09,
     *    .110069123096481857D+11,
     *   -.342508358183136597D+12,
     *    .267152787103630127D+13,
     *   -.657099435122567654D+09/
C theta=60
      DATA XX4/       
     *    .224991741965404835D+01,
     *   -.402938686812120839D+01,
     *    .217103556562641430D+10,
     *   -.251925023660434628D+10,
     *    .134898643985404634D+10,
     *   -.424330818484310210D+09,
     *    .851639800494772941D+08,
     *   -.111109598442961350D+08,
     *    .920031829856512137D+06,
     *   -.442792891827743661D+05,
     *    .957832342549048690D+03,
     *    .253055840830723319D+05,
     *    .113481026179513671D+08, 
     *    .124624250365164727D+09,
     *    .474116597320412445D+10,
     *   -.151543125677945343D+12,
     *    .134170800129891113D+13,
     *   -.194620622711215576D+13/
C theta=80
      DATA XX5/       
     *    .137242517310886392D+01,
     *    .475024036044931197D+01,
     *    .775960601244819927D+10,
     *   -.540898172051730061D+10,
     *    .193511699855895185D+10,
     *   -.436196307945261896D+09,
     *    .648570778682310209D+08,
     *   -.633145023198081274D+07,
     *    .390690124348762154D+06,
     *   -.138374650955524994D+05,
     *    .216527015423983528D+03,
     *    .253055840830723319D+05,
     *    .141257168965259138D+08, 
     *    .319900560220527016D+08,
     *   -.527971214169704318D+09,
     *    .132255389796450882D+11,
     *   -.470437301082991486D+11,
     *    .473329901887621994D+11/
C theta=90
      DATA XX6/       
     *    .174303808766836332D+01,
     *    .288697521259445322D+01,
     *    .367825277681353855D+10,
     *   -.332370527171678495D+10,
     *    .157282924233194780D+10,
     *   -.448051568345764995D+09,
     *    .818580653265343308D+08,
     *   -.980770249079364911D+07,
     *    .759067786909587099D+06,
     *   -.350108909497549685D+05,
     *    .749718750333569346D+03,
     *    .253055840830723319D+05,
     *    .145840905869741607D+08,
     *    .143856634175803550D+08,
     *   -.472972037246733546D+09,
     *    .967329891227369499D+10,
     *   -.288404093195414047D+11,
     *    .242888519372732010D+11/
C theta=100
      DATA XX7/       
     *    .912409292332526878D+00,
     *    .583511422937951085D+01,
     *    .136976663915569878D+11,
     *   -.925778344563657570D+10,
     *    .291554364436469984D+10,
     *   -.539815333043819427D+09,
     *    .636624196572678909D+08,
     *   -.486457950486190058D+07,
     *    .234745507988666563D+06,
     *   -.653775360872230794D+04,
     *    .810528621609291378D+02,
     *    .253055840830723319D+05,
     *    .147121794758431073D+08, 
     *    .117296807888622507D+08,
     *    .328121077411264954D+11,
     *   -.215061219119412079D+12,
     *    .500653678294358215D+12,
     *   -.409077512806395935D+12/
C theta=120
      DATA XX8/       
     *    .177078627948196043D+01,
     *    .405119229336208075D+01,
     *   -.229434521117911482D+10,
     *    .241872861158529711D+10,
     *   -.392375335501920581D+09,
     *   -.490641041147079691D+07,
     *    .468963143914513197D+07,
     *   -.272455213299912633D+06,
     *    .740914814927371390D+04,
     *   -.167485052594039257D+04,
     *    .961036980567728563D+02,
     *    .253055840830723319D+05,
     *    .136963850779715013D+08,
     *    .520131650738697946D+08,
     *    .135303300145440131D+09,
     *   -.216547431501866722D+10,
     *    .335049106426711464D+10,
     *    .168009834334725601D+06/
C theta=140
      DATA XX9/
     *    .227177576328276576D+01,
     *   -.528851155433272169D+01,
     *    .219157092407516766D+10,
     *   -.258298306767386532D+10,
     *    .136919634103833747D+10,
     *   -.420370257069642961D+09,
     *    .814377977182918340D+08,
     *   -.101650210051825494D+08,
     *    .797961644080892554D+06,
     *   -.360626013537094113D+05,
     *    .722759478668124757D+03,
     *    .253055840830723319D+05,
     *    .109195542601985801D+08,
     *    .143128568928877741D+09,
     *    .435278057896627331D+10,
     *   -.130299449689982956D+12,
     *    .983153959506331909D+12,
     *   -.106792335662810969D+10/
C theta=160
      DATA XX10/
     *    .219422160421123946D+01,
     *   -.529491034481006473D+01,
     *    .261897431045435429D+10,
     *   -.292579303012569094D+10,
     *    .148504461673730326D+10,
     *   -.439084146440837979D+09,
     *    .824014442332998663D+08,
     *   -.100211042411991339D+08,
     *    .770680899372815620D+06,
     *   -.342995426170384017D+05,
     *    .680972868617401332D+03,
     *    .253055840830723319D+05,
     *    .724816394331089221D+07,
     *    .247268407623279750D+09,
     *    .101673984821910686D+11,
     *   -.312784876609265076D+12,
     *    .247438081503185791D+13,
     *   -.700834130702098022D+12/
C theta=180
      DATA XX11/
     *    .100803139202837477D+01,
     *    .391302845102582397D+01,
     *    .305648250422098618D+11,
     *   -.191118805235443916D+11,
     *    .513393021507887936D+10,
     *   -.767668194684068203D+09,
     *    .689405661535420716D+08,
     *   -.371663095611223252D+07,
     *    .111391282381363693D+06,
     *   -.143507098721165562D+04,
     *    .123502763414518810D-01,
     *   -.681549579529956100D+05,
     *    .824990990163109824D+07,
     *    .257103262849254906D+09,
     *   -.131695454779947174D+12,
     *    .574163145346422852D+13,
     *   -.511120024608208125D+14,
     *    .123565106038891922D+15/


      IF(N.EQ.1) THEN
      DO I=1,18
      XX(I)=XX1(I)
      ENDDO
      ENDIF
      IF(N.EQ.2) THEN
      DO I=1,18
      XX(I)=XX2(I)
      ENDDO
      ENDIF
      IF(N.EQ.3) THEN
      DO I=1,18
      XX(I)=XX3(I)
      ENDDO
      ENDIF
      IF(N.EQ.4) THEN
      DO I=1,18
      XX(I)=XX4(I)
      ENDDO
      ENDIF
      IF(N.EQ.5) THEN
      DO I=1,18
      XX(I)=XX5(I)
      ENDDO
      ENDIF
      IF(N.EQ.6) THEN
      DO I=1,18
      XX(I)=XX6(I)
      ENDDO
      ENDIF
      IF(N.EQ.7) THEN
      DO I=1,18
      XX(I)=XX7(I)
      ENDDO
      ENDIF
      IF(N.EQ.8) THEN
      DO I=1,18
      XX(I)=XX8(I)
      ENDDO
      ENDIF
      IF(N.EQ.9) THEN
      DO I=1,18
      XX(I)=XX9(I)
      ENDDO
      ENDIF
      IF(N.EQ.10) THEN
      DO I=1,18
      XX(I)=XX10(I)
      ENDDO
      ENDIF
      IF(N.EQ.11) THEN
      DO I=1,18
      XX(I)=XX11(I)
      ENDDO
      ENDIF



      TERM1 = DEXP(-XX(1)*R-XX(2))
      TERM2 = XX(3) + XX(4)*R+XX(5)*R**2+
     *        XX(6)*R**3+XX(7)*R**4+XX(8)*R**5
     *        +XX(9)*R**6+XX(10)*R**7+XX(11)*R**8
      TERM3=0.5D0*
     *   (1.D0+ DTANH(1.D0+XX(12)*R))
      TERM4 = XX(13)/(R**6)+XX(14)/(R**7)
     *        +XX(15)/(R**8)+XX(16)/(R**9)
     *        +XX(17)/(R**10)+XX(18)/(R**11)
       TOCM=0.219474643545745D0
       VABISI = (TERM1*TERM2-TERM3*TERM4)*TOCM
       RETURN
       END
