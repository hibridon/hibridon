*system:  O(3P)+H2, Dubernet-Hutson expansion
*
*  MRCI calculation by mick warehime and jacek klos - march 2015
*  r(HH) = 1.40 bohr, close to r0 = 1.402 bohr
*
*  SF expansion here - csflag must be .false. when using this pot routine
*  written by p.dagdigian (30-mar-2015)
*
*  corrected calculation of BF, and hence SF, coefficients
*  (27-jul-2016, p.dagdigian)
*
*references:
*  M. H. Alexander, J. Chem. Phys. 108, 4467 (1998) [previous PES calc].
*  M.-L. Dubernet and J. M. Hutson, J. Chem. Phys. 101, 1939 (1994).
*  M. H. Alexander, J. Chem. Phys. 99, 6014 (1993).
*  M. H. Alexander and M. Yang, J. Chem. Phys. 103, 7956 (1995).


* NB potential fitted to all ab initio mrci scaled points determined
* with avqz basis with the restrictions:  R .ge. 2 and R .le. 10 bohr
      include "common/syusr"
      include "common/ground"
      include "common/bausr"
      subroutine loapot(iunit,filnam)
* --------------------------------------------------------------------------
      character*(*) filnam
      include "common/parbas"
      include "common/parpot"
      common /coselb/ ibasty
      potnam='Warehime O(3P)-H2 Dubernet-Hutson expansion'
      ibasty=13
      lammin(1)=1
      lammax(1)=12
      mproj(1)=0
      ntv(1)=1
      ivcol(1,1)=0
      ivrow(1,1)=0
      return
      end
* --------------------------------------------------------------------------
      subroutine driver
      implicit double precision (a-h,o-z)
      character *48 potnam
      logical csflag, ljunk, ihomo, lljunk
      common /colpar/ ljunk(5),csflag,lljunk(2),ihomo
      common /covvl/ vvl(9)
      econv=219474.6d0
      potnam='Warehime O(3P)-H2 Dubernet-Hutson expansion'
      print *, potnam
1     print *, 'R (bohr):'
      read (5, *, end=99) r
      call pot(vv0,r)
      if (r.le.0.d0) goto 99
*     vlm coefficient is returned in atomic units (hartree)
*     convert from atomic units for printout
      write (6, 100) vv0*econv, (econv*vvl(i), i=1,9)
100   format(10(1pe16.8))
      goto 1
99    rr=3.0d0
      dr=0.1d0
      open (unit=12,file='o3ph2_hib_2015_sf_vlm.txt')
      write(12,109)
109   format(' %R/bohr V000 V220 V022 V202 V222 V224',
     +  ' V404 V422 V424 V426')
      do i=1,250
        call pot(vv0,rr)
        write (12,110) rr,vv0*econv, (econv*vvl(j),j=1,9)
110     format(f7.2,10(1pe16.8))
        rr = rr + dr
      enddo
      close(12)
      end
*
      subroutine pot (vv0, r)
* ----------------------------------------------------------------------
*  subroutine to calculate the r-dependent coefficients in the
*  O(3P)-H2 potentials of warehime and flos using space-frame
*  expansion of dubernet and hutson
*  in atomic units (distance and energy)
* ----------------------------------------------------------------------
*  on entry:
*    r:      interparticle distance
*  on return:
*  vv0       totally symmetric potential (V000)
*  variable in common block /covvl/
*    vvl:     vector of length 9 to store r-dependence of each term
*             in potential expansion
* order in oh2_4444pot.txt - output from oh2_vlm_bfsf_transform.m
*    vvl(1)  V220(R)
*    vvl(2)  V022(R)
*    vvl(3)  V202(R)
*    vvl(4)  V222(R)
*    vvl(5)  V224(R)
*    vvl(6)  V404(R)
*    vvl(7)  V422(R)
*    vvl(8)  V424(R)
*    vvl(9)  V426(R)
*
* author:  pasul dagdigian
* latest revision date:  27-jul-2016
*
* coefficients from fit to matlab progs fit_oh2_pes_4444.m 
* and oh2_vlm4444_transform.m, for rhh = 1.40 bohr
* ----------------------------------------------------------------------
      implicit double precision (a-h,o-z)
      logical ljunk, ihomo, csflag, lljunk
      include "common/parbas"
      common /colpar/ ljunk(5),csflag,lljunk(2),ihomo
      common /covvl/ vvl(9)
      dimension v(10)
      dimension csplin(164,10)
      dimension rr(164),vl(1640),vec(164),c5(10)
*
*  161 values or R - add 3 more points to smooth extrapolation
*  values of the vlam coefficients
      data rr /
     +  2.000,  2.050,  2.100,  2.150,  2.200,
     +  2.250,  2.300,  2.350,  2.400,  2.450,
     +  2.500,  2.550,  2.600,  2.650,  2.700,
     +  2.750,  2.800,  2.850,  2.900,  2.950,
     +  3.000,  3.050,  3.100,  3.150,  3.200,
     +  3.250,  3.300,  3.350,  3.400,  3.450,
     +  3.500,  3.550,  3.600,  3.650,  3.700,
     +  3.750,  3.800,  3.850,  3.900,  3.950,
     +  4.000,  4.050,  4.100,  4.150,  4.200,
     +  4.250,  4.300,  4.350,  4.400,  4.450,
     +  4.500,  4.550,  4.600,  4.650,  4.700,
     +  4.750,  4.800,  4.850,  4.900,  4.950,
     +  5.000,  5.050,  5.100,  5.150,  5.200,
     +  5.250,  5.300,  5.350,  5.400,  5.450,
     +  5.500,  5.550,  5.600,  5.650,  5.700,
     +  5.750,  5.800,  5.850,  5.900,  5.950,
     +  6.000,  6.050,  6.100,  6.150,  6.200,
     +  6.250,  6.300,  6.350,  6.400,  6.450,
     +  6.500,  6.550,  6.600,  6.650,  6.700,
     +  6.750,  6.800,  6.850,  6.900,  6.950,
     +  7.000,  7.050,  7.100,  7.150,  7.200,
     +  7.250,  7.300,  7.350,  7.400,  7.450,
     +  7.500,  7.550,  7.600,  7.650,  7.700,
     +  7.750,  7.800,  7.850,  7.900,  7.950,
     +  8.000,  8.050,  8.100,  8.150,  8.200,
     +  8.250,  8.300,  8.350,  8.400,  8.450,
     +  8.500,  8.550,  8.600,  8.650,  8.700,
     +  8.750,  8.800,  8.850,  8.900,  8.950,
     +  9.000,  9.050,  9.100,  9.150,  9.200,
     +  9.250,  9.300,  9.350,  9.400,  9.450,
     +  9.500,  9.550,  9.600,  9.650,  9.700,
     +  9.750,  9.800,  9.850,  9.900,  9.950,
     + 10.000, 20, 30, 50 /
*  added two more r points to damp extrapolation error for r > 10
*  values of the vlam coefficients
      data vl /  
     +  5.0191003e+04,  4.5995800e+04,  4.2187340e+04,  3.8733466e+04,
     +  3.5602012e+04,  3.2760819e+04,  3.0178288e+04,  2.7825435e+04,
     +  2.5676142e+04,  2.3708492e+04,  2.1903276e+04,  2.0243301e+04,
     +  1.8714077e+04,  1.7302680e+04,  1.5997946e+04,  1.4790110e+04,
     +  1.3670624e+04,  1.2632006e+04,  1.1667631e+04,  1.0771649e+04,
     +  9.9389054e+03,  9.1647337e+03,  8.4447181e+03,  7.7757791e+03,
     +  7.1542807e+03,  6.5770695e+03,  6.0412971e+03,  5.5443167e+03,
     +  5.0836535e+03,  4.6569827e+03,  4.2621274e+03,  3.8970008e+03,
     +  3.5596304e+03,  3.2481833e+03,  2.9609301e+03,  2.6962067e+03,
     +  2.4524726e+03,  2.2282477e+03,  2.0221077e+03,  1.8325509e+03,
     +  1.6588714e+03,  1.4996547e+03,  1.3538259e+03,  1.2203844e+03,
     +  1.0983763e+03,  9.8687521e+02,  8.8516625e+02,  7.9242565e+02,
     +  7.0794581e+02,  6.3106401e+02,  5.6113489e+02,  4.9756541e+02,
     +  4.3984776e+02,  3.8748205e+02,  3.4021790e+02,  2.9752624e+02,
     +  2.5897529e+02,  2.2420737e+02,  1.9289525e+02,  1.6473501e+02,
     +  1.3944939e+02,  1.1678272e+02,  9.6499175e+01,  7.8385813e+01,
     +  6.2239932e+01,  4.7884417e+01,  3.5145005e+01,  2.3861663e+01,
     +  1.3935139e+01,  5.2608433e+00, -2.3480013e+00, -9.0636197e+00,
     + -1.4917821e+01, -1.9928446e+01, -2.4197876e+01, -2.7837502e+01,
     + -3.0910245e+01, -3.3467689e+01, -3.5564545e+01, -3.7254063e+01,
     + -3.8580514e+01, -3.9584750e+01, -4.0302934e+01, -4.0769091e+01,
     + -4.1013369e+01, -4.1063794e+01, -4.0943769e+01, -4.0675151e+01,
     + -4.0278245e+01, -3.9772007e+01, -3.9171553e+01, -3.8490726e+01,
     + -3.7742138e+01, -3.6937699e+01, -3.6087768e+01, -3.5202014e+01,
     + -3.4288923e+01, -3.3356430e+01, -3.2411466e+01, -3.1460200e+01,
     + -3.0506772e+01, -2.9555002e+01, -2.8609460e+01, -2.7673566e+01,
     + -2.6745376e+01, -2.5823423e+01, -2.4913477e+01, -2.4022457e+01,
     + -2.3154622e+01, -2.2312322e+01, -2.1492920e+01, -2.0694154e+01,
     + -1.9920243e+01, -1.9173617e+01, -1.8443094e+01, -1.7720195e+01,
     + -1.7020885e+01, -1.6361098e+01, -1.5732209e+01, -1.5121931e+01,
     + -1.4527877e+01, -1.3952609e+01, -1.3408567e+01, -1.2897486e+01,
     + -1.2368409e+01, -1.1789033e+01, -1.1254376e+01, -1.0850884e+01,
     + -1.0503394e+01, -1.0116283e+01, -9.6737091e+00, -9.1915256e+00,
     + -8.7325933e+00, -8.3514309e+00, -8.0221771e+00, -7.7066263e+00,
     + -7.3975737e+00, -7.0955647e+00, -6.8011446e+00, -6.5148589e+00,
     + -6.2372529e+00, -5.9688722e+00, -5.7102619e+00, -5.4619678e+00,
     + -5.2245348e+00, -4.9982391e+00, -4.7822784e+00, -4.5755809e+00,
     + -4.3770749e+00, -4.1856884e+00, -4.0004737e+00, -3.8209787e+00,
     + -3.6468749e+00, -3.4778341e+00, -3.3135280e+00, -3.1536283e+00,
     + -2.9978066e+00, -2.8457347e+00, -2.6970842e+00, -2.5515270e+00,
     + -2.4087348e+00, 0, 0, 0,
     +  2.5223777e+04,  2.3152079e+04,  2.1287258e+04,  1.9606327e+04,
     +  1.8086055e+04,  1.6702514e+04,  1.5431751e+04,  1.4256703e+04,
     +  1.3164307e+04,  1.2145093e+04,  1.1192133e+04,  1.0298105e+04,
     +  9.4594044e+03,  8.6713925e+03,  7.9314615e+03,  7.2378315e+03,
     +  6.5895390e+03,  5.9856271e+03,  5.4254171e+03,  4.9081206e+03,
     +  4.4326243e+03,  3.9978158e+03,  3.6000672e+03,  3.2414802e+03,
     +  2.9174198e+03,  2.6260756e+03,  2.3650678e+03,  2.1319197e+03,
     +  1.9241206e+03,  1.7392223e+03,  1.5747375e+03,  1.4285043e+03,
     +  1.2985581e+03,  1.1828790e+03,  1.0797224e+03,  9.8764976e+02,
     +  9.0532045e+02,  8.3165924e+02,  7.6496009e+02,  7.0448098e+02,
     +  6.5095293e+02,  6.0265427e+02,  5.5896304e+02,  5.1942563e+02,
     +  4.8349690e+02,  4.5101688e+02,  4.2114819e+02,  3.9383068e+02,
     +  3.6882601e+02,  3.4588545e+02,  3.2476187e+02,  3.0560291e+02,
     +  2.8815333e+02,  2.7196365e+02,  2.5683317e+02,  2.4254204e+02,
     +  2.2923446e+02,  2.1680639e+02,  2.0517298e+02,  1.9424488e+02,
     +  1.8395583e+02,  1.7423560e+02,  1.6502391e+02,  1.5626855e+02,
     +  1.4782704e+02,  1.3965180e+02,  1.3167797e+02,  1.2394184e+02,
     +  1.1674209e+02,  1.1030195e+02,  1.0414487e+02,  9.8594571e+01,
     +  9.3080090e+01,  8.8052377e+01,  8.3462279e+01,  7.9161207e+01,
     +  7.5120837e+01,  7.1337930e+01,  6.7805566e+01,  6.4516654e+01,
     +  6.1458217e+01,  5.8613069e+01,  5.5959589e+01,  5.3476741e+01,
     +  5.1153629e+01,  4.8979532e+01,  4.6939382e+01,  4.5018325e+01,
     +  4.3210054e+01,  4.1507685e+01,  3.9897820e+01,  3.8367041e+01,
     +  3.6911313e+01,  3.5526624e+01,  3.4201027e+01,  3.2922755e+01,
     +  3.1689545e+01,  3.0501370e+01,  2.9358455e+01,  2.8260870e+01,
     +  2.7208094e+01,  2.6196051e+01,  2.5208246e+01,  2.4238173e+01,
     +  2.3332676e+01,  2.2527359e+01,  2.1760635e+01,  2.0967944e+01,
     +  2.0171026e+01,  1.9405483e+01,  1.8675658e+01,  1.7976250e+01,
     +  1.7295432e+01,  1.6632554e+01,  1.6037908e+01,  1.5547520e+01,
     +  1.5089423e+01,  1.4589548e+01,  1.4073745e+01,  1.3586928e+01,
     +  1.3150422e+01,  1.2760247e+01,  1.2334985e+01,  1.1852045e+01,
     +  1.1601455e+01,  1.1766525e+01,  1.1790588e+01,  1.1167809e+01,
     +  1.0335389e+01,  9.8486076e+00,  9.7917144e+00,  1.0064406e+01,
     +  1.0299044e+01,  1.0176871e+01,  9.8419659e+00,  9.5098620e+00,
     +  9.2192216e+00,  8.9644454e+00,  8.7399496e+00,  8.5401453e+00,
     +  8.3594357e+00,  8.1922341e+00,  8.0329268e+00,  7.8759368e+00,
     +  7.7156448e+00,  7.5479374e+00,  7.3745981e+00,  7.1988897e+00,
     +  7.0240644e+00,  6.8533753e+00,  6.6896337e+00,  6.5340073e+00,
     +  6.3872039e+00,  6.2499547e+00,  6.1229758e+00,  6.0069671e+00,
     +  5.9025570e+00,  5.8103605e+00,  5.7310085e+00,  5.6651265e+00,
     +  5.6133597e+00, 0, 0, 0,
     +  9.2419997e+04,  8.7517328e+04,  8.2650702e+04,  7.7847368e+04,
     +  7.3134202e+04,  6.8537790e+04,  6.4083325e+04,  5.9789852e+04,
     +  5.5670660e+04,  5.1737050e+04,  4.7996960e+04,  4.4454368e+04,
     +  4.1111333e+04,  3.7967329e+04,  3.5020050e+04,  3.2265474e+04,
     +  2.9698131e+04,  2.7311317e+04,  2.5097494e+04,  2.3048461e+04,
     +  2.1155424e+04,  1.9409513e+04,  1.7802315e+04,  1.6323125e+04,
     +  1.4963626e+04,  1.3715316e+04,  1.2569857e+04,  1.1519318e+04,
     +  1.0556220e+04,  9.6735540e+03,  8.8648615e+03,  8.1240002e+03,
     +  7.4452725e+03,  6.8235703e+03,  6.2541797e+03,  5.7326258e+03,
     +  5.2549400e+03,  4.8173232e+03,  4.4163510e+03,  4.0495470e+03,
     +  3.7127667e+03,  3.4040650e+03,  3.1210596e+03,  2.8615991e+03,
     +  2.6236378e+03,  2.4052780e+03,  2.2050544e+03,  2.0213454e+03,
     +  1.8527752e+03,  1.6980767e+03,  1.5560350e+03,  1.4255515e+03,
     +  1.3056935e+03,  1.1955292e+03,  1.0946570e+03,  1.0021267e+03,
     +  9.1717378e+02,  8.3917847e+02,  7.6756606e+02,  7.0181525e+02,
     +  6.4144504e+02,  5.8601600e+02,  5.3511341e+02,  4.8836512e+02,
     +  4.4539117e+02,  4.0590426e+02,  3.6969166e+02,  3.3654272e+02,
     +  3.0615940e+02,  2.7827099e+02,  2.5280628e+02,  2.2991174e+02,
     +  2.0899864e+02,  1.8975377e+02,  1.7210949e+02,  1.5603398e+02,
     +  1.4138699e+02,  1.2801733e+02,  1.1582400e+02,  1.0471939e+02,
     +  9.4610724e+01,  8.5409114e+01,  7.7037048e+01,  6.9422687e+01,
     +  6.2497262e+01,  5.6197372e+01,  5.0472280e+01,  4.5274612e+01,
     +  4.0553580e+01,  3.6262163e+01,  3.2367668e+01,  2.8840515e+01,
     +  2.5645877e+01,  2.2750148e+01,  2.0126933e+01,  1.7752330e+01,
     +  1.5602632e+01,  1.3656613e+01,  1.1901365e+01,  1.0324810e+01,
     +  8.9087517e+00,  7.6352950e+00,  6.4935783e+00,  5.4726950e+00,
     +  4.5537783e+00,  3.7216933e+00,  2.9838483e+00,  2.3467883e+00,
     +  1.7909733e+00,  1.2948167e+00,  8.5387500e-01,  4.6776833e-01,
     +  1.3531167e-01, -1.4957667e-01, -4.1233833e-01, -6.7089500e-01,
     + -8.9411833e-01, -1.0510733e+00, -1.1608783e+00, -1.2510983e+00,
     + -1.3332417e+00, -1.4071550e+00, -1.4422683e+00, -1.4329800e+00,
     + -1.5042050e+00, -1.7352567e+00, -1.8928350e+00, -1.7649517e+00,
     + -1.5376900e+00, -1.4472115e+00, -1.5321547e+00, -1.7523575e+00,
     + -1.9501382e+00, -1.9884930e+00, -1.9306860e+00, -1.8707747e+00,
     + -1.8257667e+00, -1.7933813e+00, -1.7713578e+00, -1.7574185e+00,
     + -1.7493008e+00, -1.7447218e+00, -1.7414170e+00, -1.7371048e+00,
     + -1.7295130e+00, -1.7169742e+00, -1.7002592e+00, -1.6807547e+00,
     + -1.6598548e+00, -1.6389523e+00, -1.6192472e+00, -1.6010983e+00,
     + -1.5846695e+00, -1.5701170e+00, -1.5576065e+00, -1.5473005e+00,
     + -1.5393937e+00, -1.5340783e+00, -1.5315472e+00, -1.5319907e+00,
     + -1.5355898e+00, 0, 0, 0,
     +  1.5736792e+04,  1.2283588e+04,  9.4796007e+03,  7.2409453e+03,
     +  5.4837354e+03,  4.1240849e+03,  3.0814889e+03,  2.2910626e+03,
     +  1.7010400e+03,  1.2688956e+03,  9.6088024e+02,  7.4841397e+02,
     +  6.0945497e+02,  5.2539149e+02,  4.8153798e+02,  4.6618683e+02,
     +  4.7005111e+02,  4.8580921e+02,  5.0785831e+02,  5.3196716e+02,
     +  5.5503532e+02,  5.7490837e+02,  5.9018674e+02,  6.0003965e+02,
     +  6.0452001e+02,  6.0349562e+02,  5.9729638e+02,  5.8642325e+02,
     +  5.7148018e+02,  5.5311727e+02,  5.3194564e+02,  5.0863961e+02,
     +  4.8382174e+02,  4.5797441e+02,  4.3151904e+02,  4.0489532e+02,
     +  3.7842190e+02,  3.5241005e+02,  3.2728715e+02,  3.0250447e+02,
     +  2.7893239e+02,  2.5640521e+02,  2.3498463e+02,  2.1472773e+02,
     +  1.9562033e+02,  1.7773951e+02,  1.6090558e+02,  1.4514099e+02,
     +  1.3045728e+02,  1.1681533e+02,  1.0409613e+02,  9.2479470e+01,
     +  8.1881280e+01,  7.2045913e+01,  6.3125700e+01,  5.4850543e+01,
     +  4.7288043e+01,  4.0390833e+01,  3.4113643e+01,  2.8412780e+01,
     +  2.3247302e+01,  1.8576426e+01,  1.4363391e+01,  1.0588649e+01,
     +  7.1840400e+00,  4.1400680e+00,  1.4156467e+00, -1.0279553e+00,
     + -3.1653400e+00, -4.9853713e+00, -6.5980700e+00, -8.1040500e+00,
     + -9.4451980e+00, -1.0551779e+01, -1.1466355e+01, -1.2247457e+01,
     + -1.2905150e+01, -1.3440141e+01, -1.3864182e+01, -1.4190717e+01,
     + -1.4428927e+01, -1.4587076e+01, -1.4674039e+01, -1.4698218e+01,
     + -1.4665512e+01, -1.4581689e+01, -1.4454474e+01, -1.4290963e+01,
     + -1.4093775e+01, -1.3865453e+01, -1.3612687e+01, -1.3342094e+01,
     + -1.3055817e+01, -1.2754992e+01, -1.2441195e+01, -1.2116497e+01,
     + -1.1784512e+01, -1.1448353e+01, -1.1107603e+01, -1.0762073e+01,
     + -1.0416036e+01, -1.0073724e+01, -9.7347544e+00, -9.3994336e+00,
     + -9.0754571e+00, -8.7670415e+00, -8.4571017e+00, -8.1313455e+00,
     + -7.8079577e+00, -7.5069449e+00, -7.2231285e+00, -6.9468182e+00,
     + -6.6754663e+00, -6.4090945e+00, -6.1508604e+00, -5.9041850e+00,
     + -5.6704113e+00, -5.4495789e+00, -5.2385959e+00, -5.0343368e+00,
     + -4.8366718e+00, -4.6457682e+00, -4.4599765e+00, -4.2789300e+00,
     + -4.1092041e+00, -3.9546427e+00, -3.8012210e+00, -3.6365488e+00,
     + -3.4726398e+00, -3.3236111e+00, -3.1875892e+00, -3.0591355e+00,
     + -2.9345475e+00, -2.8115309e+00, -2.6916913e+00, -2.5771613e+00,
     + -2.4682819e+00, -2.3649472e+00, -2.2670502e+00, -2.1744843e+00,
     + -2.0871429e+00, -2.0049200e+00, -1.9277083e+00, -1.8554014e+00,
     + -1.7878935e+00, -1.7250095e+00, -1.6663036e+00, -1.6112631e+00,
     + -1.5593744e+00, -1.5101240e+00, -1.4631119e+00, -1.4183915e+00,
     + -1.3761296e+00, -1.3364931e+00, -1.2996488e+00, -1.2657632e+00,
     + -1.2350034e+00, -1.2075362e+00, -1.1835282e+00, -1.1631463e+00,
     + -1.1465573e+00, 0, 0, 0,
     +  5.1631756e+03,  4.5290794e+03,  3.9237404e+03,  3.3571525e+03,
     +  2.8384822e+03,  2.3765695e+03,  1.9792275e+03,  1.6464576e+03,
     +  1.3721183e+03,  1.1505186e+03,  9.7344894e+02,  8.3519790e+02,
     +  7.2707924e+02,  6.4433093e+02,  5.8181564e+02,  5.3522971e+02,
     +  5.0110489e+02,  4.7629299e+02,  4.5853423e+02,  4.4596574e+02,
     +  4.3685491e+02,  4.3023540e+02,  4.2270413e+02,  4.1811570e+02,
     +  4.1402906e+02,  4.1002662e+02,  4.0591997e+02,  4.0159126e+02,
     +  3.9693709e+02,  3.9186239e+02,  3.8641251e+02,  3.8040057e+02,
     +  3.7365169e+02,  3.6628653e+02,  3.5837465e+02,  3.4985457e+02,
     +  3.4079996e+02,  3.3116582e+02,  3.2102304e+02,  3.0877921e+02,
     +  2.9817905e+02,  2.8743666e+02,  2.7664630e+02,  2.6581052e+02,
     +  2.5508942e+02,  2.4468444e+02,  2.3436688e+02,  2.2434276e+02,
     +  2.1459626e+02,  2.0516521e+02,  1.9619592e+02,  1.8767188e+02,
     +  1.7955707e+02,  1.7196929e+02,  1.6422296e+02,  1.5675767e+02,
     +  1.4965334e+02,  1.4290319e+02,  1.3650624e+02,  1.3045691e+02,
     +  1.2475242e+02,  1.1939309e+02,  1.1438379e+02,  1.0972037e+02,
     +  1.0551146e+02,  1.0174521e+02,  9.8282307e+01,  9.4979989e+01,
     +  9.1967324e+01,  8.9309196e+01,  8.6660581e+01,  8.2794953e+01,
     +  7.9181599e+01,  7.6183335e+01,  7.3533520e+01,  7.0902382e+01,
     +  6.8326089e+01,  6.5903052e+01,  6.3610188e+01,  6.1402316e+01,
     +  5.9273690e+01,  5.7228605e+01,  5.5268361e+01,  5.3392135e+01,
     +  5.1591074e+01,  4.9857432e+01,  4.8190466e+01,  4.6590343e+01,
     +  4.5050512e+01,  4.3566143e+01,  4.2140552e+01,  4.0777293e+01,
     +  3.9468522e+01,  3.8204848e+01,  3.6979249e+01,  3.5786149e+01,
     +  3.4620835e+01,  3.3483484e+01,  3.2391370e+01,  3.1359303e+01,
     +  3.0374188e+01,  2.9418201e+01,  2.8481378e+01,  2.7563236e+01,
     +  2.6691751e+01,  2.5886681e+01,  2.5105101e+01,  2.4306511e+01,
     +  2.3521857e+01,  2.2787541e+01,  2.2089993e+01,  2.1407627e+01,
     +  2.0736279e+01,  2.0087931e+01,  1.9521381e+01,  1.9072538e+01,
     +  1.8638410e+01,  1.8117658e+01,  1.7553953e+01,  1.7015655e+01,
     +  1.6524561e+01,  1.6070881e+01,  1.5564732e+01,  1.4984491e+01,
     +  1.4661521e+01,  1.4804775e+01,  1.4780594e+01,  1.4013304e+01,
     +  1.3001699e+01,  1.2380308e+01,  1.2252072e+01,  1.2507243e+01,
     +  1.2716834e+01,  1.2508046e+01,  1.2052036e+01,  1.1603629e+01,
     +  1.1208142e+01,  1.0858601e+01,  1.0547989e+01,  1.0269311e+01,
     +  1.0015569e+01,  9.7797759e+00,  9.5549456e+00,  9.3340866e+00,
     +  9.1102292e+00,  8.8782999e+00,  8.6408887e+00,  8.4024972e+00,
     +  8.1676176e+00,  7.9407479e+00,  7.7256040e+00,  7.5227613e+00,
     +  7.3320401e+00,  7.1532448e+00,  6.9861817e+00,  6.8306809e+00,
     +  6.6865929e+00,  6.5537866e+00,  6.4321157e+00,  6.3214424e+00,
     +  6.2216210e+00, 0, 0, 0,
     + -1.7200228e+04, -1.4537012e+04, -1.2149398e+04, -1.0035180e+04,
     + -8.1914149e+03, -6.6140085e+03, -5.2946407e+03, -4.2151048e+03,
     + -3.3511171e+03, -2.6763367e+03, -2.1633744e+03, -1.7880049e+03,
     + -1.5246543e+03, -1.3532592e+03, -1.2543731e+03, -1.2108920e+03,
     + -1.2080940e+03, -1.2333533e+03, -1.2762474e+03, -1.3283890e+03,
     + -1.3832593e+03, -1.4358399e+03, -1.4831350e+03, -1.5217135e+03,
     + -1.5514267e+03, -1.5712840e+03, -1.5813486e+03, -1.5820970e+03,
     + -1.5742874e+03, -1.5588862e+03, -1.5370661e+03, -1.5096973e+03,
     + -1.4776673e+03, -1.4420211e+03, -1.4037806e+03, -1.3635029e+03,
     + -1.3218925e+03, -1.2793497e+03, -1.2368956e+03, -1.1938801e+03,
     + -1.1512341e+03, -1.1091793e+03, -1.0678928e+03, -1.0274881e+03,
     + -9.8817043e+02, -9.4989650e+02, -9.1303986e+02, -8.7749360e+02,
     + -8.4322772e+02, -8.1024275e+02, -7.7861432e+02, -7.4799706e+02,
     + -7.1843048e+02, -6.9015530e+02, -6.6305407e+02, -6.3729005e+02,
     + -6.1263353e+02, -5.8904467e+02, -5.6648650e+02, -5.4491884e+02,
     + -5.2429856e+02, -5.0456293e+02, -4.8574993e+02, -4.6782259e+02,
     + -4.5092331e+02, -4.3478496e+02, -4.1913536e+02, -4.0372367e+02,
     + -3.8841101e+02, -3.7320410e+02, -3.5853726e+02, -3.4351227e+02,
     + -3.2941039e+02, -3.1595638e+02, -3.0305576e+02, -2.9066318e+02,
     + -2.7878697e+02, -2.6742428e+02, -2.5655623e+02, -2.4615786e+02,
     + -2.3622058e+02, -2.2673147e+02, -2.1768574e+02, -2.0907070e+02,
     + -2.0086594e+02, -1.9304779e+02, -1.8560814e+02, -1.7853565e+02,
     + -1.7180661e+02, -1.6539592e+02, -1.5929957e+02, -1.5351223e+02,
     + -1.4801266e+02, -1.4277539e+02, -1.3778168e+02, -1.3301359e+02,
     + -1.2845594e+02, -1.2409497e+02, -1.1992382e+02, -1.1593479e+02,
     + -1.1211281e+02, -1.0844314e+02, -1.0492131e+02, -1.0153836e+02,
     + -9.8258614e+01, -9.5053576e+01, -9.1951387e+01, -8.8983482e+01,
     + -8.6138547e+01, -8.3398203e+01, -8.0759496e+01, -7.8222636e+01,
     + -7.5785403e+01, -7.3440145e+01, -7.1160539e+01, -6.8924920e+01,
     + -6.6749438e+01, -6.4653612e+01, -6.2633154e+01, -6.0677983e+01,
     + -5.8778908e+01, -5.6933217e+01, -5.5163426e+01, -5.3474657e+01,
     + -5.1777404e+01, -5.0013948e+01, -4.8348480e+01, -4.6930273e+01,
     + -4.5627058e+01, -4.4272288e+01, -4.2843861e+01, -4.1373424e+01,
     + -3.9963275e+01, -3.8701113e+01, -3.7545640e+01, -3.6435558e+01,
     + -3.5358595e+01, -3.4314710e+01, -3.3303883e+01, -3.2326069e+01,
     + -3.1381244e+01, -3.0469367e+01, -2.9590403e+01, -2.8744314e+01,
     + -2.7931062e+01, -2.7150355e+01, -2.6400883e+01, -2.5681088e+01,
     + -2.4989417e+01, -2.4324312e+01, -2.3684196e+01, -2.3067396e+01,
     + -2.2472213e+01, -2.1896946e+01, -2.1339902e+01, -2.0799376e+01,
     + -2.0273670e+01, -1.9761077e+01, -1.9259894e+01, -1.8768414e+01,
     + -1.8284934e+01, 0, 0, 0,
     +  1.0149139e+04,  8.4137756e+03,  6.9374693e+03,  5.6914711e+03,
     +  4.6470318e+03,  3.7754025e+03,  3.0492065e+03,  2.4468244e+03,
     +  1.9493871e+03,  1.5400228e+03,  1.2043555e+03,  9.3044853e+02,
     +  7.0951524e+02,  5.3227921e+02,  3.9143766e+02,  2.8077913e+02,
     +  1.9502906e+02,  1.2970040e+02,  8.0952965e+01,  4.5521655e+01,
     +  2.0595375e+01,  3.9435280e+00, -6.5164583e+00, -1.2448234e+01,
     + -1.5012873e+01, -1.5280192e+01, -1.4053966e+01, -1.1943856e+01,
     + -9.3947142e+00, -6.7185375e+00, -4.0860218e+00, -1.6625406e+00,
     +  4.4920113e-01,  2.2564994e+00,  3.7856757e+00,  5.0134647e+00,
     +  5.9555920e+00,  6.6166997e+00,  7.3231367e+00,  7.2994537e+00,
     +  7.4576497e+00,  7.5074893e+00,  7.4756470e+00,  7.3900737e+00,
     +  7.3102287e+00,  6.9404410e+00,  6.7477187e+00,  6.4444863e+00,
     +  6.1731725e+00,  5.9485638e+00,  5.8467274e+00,  5.7955680e+00,
     +  5.7247036e+00,  5.8053995e+00,  5.5539647e+00,  5.4063068e+00,
     +  5.2710328e+00,  5.1468560e+00,  5.0323578e+00,  4.9246635e+00,
     +  4.8254088e+00,  4.7318417e+00,  4.6430828e+00,  4.6010780e+00,
     +  4.5168456e+00,  4.4525337e+00,  4.3514129e+00,  4.1759257e+00,
     +  4.1469591e+00,  4.4120713e+00,  4.5670521e+00,  4.2486647e+00,
     +  3.8093298e+00,  3.6485713e+00,  3.6386727e+00,  3.5750317e+00,
     +  3.4727438e+00,  3.3869685e+00,  3.3134225e+00,  3.2369730e+00,
     +  3.1585318e+00,  3.0819828e+00,  3.0070518e+00,  2.9324737e+00,
     +  2.8571763e+00,  2.7805113e+00,  2.7033267e+00,  2.6261465e+00,
     +  2.5466931e+00,  2.4631242e+00,  2.3781346e+00,  2.2944647e+00,
     +  2.2104992e+00,  2.1238843e+00,  2.0336674e+00,  1.9399678e+00,
     +  1.8457862e+00,  1.7537128e+00,  1.6618108e+00,  1.5679378e+00,
     +  1.4736565e+00,  1.3810986e+00,  1.2909645e+00,  1.2040349e+00,
     +  1.1228394e+00,  1.0478185e+00,  9.6930564e-01,  8.7983728e-01,
     +  7.9087027e-01,  7.1359439e-01,  6.3921746e-01,  5.5849801e-01,
     +  4.8038317e-01,  4.1599970e-01,  3.6700062e-01,  3.3064229e-01,
     +  2.9606591e-01,  2.5386787e-01,  2.0857710e-01,  1.6659328e-01,
     +  1.2785850e-01,  9.1753637e-02,  6.1867320e-02,  3.8558797e-02,
     +  5.0637133e-03, -4.8537190e-02, -8.7656964e-02, -8.1771637e-02,
     + -6.1118627e-02, -6.1423317e-02, -7.9599887e-02, -1.0334280e-01,
     + -1.2227795e-01, -1.2940914e-01, -1.2932644e-01, -1.2829456e-01,
     + -1.2768942e-01, -1.2766590e-01, -1.2837826e-01, -1.2998060e-01,
     + -1.3262750e-01, -1.3647294e-01, -1.4167160e-01, -1.4837769e-01,
     + -1.5674578e-01, -1.6667469e-01, -1.7704438e-01, -1.8647915e-01,
     + -1.9360320e-01, -1.9704167e-01, -1.9587314e-01, -1.9099618e-01,
     + -1.8376320e-01, -1.7552710e-01, -1.6764055e-01, -1.6145655e-01,
     + -1.5832735e-01, -1.5960618e-01, -1.6664573e-01, -1.8079858e-01,
     + -2.0341742e-01, 0, 0, 0,
     + -1.6977992e+03, -1.2642464e+03, -9.4195645e+02, -7.0338629e+02,
     + -5.2445037e+02, -3.8478062e+02, -2.6786841e+02, -1.6552501e+02,
     + -7.3223378e+01,  9.3436872e+00,  8.2144089e+01,  1.4472433e+02,
     +  2.0084098e+02,  2.4870271e+02,  2.8827692e+02,  3.1966403e+02,
     +  3.4282425e+02,  3.5808161e+02,  3.6590022e+02,  3.6704914e+02,
     +  3.6231732e+02,  3.5263707e+02,  3.3837373e+02,  3.2244248e+02,
     +  3.0358650e+02,  2.8352824e+02,  2.6302493e+02,  2.4267859e+02,
     +  2.2295743e+02,  2.0420120e+02,  1.8670816e+02,  1.7047854e+02,
     +  1.5544347e+02,  1.4167293e+02,  1.2916791e+02,  1.1775810e+02,
     +  1.0731616e+02,  9.7696395e+01,  8.8899378e+01,  8.0393302e+01,
     +  7.3245144e+01,  6.6790274e+01,  6.0975918e+01,  5.5798588e+01,
     +  5.1246355e+01,  4.6754615e+01,  4.2943210e+01,  3.9463991e+01,
     +  3.6403856e+01,  3.3750700e+01,  3.1656058e+01,  2.9856371e+01,
     +  2.8229002e+01,  2.7144111e+01,  2.5508088e+01,  2.4239039e+01,
     +  2.3113613e+01,  2.2101704e+01,  2.1176756e+01,  2.0300360e+01,
     +  1.9439691e+01,  1.8517669e+01,  1.7597210e+01,  1.6696256e+01,
     +  1.5532554e+01,  1.3760844e+01,  1.1210014e+01,  7.9998933e+00,
     +  4.4335592e+00,  1.0154838e+00, -2.1106598e+00, -2.2938267e+00,
     + -2.8151439e+00, -3.6333810e+00, -4.3808485e+00, -4.7507541e+00,
     + -4.8671876e+00, -4.9405289e+00, -4.9556630e+00, -4.8475791e+00,
     + -4.6312928e+00, -4.3454141e+00, -4.0109092e+00, -3.6461742e+00,
     + -3.2620742e+00, -2.8673781e+00, -2.4642522e+00, -2.0563825e+00,
     + -1.6542779e+00, -1.2676424e+00, -8.9516301e-01, -5.3485798e-01,
     + -1.9353310e-01,  1.2125751e-01,  4.0668629e-01,  6.6208031e-01,
     +  8.8884815e-01,  1.0878377e+00,  1.2546786e+00,  1.3848659e+00,
     +  1.4777818e+00,  1.5372191e+00,  1.5785241e+00,  1.6086034e+00,
     +  1.5878456e+00,  1.4851941e+00,  1.3496715e+00,  1.2384326e+00,
     +  1.1605613e+00,  1.1101282e+00,  1.0683898e+00,  1.0192224e+00,
     +  9.6871061e-01,  9.2619874e-01,  8.9226543e-01,  8.6360122e-01,
     +  8.2784071e-01,  7.7446308e-01,  7.1044698e-01,  6.4718657e-01,
     +  5.9548224e-01,  5.5632154e-01,  4.9214522e-01,  3.9376575e-01,
     +  4.0412723e-01,  6.1377204e-01,  7.5121368e-01,  5.6985614e-01,
     +  2.8448725e-01,  1.6567015e-01,  2.4550273e-01,  4.6850471e-01,
     +  6.6766095e-01,  7.0068060e-01,  6.3616812e-01,  5.7484968e-01,
     +  5.3493699e-01,  5.1401684e-01,  5.0969945e-01,  5.1954111e-01,
     +  5.4114474e-01,  5.7207116e-01,  6.0988044e-01,  6.5216992e-01,
     +  6.9647543e-01,  7.4046331e-01,  7.8212881e-01,  8.1956424e-01,
     +  8.5083871e-01,  8.7402823e-01,  8.8787118e-01,  8.9391687e-01,
     +  8.9435997e-01,  8.9142366e-01,  8.8731830e-01,  8.8424950e-01,
     +  8.8433573e-01,  8.8971010e-01,  9.0249629e-01,  9.2484226e-01,
     +  9.5888616e-01, 0, 0, 0,
     + -1.2138802e+02, -1.5514537e+02, -1.5799834e+02, -1.4211392e+02,
     + -1.1811317e+02, -9.5066652e+01, -7.9913969e+01, -7.3813678e+01,
     + -7.4392172e+01, -7.8269121e+01, -8.2015731e+01, -8.3481135e+01,
     + -8.3934012e+01, -8.1451606e+01, -7.5946443e+01, -6.7644016e+01,
     + -5.7110459e+01, -4.4931468e+01, -3.1925005e+01, -1.8880927e+01,
     + -6.5409481e+00,  5.1554582e+00,  1.4107800e+01,  2.3124934e+01,
     +  2.9569943e+01,  3.4571362e+01,  3.8311464e+01,  4.1002665e+01,
     +  4.2839861e+01,  4.3981848e+01,  4.4473582e+01,  4.4519764e+01,
     +  4.4280004e+01,  4.3737904e+01,  4.2878965e+01,  4.1833374e+01,
     +  4.0678324e+01,  3.9524046e+01,  3.9010527e+01,  3.5657394e+01,
     +  3.4193948e+01,  3.2666319e+01,  3.1083390e+01,  2.9422259e+01,
     +  2.7613557e+01,  2.5863263e+01,  2.4187104e+01,  2.2642196e+01,
     +  2.1113698e+01,  1.9598074e+01,  1.8267595e+01,  1.6759387e+01,
     +  1.5130738e+01,  1.3682635e+01,  1.1920695e+01,  1.0283160e+01,
     +  8.6674971e+00,  7.0741695e+00,  5.5044637e+00,  3.9586553e+00,
     +  2.4540031e+00,  1.0083732e+00, -3.7146505e-01, -1.7175725e+00,
     + -2.7990728e+00, -3.5352869e+00, -3.9543945e+00, -4.1913896e+00,
     + -4.2487845e+00, -4.1956132e+00, -3.8976908e+00, -5.8243493e+00,
     + -6.9385418e+00, -7.2996283e+00, -7.2930024e+00, -7.2672894e+00,
     + -7.1891302e+00, -6.9480707e+00, -6.5805967e+00, -6.1473154e+00,
     + -5.6651190e+00, -5.1361493e+00, -4.5835441e+00, -4.0254753e+00,
     + -3.4709321e+00, -2.9236188e+00, -2.3949366e+00, -1.8928020e+00,
     + -1.4195768e+00, -9.7542546e-01, -5.6858042e-01, -2.0475496e-01,
     +  1.1941309e-01,  4.0912416e-01,  6.6038435e-01,  8.7123254e-01,
     +  1.0511659e+00,  1.2077925e+00,  1.3262815e+00,  1.3934166e+00,
     +  1.4218037e+00,  1.4291199e+00,  1.4282439e+00,  1.4219363e+00,
     +  1.3768351e+00,  1.2651920e+00,  1.1180307e+00,  9.7539144e-01,
     +  8.5525506e-01,  7.6462246e-01,  6.8711024e-01,  6.0356468e-01,
     +  5.0835203e-01,  4.1310779e-01,  3.8341559e-01,  4.6294949e-01,
     +  5.5424013e-01,  5.5935095e-01,  5.1866726e-01,  4.9389727e-01,
     +  4.9374179e-01,  5.0492837e-01,  4.7914559e-01,  4.0775458e-01,
     +  4.7524427e-01,  7.9742988e-01,  1.0214342e+00,  8.2632541e-01,
     +  4.8722135e-01,  3.5637420e-01,  4.9808602e-01,  8.5633513e-01,
     +  1.1812749e+00,  1.2545561e+00,  1.1773155e+00,  1.0997001e+00,
     +  1.0485177e+00,  1.0197225e+00,  1.0092509e+00,  1.0130869e+00,
     +  1.0271537e+00,  1.0474436e+00,  1.0698921e+00,  1.0904768e+00,
     +  1.1051528e+00,  1.1108785e+00,  1.1085912e+00,  1.1002092e+00,
     +  1.0876379e+00,  1.0727962e+00,  1.0572781e+00,  1.0415782e+00,
     +  1.0258760e+00,  1.0103679e+00,  9.9522853e-01,  9.8062619e-01,
     +  9.6666309e-01,  9.5342630e-01,  9.4102433e-01,  9.2954675e-01,
     +  9.1912129e-01, 0, 0, 0,
     + -1.0230161e+02, -2.8434189e+02, -3.9470222e+02, -4.4879325e+02,
     + -4.5872604e+02, -4.3304923e+02, -3.7934139e+02, -3.0773084e+02,
     + -2.2775326e+02, -1.4878533e+02, -7.8477396e+01, -2.1088280e+01,
     +  2.6094483e+01,  6.0701520e+01,  8.3124063e+01,  9.4329528e+01,
     +  9.5868528e+01,  8.9385560e+01,  7.6610010e+01,  5.9126130e+01,
     +  3.8608818e+01,  1.6477272e+01, -6.3889622e+00, -2.8054067e+01,
     + -4.8586930e+01, -6.7132470e+01, -8.3298076e+01, -9.6867733e+01,
     + -1.0778670e+02, -1.1613936e+02, -1.2197456e+02, -1.2566062e+02,
     + -1.2755717e+02, -1.2783535e+02, -1.2665332e+02, -1.2440747e+02,
     + -1.2135074e+02, -1.1778157e+02, -1.1402875e+02, -1.0967119e+02,
     + -1.0504409e+02, -1.0028864e+02, -9.5480398e+01, -9.0689368e+01,
     + -8.5763010e+01, -8.1388096e+01, -7.6920875e+01, -7.2750760e+01,
     + -6.8722619e+01, -6.4840321e+01, -6.0925649e+01, -5.7267235e+01,
     + -5.3951865e+01, -5.0531282e+01, -4.7979385e+01, -4.5479857e+01,
     + -4.3184608e+01, -4.1085212e+01, -3.9169766e+01, -3.7432564e+01,
     + -3.5847904e+01, -3.4337282e+01, -3.3129223e+01, -3.2245637e+01,
     + -3.2051697e+01, -3.1877022e+01, -3.0976694e+01, -2.8811241e+01,
     + -2.5613671e+01, -2.1974591e+01, -1.8829555e+01, -1.3355538e+01,
     + -9.3498741e+00, -6.5565650e+00, -4.5346537e+00, -2.8709502e+00,
     + -1.5337287e+00, -5.2660146e-01,  2.0212724e-01,  7.0272485e-01,
     +  1.0040094e+00,  1.1406142e+00,  1.1511891e+00,  1.0738621e+00,
     +  9.2723003e-01,  7.2670884e-01,  4.9434901e-01,  2.5024299e-01,
     + -1.0164179e-03, -2.5590628e-01, -4.9652388e-01, -7.0668536e-01,
     + -8.8684780e-01, -1.0422427e+00, -1.1760434e+00, -1.2910149e+00,
     + -1.3855789e+00, -1.4578029e+00, -1.5060260e+00, -1.5305742e+00,
     + -1.5370981e+00, -1.5308493e+00, -1.5085435e+00, -1.4726426e+00,
     + -1.4554438e+00, -1.4816149e+00, -1.5146998e+00, -1.5146906e+00,
     + -1.4882025e+00, -1.4528711e+00, -1.4221305e+00, -1.4059085e+00,
     + -1.4039436e+00, -1.4116819e+00, -1.4169630e+00, -1.4099517e+00,
     + -1.3957840e+00, -1.3824429e+00, -1.3746723e+00, -1.3740285e+00,
     + -1.3718524e+00, -1.3641039e+00, -1.3754050e+00, -1.4128856e+00,
     + -1.3848096e+00, -1.2321289e+00, -1.1246611e+00, -1.2169283e+00,
     + -1.3729585e+00, -1.4230297e+00, -1.3524565e+00, -1.1994884e+00,
     + -1.0590555e+00, -1.0105059e+00, -1.0144094e+00, -1.0134412e+00,
     + -9.9741144e-01, -9.6793262e-01, -9.2661145e-01, -8.7504102e-01,
     + -8.1482319e-01, -7.4756036e-01, -6.7482410e-01, -5.9823950e-01,
     + -5.1937223e-01, -4.4004606e-01, -3.6294736e-01, -2.9097858e-01,
     + -2.2702020e-01, -1.7395371e-01, -1.3370939e-01, -1.0460211e-01,
     + -8.3975137e-02, -6.9211376e-02, -5.7663157e-02, -4.6682088e-02,
     + -3.3503449e-02, -1.5369996e-02,  1.0476522e-02,  4.6778029e-02,
     +  9.6266478e-02, 0, 0, 0 /
*
* spline fit
      if (ifirst .eq. 0) then
* spline fit of the vl coefficients
         ind=1
         do ilam=1,10
           call dcopy(164,vl(ind),1,vec,1)
*    compute c5 coefficient
           c5(ilam) = vec(159)*rr(159)**5
*    evaluate derivative at first point
           der1=(vec(2)-vec(1))/(rr(2)-rr(1))
           call dspline(rr,vec,164,der1,0d0,csplin(1,ilam))
           ind = ind + 164
         enddo
         ifirst = 1
       end if
* switching function for long-range
       switch_lr=0.5*(tanh(0.75*(r - 10.d0)) + 1.d0)
* determine splined coefficients at R=r
       ind=1
       do ilam=1,10
         call dcopy(164,vl(ind),1,vec,1)
         call dsplint(rr,vec,csplin(1,ilam),164,r,vvx)
         if (r.ge.8.d0) then
           if (ilam.le.2 .or. ilam.eq.4 .or. ilam.eq.5 
     +         .or. ilam.eq.6) then
* for V000, V220, V202, V222, and V224,
* merge with r^-5 dependence at large R
             vvx = (1.d0 - switch_lr)*vvx + switch_lr*c5(ilam)/(r**5)
           else
* kill anisotropic terms at large R
             vvx = (1.d0 - switch_lr)*vvx
           endif
         endif
         v(ilam)=vvx
         call dcopy(164,vl(ind),1,vec,1)
         ind = ind + 164
       enddo
       call dcopy(9,v(2),1,vvl(1),1)
* convert to hartree
       econv=1.d0/219474.6d0
       call dscal(9,econv,vvl,1)
* isotropic term 
       vv0 = v(1)*econv
*
       return
       end
*===========================eof===============================