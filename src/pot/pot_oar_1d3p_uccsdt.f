cstart unix-ifort
cdec$ fixedformlinesize:132
cend

*  System:  O(1D,3P) + Ar
*  Theory  Level for 3Pi, 3Sigma, 1Sigma, 1Delta curves: 
*                UCCSD(T)/aug-cc-pv5z-dk BSSE and SC corrected
*  Theory  Level for 1Pi curve: 
*       MRCISD+Q(Davidson) aug-cc-pvqz-DK BSSE and SC corrected
*   Scalar relativistic effects included by using all-electron
*   Douglas-Kroll Hamiltonian and integrals
*  Theory Level for SO curves: 
*       MRCISD+Q(Davidson) aug-cc-pvqz-DK
*   calculation of potential energy curves and spin-orbit matrix
*   elements by j.klos, 2013 and 2016 (UCCSD(T)) 
*
*   written by p. dagdigian
*   adapted to O-Ar by j. klos
*   past revision date:  1-march-2016 by jklos
*   current revision date:  4-dec2017 by pdagdigian
*   fixed long-range behavior of potentials
      include "common/syusr"
      include "common/bausr"
      include "common/ground"
* --------------------------------------------------------------------------
      subroutine loapot(iunit,filnam)
* --------------------------------------------------------------------------
      character*(*) filnam
      common /coselb/ ibasty
      include "common/parbas"
      include "common/parpot"
      potnam='O(1D,3P)-Ar UCCSD(T)'
      ibasty=22
      lammin(1)=1
      lammax(1)=12
      mproj(1)=0
      ntv(1)=1
      ivcol(1,1)=0
      ivrow(1,1)=0
      return
      end
* --------------------------------------------------------------------------
      subroutine driver
      implicit double precision (a-h,o-z)
      common /cosysi/ junk(5), npot
      common /cosysr/ isrcod, junkr, en(4)
      common /covvl/ vvl(19)
      include "common/parpot"
      potnam='O(1D,3P)-Ar UCCSD(T)'
      econv=219474.6d0
      print *, potnam
1     print *, 'R (bohr):'
      read (5, *, end=99) r
      if (r.le.0.d0) goto 99
      call pot(vv0,r)
      write (6, 100) (econv*vvl(i), i=1,19)
100   format('  ',6(1pe16.8)/'  ',6(1pe16.8)/
     +  '  ',7(1pe16.8))
      goto 1
99    rr=2.6d0
      dr=0.25d0
      open (unit=12,file='oar_uccsdt_vlms.txt')
      open (unit=13,file='oar_uccsdt_pots_so.txt')
      write(12,109)
109   format('% R/bohr 1Sig  1Pi  1Del  3Sig  3Pi  Axy   Azy',
     :  '  Bss  Byx  Bxs  Bsy  Bxd  Axy(R=inf)   Azy(R=inf)',
     :  '  Bss(R=inf)  Byx(R=inf)  Bxs(R=inf)  Bsy(R=inf)',
     :  '  Bxd(R=inf)')
      write(13,119)
119   format('% R/bohr 1Sig  1Pi  1Del  3Sig  3Pi  Axy   Azy',
     :  '  Bss  Byx  Bxs  Bsy  Bxd')
      do i=1,201
        call pot(vv0,rr)
        write (12,110) rr,(econv*vvl(j),j=1,19)
110     format(f7.2,19(1pe16.8))
        write (13,120) rr,(econv*vvl(j),j=1,12)
120     format(f7.2,12(1pe16.8))
        rr = rr + dr
      enddo
      close(12)
      close(13)
      end
* --------------------------------------------------------------------------
      subroutine pot (vv0, r)
*  subroutine to calculate the r-dependent coefficients
*  in atomic units (distance and energy)
* ----------------------------------------------------------------------
*  on entry:
*    r:      interparticle distance
*  on return:
*    vv0        (not used)
*    vvl(1,3)   contains the 1Sigma+, 1Pi, 1Delta energies
*    vvl(4,5)   contains the 3Sigma- and 3Pi PE energies
*    vvl(6,7)   contains Axy and Axz, the spin-orbit matrix elements
*               within the 3P state
*    vvl(8,12)  contains Bss, Byx, Bxs, Bsy, and Bxd, the spin-orbit
*               matrix elements coupling the 1D and 3P states
*    vvl(13,19) values of the Axy, Azy, Bss, Byx, Bxs, Bsy, and Bxd
*               matrix elements at R=inf
**  variable in common block /conlam/ used here
*    nlam:    the number of angular coupling terms actually used
*  variable in common block /covvl/
*    vvl:     array to store r-dependence of each
*             angular term in the potential
*  variable in common block /coconv/
*    econv:     conversion factor from cm-1 to hartrees
*  variables in common /cosysr/
*    isrcod:    number of real parameters
*    en1d:      asymptotic energy of the 1D state (cm-1)
* 
* author:  paul dagdigian
* latest revision date:  1-mar-2016
* ----------------------------------------------------------------------
      implicit double precision (a-h,o-z)
      include "common/parbas"
      common /covvl/ vvl(19)
      dimension rr(85),vl(425),rso(22),somat(154)
      dimension csplel(85,5),csplso(22,12),vecel(85),vecso(22)
      dimension v(19)
*
*  values or R for PE curves
      data rr /
     +  2.6000000e+00, 2.7000000e+00, 2.8000000e+00, 2.9000000e+00, 3.0000000e+00,
     +  3.1000000e+00, 3.2000000e+00, 3.3000000e+00, 3.4000000e+00, 3.5000000e+00,
     +  3.6000000e+00, 3.7000000e+00, 3.8000000e+00, 3.9000000e+00, 4.0000000e+00,
     +  4.1000000e+00, 4.2000000e+00, 4.3000000e+00, 4.4000000e+00, 4.5000000e+00,
     +  4.6000000e+00, 4.7000000e+00, 4.8000000e+00, 5.0000000e+00, 5.1000000e+00,
     +  5.2000000e+00, 5.3000000e+00, 5.4000000e+00, 5.5000000e+00, 5.6000000e+00,
     +  5.7000000e+00, 5.8000000e+00, 5.9000000e+00, 6.0000000e+00, 6.1000000e+00,
     +  6.2000000e+00, 6.3000000e+00, 6.4000000e+00, 6.5000000e+00, 6.6000000e+00,
     +  6.7000000e+00, 6.8000000e+00, 6.9000000e+00, 7.0000000e+00, 7.1000000e+00,
     +  7.2000000e+00, 7.3000000e+00, 7.4000000e+00, 7.5000000e+00, 7.6000000e+00,
     +  7.7000000e+00, 7.8000000e+00, 7.9000000e+00, 8.0000000e+00, 8.2500000e+00,
     +  8.5000000e+00, 8.7500000e+00, 9.0000000e+00, 9.2500000e+00, 9.5000000e+00,
     +  9.7500000e+00, 1.0000000e+01, 1.0250000e+01, 1.0500000e+01, 1.0750000e+01,
     +  1.1000000e+01, 1.1250000e+01, 1.1500000e+01, 1.1750000e+01, 1.2000000e+01,
     +  1.2500000e+01, 1.3000000e+01, 1.3500000e+01, 1.4000000e+01, 1.5000000e+01,
     +  1.6000000e+01, 1.7000000e+01, 1.8000000e+01, 1.9000000e+01, 2.0000000e+01,
     +  2.2000000e+01, 2.4000000e+01, 2.6000000e+01, 2.8000000e+01, 3.0000000e+01/
*  values of the 5 PE curves
      data vl /  
C       1Sigma  UCCSD(T)
     +  2.7663948e+04, 2.2580366e+04, 1.8978754e+04, 1.6474231e+04, 1.4787704e+04,
     +  1.3714085e+04, 1.3098868e+04, 1.2822044e+04, 1.2787946e+04, 1.2919368e+04,
     +  1.3154339e+04, 1.3444265e+04, 1.3752604e+04, 1.4053553e+04, 1.4330560e+04,
     +  1.4574636e+04, 1.4782554e+04, 1.4955116e+04, 1.5095615e+04, 1.5208586e+04,
     +  1.5298908e+04, 1.5371213e+04, 1.5429558e+04, 1.5517097e+04, 1.5550969e+04,
     +  1.5580413e+04, 1.5606505e+04, 1.5630004e+04, 1.5651432e+04, 1.5671146e+04,
     +  1.5689386e+04, 1.5706317e+04, 1.5722053e+04, 1.5736679e+04, 1.5750263e+04,
     +  1.5762860e+04, 1.5774524e+04, 1.5785305e+04, 1.5795251e+04, 1.5804412e+04,
     +  1.5812837e+04, 1.5820572e+04, 1.5827667e+04, 1.5834166e+04, 1.5840114e+04,
     +  1.5845554e+04, 1.5850526e+04, 1.5855067e+04, 1.5859213e+04, 1.5862998e+04,
     +  1.5866452e+04, 1.5869604e+04, 1.5872481e+04, 1.5875108e+04, 1.5880723e+04,
     +  1.5885217e+04, 1.5888834e+04, 1.5891769e+04, 1.5894167e+04, 1.5896136e+04,
     +  1.5897760e+04, 1.5899103e+04, 1.5900215e+04, 1.5901139e+04, 1.5901909e+04,
     +  1.5902553e+04, 1.5903096e+04, 1.5903555e+04, 1.5903946e+04, 1.5904280e+04,
     +  1.5904813e+04, 1.5905209e+04, 1.5905508e+04, 1.5905735e+04, 1.5906048e+04,
     +  1.5906241e+04, 1.5906365e+04, 1.5906446e+04, 1.5906501e+04, 1.5906539e+04,
     +  1.5906584e+04, 1.5906608e+04, 1.5906621e+04, 1.5906629e+04, 1.5906641e+04,
C      1Pi   MRCISD+Q
     +  7.5588884e+04, 6.6965482e+04, 5.9424930e+04, 5.2803896e+04, 4.7024473e+04,
     +  4.2029635e+04, 3.7755913e+04, 3.4129505e+04, 3.1071306e+04, 2.8503091e+04,
     +  2.6352052e+04, 2.4553251e+04, 2.3050416e+04, 2.1795684e+04, 2.0748781e+04,
     +  1.9876003e+04, 1.9149186e+04, 1.8544775e+04, 1.8043040e+04, 1.7627410e+04,
     +  1.7283949e+04, 1.7000915e+04, 1.6768407e+04, 1.6422885e+04, 1.6296900e+04,
     +  1.6195132e+04, 1.6113388e+04, 1.6048151e+04, 1.5996477e+04, 1.5955908e+04,
     +  1.5924396e+04, 1.5900239e+04, 1.5882029e+04, 1.5868602e+04, 1.5858999e+04,
     +  1.5852433e+04, 1.5848263e+04, 1.5845962e+04, 1.5845107e+04, 1.5845354e+04,
     +  1.5846426e+04, 1.5848102e+04, 1.5850206e+04, 1.5852599e+04, 1.5855172e+04,
     +  1.5857840e+04, 1.5860539e+04, 1.5863219e+04, 1.5865844e+04, 1.5868388e+04,
     +  1.5870831e+04, 1.5873163e+04, 1.5875375e+04, 1.5877465e+04, 1.5882153e+04,
     +  1.5886115e+04, 1.5889428e+04, 1.5892182e+04, 1.5894464e+04, 1.5896354e+04,
     +  1.5897922e+04, 1.5899223e+04, 1.5900306e+04, 1.5901211e+04, 1.5901970e+04,
     +  1.5902608e+04, 1.5903146e+04, 1.5903602e+04, 1.5903990e+04, 1.5904321e+04,
     +  1.5904849e+04, 1.5905242e+04, 1.5905538e+04, 1.5905763e+04, 1.5906072e+04,
     +  1.5906261e+04, 1.5906382e+04, 1.5906462e+04, 1.5906515e+04, 1.5906551e+04,
     +  1.5906595e+04, 1.5906618e+04, 1.5906630e+04, 1.5906638e+04, 1.5906641e+04,
C      1Delta  UCCSD(T)
     +  6.5795134e+04, 6.2133729e+04, 5.8478030e+04, 5.4870704e+04, 5.1350075e+04,
     +  4.7949590e+04, 4.4697479e+04, 4.1616592e+04, 3.8724419e+04, 3.6033248e+04,
     +  3.3550473e+04, 3.1278996e+04, 2.9217713e+04, 2.7362055e+04, 2.5704556e+04,
     +  2.4193409e+04, 2.2961914e+04, 2.1837871e+04, 2.0849154e+04, 1.9997209e+04,
     +  1.9272546e+04, 1.8661616e+04, 1.8149982e+04, 1.7370334e+04, 1.7078413e+04,
     +  1.6838214e+04, 1.6641299e+04, 1.6480466e+04, 1.6349606e+04, 1.6243567e+04,
     +  1.6158022e+04, 1.6089349e+04, 1.6034529e+04, 1.5991047e+04, 1.5956820e+04,
     +  1.5930121e+04, 1.5909527e+04, 1.5893863e+04, 1.5882165e+04, 1.5873642e+04,
     +  1.5867646e+04, 1.5863650e+04, 1.5861225e+04, 1.5860022e+04, 1.5859759e+04,
     +  1.5860210e+04, 1.5861193e+04, 1.5862562e+04, 1.5864201e+04, 1.5866021e+04,
     +  1.5867950e+04, 1.5869931e+04, 1.5871924e+04, 1.5873896e+04, 1.5878594e+04,
     +  1.5882814e+04, 1.5886488e+04, 1.5889626e+04, 1.5892276e+04, 1.5894496e+04,
     +  1.5896350e+04, 1.5897895e+04, 1.5899184e+04, 1.5900260e+04, 1.5901161e+04,
     +  1.5901918e+04, 1.5902556e+04, 1.5903095e+04, 1.5903552e+04, 1.5903942e+04,
     +  1.5904561e+04, 1.5905020e+04, 1.5905365e+04, 1.5905626e+04, 1.5905983e+04,
     +  1.5906201e+04, 1.5906339e+04, 1.5906429e+04, 1.5906490e+04, 1.5906531e+04,
     +  1.5906580e+04, 1.5906605e+04, 1.5906620e+04, 1.5906628e+04, 1.5906641e+04,
C     3Sigma UCCSD(T)
     +  1.1399170e+05, 1.0217529e+05, 9.0704047e+04, 7.9691092e+04, 6.9335572e+04,
     +  5.9813207e+04, 5.1229840e+04, 4.3618507e+04, 3.6955892e+04, 3.1182331e+04,
     +  2.6218524e+04, 2.1977432e+04, 1.8371916e+04, 1.5319238e+04, 1.2743433e+04,
     +  1.0576321e+04, 8.7576779e+03, 7.2349332e+03, 5.9625950e+03, 4.9015646e+03,
     +  4.0184145e+03, 3.2846853e+03, 2.6762297e+03, 1.7565972e+03, 1.4136441e+03,
     +  1.1315403e+03, 9.0003089e+02, 7.1052200e+02, 5.5582256e+02, 4.2992445e+02,
     +  3.2781523e+02, 2.4531920e+02, 1.7896263e+02, 1.2585987e+02, 8.3617189e+01,
     +  5.0251731e+01, 2.4123408e+01, 3.8776960e+00,-1.1602306e+01,-2.3235968e+01,
     + -3.1778712e+01,-3.7849978e+01,-4.1956659e+01,-4.4512523e+01,-4.5854461e+01,
     + -4.6255958e+01,-4.5938291e+01,-4.5079868e+01,-4.3823829e+01,-4.2284528e+01,
     + -4.0552707e+01,-3.8699904e+01,-3.6782025e+01,-3.4842300e+01,-3.0093985e+01,
     + -2.5714309e+01,-2.1834170e+01,-1.8480167e+01,-1.5625528e+01,-1.3219340e+01,
     + -1.1202773e+01,-9.5176320e+00,-8.1105730e+00,-6.9347920e+00,-5.9504190e+00,
     + -5.1240650e+00,-4.4282150e+00,-3.8401910e+00,-3.3415270e+00,-2.9171560e+00,
     + -2.2438840e+00,-1.7460740e+00,-1.3731820e+00,-1.0904880e+00,-7.0594900e-01,
     + -4.7124400e-01,-3.2301400e-01,-2.2659500e-01,-1.6223000e-01,-1.1827200e-01,
     + -6.5889000e-02,-3.8701000e-02,-2.3757000e-02,-1.5139000e-02,-9.9550000e-03,
C       3Pi  UCCSD(T)
     +  6.5480054e+04, 5.6569484e+04, 4.8652939e+04, 4.1601791e+04, 3.5363047e+04,
     +  2.9897263e+04, 2.5155203e+04, 2.1075307e+04, 1.7588748e+04, 1.4625315e+04,
     +  1.2117696e+04, 1.0003878e+04, 8.2281627e+03, 6.7413157e+03, 5.5002731e+03,
     +  4.4676400e+03, 3.6111230e+03, 2.9029619e+03, 2.3193908e+03, 1.8401394e+03,
     +  1.4479802e+03, 1.1283193e+03, 8.6883236e+02, 4.9053245e+02, 3.5570871e+02,
     +  2.4857731e+02, 1.6406510e+02, 9.7960090e+01, 4.6775616e+01, 7.6340360e+00,
     + -2.1832459e+01,-4.3566049e+01,-5.9154669e+01,-6.9892343e+01,-7.6829845e+01,
     + -8.0817261e+01,-8.2539546e+01,-8.2546199e+01,-8.1275902e+01,-7.9076958e+01,
     + -7.6224206e+01,-7.2932959e+01,-6.9370487e+01,-6.5665439e+01,-6.1915530e+01,
     + -5.8193848e+01,-5.4553953e+01,-5.1034033e+01,-4.7660225e+01,-4.4449322e+01,
     + -4.1410921e+01,-3.8549146e+01,-3.5864010e+01,-3.3352490e+01,-2.7795577e+01,
     + -2.3174416e+01,-1.9356455e+01,-1.6211822e+01,-1.3623562e+01,-1.1491164e+01,
     + -9.7306590e+00,-8.2730530e+00,-7.0621930e+00,-6.0526250e+00,-5.2076450e+00,
     + -4.4975800e+00,-3.8985500e+00,-3.3911400e+00,-2.9596730e+00,-2.5913510e+00,
     + -2.0045430e+00,-1.5679410e+00,-1.2389450e+00,-9.8812500e-01,-6.4445900e-01,
     + -4.3284900e-01,-2.9822200e-01,-2.1010100e-01,-1.5096900e-01,-1.1040200e-01,
     + -6.1810000e-02,-3.6444000e-02,-2.2435000e-02,-1.4329000e-02,-9.4400000e-03/ 
*  values or R for spin-orbit matrix elements
      data rso /  
     +  2.500,  2.600,  2.700,  2.800,  2.900,
     +  3.000,  3.250,  3.500,  3.750,  4.000,
     +  4.250,  4.500,  4.750,  5.000,  5.250,
     +  5.500,  6.000,  6.500,  7.000,  7.500,
     +  8.000,  8.500 /
*  values of Axy and Azy - spin-orbit matrix elements within 3P state
*  then values of the B spin-orbit matrix elements, coupling the 1D and 3P states
       data somat /  
C Axy
     +   1.7957297e+02, 1.5936413e+02, 1.4071868e+02, 1.2555362e+02, 1.1405022e+02,
     +   1.0550798e+02, 9.2373385e+01, 8.5554168e+01, 8.1781424e+01, 7.9629375e+01,
     +   7.8390756e+01, 7.7679844e+01, 7.7276049e+01, 7.7049459e+01, 7.6924527e+01,
     +   7.6857153e+01, 7.6804021e+01, 7.6791720e+01, 7.6790160e+01, 7.6791014e+01,
     +   7.6792077e+01, 7.6792832e+01,
C Axz 
     +  -5.6037463e+01,-4.9658136e+01,-4.0210022e+01,-2.9171092e+01,-1.7993150e+01,
     +  -7.5255130e+00, 1.3797519e+01, 2.8431436e+01, 3.7991583e+01, 4.4082379e+01,
     +   4.7913049e+01, 5.0308754e+01, 5.1803221e+01, 5.2736054e+01, 5.3318589e+01,
     +   5.3682831e+01, 5.4054347e+01, 5.4201698e+01, 5.4260578e+01, 5.4284035e+01,
     +   5.4293443e+01, 5.4297439e+01,
C Bss  
     +   1.4055219e+01, 1.3850714e+01, 1.4023482e+01, 1.4694743e+01, 1.5911604e+01,
     +   1.7668881e+01, 2.4288361e+01, 3.3632747e+01, 4.4430759e+01, 5.4779308e+01,
     +   6.3240669e+01, 6.9442008e+01, 7.3709134e+01, 7.6547908e+01, 7.8403136e+01,
     +   7.9602961e+01, 8.0864439e+01, 8.1369561e+01, 8.1563633e+01, 8.1635966e+01,
     +   8.1663148e+01, 8.1673448e+01,
C Byx 
     +   1.7705363e+02, 1.5704630e+02, 1.3839862e+02, 1.2302636e+02, 1.1118172e+02,
     +   1.0224148e+02, 8.8159190e+01, 8.0643949e+01, 7.6422488e+01, 7.3998676e+01,
     +   7.2601601e+01, 7.1800837e+01, 7.1347472e+01, 7.1094337e+01, 7.0955780e+01,
     +   7.0881827e+01, 7.0824800e+01, 7.0812525e+01, 7.0811565e+01, 7.0812885e+01,
     +   7.0814200e+01, 7.0815051e+01,
C Bxs  
     +  -6.0475712e+01,-5.1991842e+01,-4.0874927e+01,-2.8755416e+01,-1.6918944e+01,
     +  -6.0589220e+00, 1.5445523e+01, 2.8829104e+01, 3.5280736e+01, 3.6880779e+01,
     +   3.5973055e+01, 3.4287655e+01, 3.2679943e+01, 3.1426907e+01, 3.0536148e+01,
     +   2.9933826e+01, 2.9284392e+01, 2.9024250e+01, 2.8880500e+01, 2.8892878e+01,
     +   2.8834202e+01, 2.8876470e+01,
C Bsy  
     +  -6.1885414e+01,-5.6180250e+01,-4.7218746e+01,-3.6448264e+01,-2.5365227e+01,
     +  -1.4874870e+01, 6.8081800e+00, 2.2027213e+01, 3.2203249e+01, 3.8812840e+01,
     +   4.3023476e+01, 4.5674034e+01, 4.7330380e+01, 4.8362703e+01, 4.9005182e+01,
     +   4.9405098e+01, 4.9810014e+01, 4.9968824e+01, 5.0031746e+01, 5.0056707e+01,
     +   5.0066620e+01, 5.0070691e+01,
C Bxd  
     +  -5.9619721e+01,-5.4525340e+01,-4.6194224e+01,-3.5872255e+01,-2.4970812e+01,
     +  -1.4442809e+01, 7.6689860e+00, 2.3113507e+01, 3.3204488e+01, 3.9592684e+01,
     +   4.3576767e+01, 4.6046535e+01, 4.7573819e+01, 4.8519191e+01, 4.9104838e+01,
     +   4.9468231e+01, 4.9835236e+01, 4.9978973e+01, 5.0035800e+01, 5.0058198e+01,
     +   5.0067063e+01, 5.0070778e+01/
*
*  set vv0 term to zero
      vv0 = 0.d0
*
*  spline fits
      if (ifirst .eq. 0) then
*  spline fit of the coefficients for the PE curves
        indel=1
        do ilam=1,5
          call dcopy(85,vl(indel),1,vecel,1)
*  evaluate derivative at first point
          der1=(vecel(2)-vecel(1))/(rr(2)-rr(1))
          call dspline(rr,vecel,85,der1,0d0,csplel(1,ilam))
          indel = indel + 85
        enddo
*  spline fit of the coefficients for the spin-orbit matrix elements
        indso=1
        do ilam=6,12
          call dcopy(22,somat(indso),1,vecso,1)
*  evaluate derivative at first point
          der1=(vecso(2)-vecso(1))/(rso(2)-rso(1))
          call dspline(rso,vecso,22,der1,0d0,csplso(1,ilam))
          indso = indso + 22
        enddo
        ifirst = 1
      end if
*  determine splined coefficients for PE curves at r=R
      indel=1
      do ilam=1,5
        call dcopy(85,vl(indel),1,vecel,1)
        call dsplint(rr,vecel,csplel(1,ilam),85,r,vvx)
        v(ilam) = vvx
        call dcopy(85,vl(indel),1,vecel,1)
        indel = indel + 85
*  shift singlet PE curves to E=0 at large R
        if (ilam .le. 3) then
          v(ilam) = v(ilam) - 15906.642d0
       endif
*  fix long-range behavior of PE curves to go to zero at large R
        if (r.gt.20.d0) then
          vvv = vl(indel-4)
          if (ilam .le. 3) vvv = (vvv - 15906.642d0)
          c6 = vvv * rr(81)**6
          switch_lr = 0.5*(tanh(0.5*(r - 25.d0)) + 1.d0)
          v(ilam) = (1.d0 - switch_lr) * v(ilam) 
     :      + switch_lr * c6 / (r**6)
        endif
      enddo
*  determine splined coefficients for spin-orbit matrix elements at r=R
      indso=1
      do ilam=6,12
        call dcopy(22,somat(indso),1,vecso,1)
        call dsplint(rso,vecso,csplso(1,ilam),22,r,vvx)
        v(ilam) = vvx
        call dcopy(22,somat(indso),1,vecso,1)
        indso = indso + 22
*  if r≥8.5 bohr, set equal to SO matrix element at R=8.5
        if (r.ge.8.5d0) v(ilam) = somat(indso-1)
*  get value of spin-orbit parameter at R=inf
        v(ilam+7) = somat(indso-1)
      enddo
      call dcopy(19,v,1,vvl,1)
* convert to hartree
      econv=1.d0/219474.6d0
      call dscal(19,econv,vvl,1)
      return
      end
*===================================eof====================================
