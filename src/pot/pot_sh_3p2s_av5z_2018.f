*  System:  S(3P) + H(2S)
*
*   calculation of potential energy curves and spin-orbit matrix
*   elements, taken from m. alexander's notes (2018)
*
*   MRCI+Q calculation with av5z basis (m.alexander, sep-2018)
*
*   two spin-orbit matrix parameters are included:  apar and aperp
*   the atomic spin-orbit splittings are computed from the large-R
*   values of these parameters.
*   here, the atomic values (apar = aperp) are used for all R
*  
*   written by p. dagdigian
*   current revision date:  6-sep-2018
*
      include "common/syusr"
      include "common/bausr"
      include "common/ground"
* --------------------------------------------------------------------------
      subroutine loapot(iunit,filnam)
* --------------------------------------------------------------------------
      character*(*) filnam
      common /coselb/ ibasty
      include "common/parbas"
      include "common/parpot"
      common /conlam/ nlam, nlammx, lamnum(1)
      potnam='S(3P)-H(2S) av5z 2018'
      npot=1
      ibasty=23
      lammin(1)=1
      lammax(1)=6
      mproj(1)=0
      ntv(1)=1
      ivcol(1,1)=0
      ivrow(1,1)=0
*  count number of anisotropic terms
      nlam = 0
      do il = lammin(1), lammax(1)
        nlam = nlam + 1
      enddo
      return
      end
* --------------------------------------------------------------------------
      subroutine driver
      implicit double precision (a-h,o-z)
      common /cosysi/ junk(5), npot
      common /covvl/ vvl(8)
      include "common/parpot"
      potnam='S(3P)-H(2S) avqz 2018'
      econv=219474.6d0
      print *, potnam
1     print *, 'R (bohr):'
      read (5, *, end=99) r
      if (r.le.0.d0) goto 99
      call pot(vv0,r)
      write (6, 100) (econv*vvl(i), i=1,6)
100   format('  ',6(1pe16.8))
      goto 1
99    rr= 1.075d0
      dr=0.2d0
      open (unit=12,file='sh_vlms_av5z_so_const.txt')
      write(12,109)
109   format(' %R/bohr X2Pi  4Pi  2Sig-  4Sig-  apar   aperp')
      do i=1,426
        call pot(vv0,rr)
        write (12,110) rr,(econv*vvl(j),j=1,6)
110     format(f11.5,6(1pe16.8))
        rr = rr + dr
      enddo
      close(12)
      end
* --------------------------------------------------------------------------
      subroutine pot (vv0, r)
*  subroutine to calculate the r-dependent coefficients
*  in atomic units (distance and energy)
* ----------------------------------------------------------------------
*  on entry:
*    r:      interparticle distance
*  on return:
*    vv0        (not used)
*    vvl(1,4)   contains the X2Pi, 4Pi, 2Sig-, 4Sig- energies
*    vvl(5,6)   contains the spin-orbit matrix parameters apar and aperp at R
*  variable in common block /conlam/ used here
*    nlam:      the number of angular coupling terms actually used
*  variable in common block /covvl/
*    vvl:       array to store r-dependence of each
*               angular term in the potential
*  variable in common block /coconv/
*    econv:     conversion factor from cm-1 to hartrees
* 
* author:  paul dagdigian
* latest revision date:  31-aug-2018
* ----------------------------------------------------------------------
      implicit double precision (a-h,o-z)
      include "common/parbas"
      common /covvl/ vvl(6)
      dimension rr(376),v2pi(376),v4pi(376),v2sigm(376),v4sigm(376)
      dimension vl(376), vec(376), v(6)
      data npts / 186 /
*
c  number of r values= 186
      data rr /
     +  1.134,  1.209,  1.285,  1.361,  1.436,
     +  1.512,  1.587,  1.663,  1.739,  1.814,
     +  1.890,  1.965,  2.041,  2.116,  2.192,
     +  2.268,  2.343,  2.419,  2.494,  2.570,
     +  2.646,  2.721,  2.797,  2.872,  2.948,
     +  3.024,  3.099,  3.175,  3.250,  3.326,
     +  3.402,  3.477,  3.553,  3.628,  3.704,
     +  3.779,  3.855,  3.931,  4.006,  4.082,
     +  4.157,  4.233,  4.309,  4.384,  4.460,
     +  4.535,  4.611,  4.687,  4.762,  4.838,
     +  4.913,  4.989,  5.064,  5.140,  5.216,
     +  5.291,  5.367,  5.442,  5.518,  5.594,
     +  5.669,  5.745,  5.820,  5.896,  5.972,
     +  6.047,  6.123,  6.198,  6.274,  6.349,
     +  6.425,  6.501,  6.576,  6.652,  6.727,
     +  6.803,  6.879,  6.954,  7.030,  7.105,
     +  7.181,  7.257,  7.332,  7.408,  7.483,
     +  7.559,  7.634,  7.710,  7.786,  7.861,
     +  7.937,  8.012,  8.088,  8.164,  8.239,
     +  8.315,  8.390,  8.466,  8.542,  8.617,
     +  8.693,  8.768,  8.844,  8.920,  8.995,
     +  9.071,  9.146,  9.222,  9.297,  9.373,
     +  9.449,  9.524,  9.600,  9.675,  9.751,
     +  9.827,  9.902,  9.978, 10.053, 10.129,
     + 10.205, 10.280, 10.356, 10.431, 10.507,
     + 10.582, 10.658, 10.734, 10.809, 10.885,
     + 10.960, 11.036, 11.112, 11.187, 11.263,
     + 11.338, 11.414, 11.490, 11.565, 11.641,
     + 11.716, 11.792, 11.867, 11.943, 12.019,
     + 12.094, 12.170, 12.245, 12.321, 12.397,
     + 12.472, 12.548, 12.623, 12.699, 12.775,
     + 12.850, 12.926, 13.001, 13.077, 13.152,
     + 13.228, 13.304, 13.379, 13.455, 13.530,
     + 13.606, 13.682, 13.757, 13.833, 13.908,
     + 13.984, 14.060, 14.135, 14.211, 14.286,
     + 14.362, 14.438, 14.513, 14.589, 14.664,
     + 14.740, 14.815, 14.891, 14.967, 15.042,
     + 15.118  /
c  X2Pi
      data v2pi /
     +  2.6608473d+05,  2.0611799d+05,  1.5774216d+05,  1.1850035d+05,
     +  8.6555370d+04,  6.0689731d+04,  3.9779825d+04,  2.2969826d+04,
     +  9.4779533d+03, -1.3142856d+03, -9.8620912d+03, -1.6583880d+04,
     + -2.1779326d+04, -2.5716762d+04, -2.8626398d+04, -3.0700327d+04,
     + -3.2111346d+04, -3.2961727d+04, -3.3336361d+04, -3.3325289d+04,
     + -3.3007817d+04, -3.2444535d+04, -3.1685275d+04, -3.0772439d+04,
     + -2.9740380d+04, -2.8617864d+04, -2.7431699d+04, -2.6201842d+04,
     + -2.4946406d+04, -2.3680461d+04, -2.2416038d+04, -2.1164311d+04,
     + -1.9933547d+04, -1.8731225d+04, -1.7563435d+04, -1.6434873d+04,
     + -1.5349803d+04, -1.4310997d+04, -1.3320827d+04, -1.2381029d+04,
     + -1.1492700d+04, -1.0656527d+04, -9.8716741d+03, -9.1369207d+03,
     + -8.4510474d+03, -7.8128349d+03, -7.2207869d+03, -6.6723009d+03,
     + -6.1644978d+03, -5.6944984d+03, -5.2594235d+03, -4.8564741d+03,
     + -4.4831719d+03, -4.1371189d+03, -3.8159171d+03, -3.5171683d+03,
     + -3.2386778d+03, -2.9790650d+03, -2.7371523d+03, -2.5117624d+03,
     + -2.3017179d+03, -2.1059371d+03, -1.9237204d+03, -1.7544640d+03,
     + -1.5975642d+03, -1.4524171d+03, -1.3184324d+03, -1.1950743d+03,
     + -1.0818208d+03, -9.7814975d+02, -8.8353890d+02, -7.9744865d+02,
     + -7.1926941d+02, -6.4837411d+02, -5.8413566d+02, -5.2592698d+02,
     + -4.7316648d+02, -4.2545446d+02, -3.8243670d+02, -3.4375900d+02,
     + -3.0906713d+02, -2.7800690d+02, -2.5022407d+02, -2.2536444d+02,
     + -2.0307380d+02, -1.8299792d+02, -1.6482090d+02, -1.4837996d+02,
     + -1.3355065d+02, -1.2020849d+02, -1.0822903d+02, -9.7487798d+01,
     + -8.7860323d+01, -7.9222141d+01, -7.1448787d+01, -6.4415795d+01,
     + -5.8012871d+01, -5.2186415d+01, -4.6896999d+01, -4.2105196d+01,
     + -3.7771578d+01, -3.3856718d+01, -3.0321187d+01, -2.7125560d+01,
     + -2.4230406d+01, -2.1596301d+01, -1.9188766d+01, -1.6993134d+01,
     + -1.4999687d+01, -1.3198708d+01, -1.1580478d+01, -1.0135282d+01,
     + -8.8534004d+00, -7.7251170d+00, -6.7407141d+00, -5.8904743d+00,
     + -5.1646803d+00, -4.5536145d+00, -4.0475597d+00, -3.6367983d+00,
     + -3.3116131d+00, -3.0622865d+00, -2.8791012d+00, -2.7524136d+00,
     + -2.6742775d+00, -2.6384439d+00, -2.6387376d+00, -2.6689838d+00,
     + -2.7230071d+00, -2.7946326d+00, -2.8776850d+00, -2.9659894d+00,
     + -3.0533706d+00, -3.1336535d+00, -3.2006631d+00, -3.2482241d+00,
     + -3.2715259d+00, -3.2712156d+00, -3.2493046d+00, -3.2078044d+00,
     + -3.1487263d+00, -3.0740818d+00, -2.9858825d+00, -2.8861396d+00,
     + -2.7768647d+00, -2.6600693d+00, -2.5377647d+00, -2.4119624d+00,
     + -2.2846450d+00, -2.1571301d+00, -2.0300707d+00, -1.9040906d+00,
     + -1.7798138d+00, -1.6578643d+00, -1.5388660d+00, -1.4234429d+00,
     + -1.3122189d+00, -1.2058180d+00, -1.1048641d+00, -1.0099813d+00,
     + -9.2179333d-01, -8.4074332d-01, -7.6655031d-01, -6.9875238d-01,
     + -6.3688764d-01, -5.8049419d-01, -5.2911011d-01, -4.8227351d-01,
     + -4.3952247d-01, -4.0039511d-01, -3.6442951d-01, -3.3116377d-01,
     + -3.0013598d-01, -2.7088425d-01, -2.4294667d-01, -2.1586134d-01,
     + -1.8916634d-01, -1.6239979d-01, -1.3509977d-01, -1.0680438d-01,
     + -7.7051719d-02, -4.5379882d-02, -1.1326965d-02,  2.5568935d-02,
     +  1.5042223d+01,  1.5117812d+01  /
c  4Pi
      data v4pi /
     +  3.5412075d+05,  2.9474087d+05,  2.4682987d+05,  2.0795184d+05,
     +  1.7627881d+05,  1.5059081d+05,  1.2976242d+05,  1.1294080d+05,
     +  9.9347121d+04,  8.8337670d+04,  7.9403825d+04,  7.2082260d+04,
     +  6.6067310d+04,  6.1082892d+04,  5.6626829d+04,  5.1970839d+04,
     +  4.6675148d+04,  4.1493317d+04,  3.7421254d+04,  3.4204607d+04,
     +  3.1162935d+04,  2.8377799d+04,  2.5800743d+04,  2.3401504d+04,
     +  2.1175233d+04,  1.9110773d+04,  1.7197411d+04,  1.5427372d+04,
     +  1.3793603d+04,  1.2288844d+04,  1.0905627d+04,  9.6365655d+03,
     +  8.4746267d+03,  7.4128776d+03,  6.4446298d+03,  5.5634397d+03,
     +  4.7630210d+03,  4.0376741d+03,  3.3818597d+03,  2.7903567d+03,
     +  2.2582619d+03,  1.7809166d+03,  1.3545836d+03,  9.7575657d+02,
     +  6.4092896d+02,  3.4659429d+02,  8.9438215d+01, -1.3308505d+02,
     + -3.2332915d+02, -4.8364772d+02, -6.1639441d+02, -7.2387840d+02,
     + -8.0823093d+02, -8.7153879d+02, -9.1588878d+02, -9.4336767d+02,
     + -9.5601285d+02, -9.5566402d+02, -9.4411148d+02, -9.2314555d+02,
     + -8.9455652d+02, -8.6003638d+02, -8.2088385d+02, -7.7829932d+02,
     + -7.3348319d+02, -6.8763587d+02, -6.4183489d+02, -5.9666636d+02,
     + -5.5259351d+02, -5.1007960d+02, -4.6958785d+02, -4.3149617d+02,
     + -3.9584106d+02, -3.6257366d+02, -3.3164514d+02, -3.0300663d+02,
     + -2.7659698d+02, -2.5230572d+02, -2.3001007d+02, -2.0958725d+02,
     + -1.9091447d+02, -1.7386896d+02, -1.5832793d+02, -1.4416860d+02,
     + -1.3126819d+02, -1.1950392d+02, -1.0876237d+02, -9.8967597d+01,
     + -9.0053026d+01, -8.1952078d+01, -7.4598178d+01, -6.7924749d+01,
     + -6.1865212d+01, -5.6352993d+01, -5.1321512d+01, -4.6704195d+01,
     + -4.2442436d+01, -3.8509525d+01, -3.4886724d+01, -3.1555293d+01,
     + -2.8496496d+01, -2.5691594d+01, -2.3121849d+01, -2.0768523d+01,
     + -1.8612878d+01, -1.6636175d+01, -1.4821739d+01, -1.3161144d+01,
     + -1.1648030d+01, -1.0276031d+01, -9.0387871d+00, -7.9299345d+00,
     + -6.9431108d+00, -6.0719536d+00, -5.3101002d+00, -4.6511881d+00,
     + -4.0888546d+00, -3.6167373d+00, -3.2284736d+00, -2.9177009d+00,
     + -2.6780565d+00, -2.5031781d+00, -2.3867029d+00, -2.3222600d+00,
     + -2.3032843d+00, -2.3230168d+00, -2.3746899d+00, -2.4515361d+00,
     + -2.5467878d+00, -2.6536777d+00, -2.7654380d+00, -2.8753013d+00,
     + -2.9765002d+00, -3.0622669d+00, -3.1258341d+00, -3.1604342d+00,
     + -3.1610685d+00, -3.1298132d+00, -3.0705136d+00, -2.9870146d+00,
     + -2.8831614d+00, -2.7627991d+00, -2.6297727d+00, -2.4879275d+00,
     + -2.3411084d+00, -2.1931607d+00, -2.0479293d+00, -1.9092594d+00,
     + -1.7808953d+00, -1.6642625d+00, -1.5584676d+00, -1.4625165d+00,
     + -1.3754152d+00, -1.2961694d+00, -1.2237850d+00, -1.1572680d+00,
     + -1.0956242d+00, -1.0378595d+00, -9.8297967d-01, -9.2999069d-01,
     + -8.7789841d-01, -8.2589629d-01, -7.7392813d-01, -7.2212536d-01,
     + -6.7061936d-01, -6.1954153d-01, -5.6902329d-01, -5.1919604d-01,
     + -4.7019117d-01, -4.2214009d-01, -3.7517420d-01, -3.2942491d-01,
     + -2.8502361d-01, -2.4210172d-01, -2.0079063d-01, -1.6122174d-01,
     + -1.2352646d-01, -8.7836188d-02, -5.4282330d-02, -2.2996288d-02,
     +  5.8905361d-03,  3.2246740d-02,  5.5940921d-02,  7.6841676d-02,
     +  1.5042223d+01,  1.5117812d+01  /
c  2Sigma-
      data v2sigm /
     +  3.2352634d+05,  2.6315128d+05,  2.1449506d+05,  1.7505230d+05,
     +  1.4295284d+05,  1.1696175d+05,  9.5939916d+04,  7.9021170d+04,
     +  6.5414824d+04,  5.4497615d+04,  4.5813699d+04,  3.8931759d+04,
     +  3.3489478d+04,  2.9148584d+04,  2.5727042d+04,  2.3199058d+04,
     +  2.1462514d+04,  2.0082832d+04,  1.8565006d+04,  1.6923126d+04,
     +  1.5399457d+04,  1.3975344d+04,  1.2657457d+04,  1.1443407d+04,
     +  1.0323398d+04,  9.2900526d+03,  8.3362982d+03,  7.4558371d+03,
     +  6.6426007d+03,  5.8913300d+03,  5.1975755d+03,  4.5570790d+03,
     +  3.9662066d+03,  3.4214950d+03,  2.9198165d+03,  2.4583789d+03,
     +  2.0345035d+03,  1.6459085d+03,  1.2904193d+03,  9.6605360d+02,
     +  6.7102164d+02,  4.0363811d+02,  1.6260268d+02, -5.3288737d+01,
     + -2.4524021d+02, -4.1445583d+02, -5.6209061d+02, -6.8910324d+02,
     + -7.9640336d+02, -8.8490061d+02, -9.5550462d+02, -1.0091854d+03,
     + -1.0471543d+03, -1.0706832d+03, -1.0810437d+03, -1.0795078d+03,
     + -1.0673633d+03, -1.0459633d+03, -1.0166769d+03, -9.8087337d+02,
     + -9.3992192d+02, -8.9512455d+02, -8.4751447d+02, -7.9805773d+02,
     + -7.4772034d+02, -6.9746833d+02, -6.4816526d+02, -6.0026477d+02,
     + -5.5411803d+02, -5.1007621d+02, -4.6849048d+02, -4.2963691d+02,
     + -3.9349119d+02, -3.5995392d+02, -3.2892569d+02, -3.0030710d+02,
     + -2.7399328d+02, -2.4985758d+02, -2.2776785d+02, -2.0759197d+02,
     + -1.8919781d+02, -1.7245324d+02, -1.5722614d+02, -1.4338437d+02,
     + -1.3079582d+02, -1.1932834d+02, -1.0886092d+02, -9.9316959d+01,
     + -9.0630959d+01, -8.2737424d+01, -7.5570860d+01, -6.9065770d+01,
     + -6.3156660d+01, -5.7778035d+01, -5.2864398d+01, -4.8350254d+01,
     + -4.4177948d+01, -4.0321181d+01, -3.6761495d+01, -3.3480432d+01,
     + -3.0459532d+01, -2.7680338d+01, -2.5124390d+01, -2.2773232d+01,
     + -2.0608403d+01, -1.8611446d+01, -1.6766081d+01, -1.5064744d+01,
     + -1.3502050d+01, -1.2072613d+01, -1.0771049d+01, -9.5919715d+00,
     + -8.5299966d+00, -7.5797386d+00, -6.7358123d+00, -5.9928326d+00,
     + -5.3454144d+00, -4.7881724d+00, -4.3157214d+00, -3.9226764d+00,
     + -3.6036521d+00, -3.3532633d+00, -3.1661250d+00, -3.0368224d+00,
     + -2.9592615d+00, -2.9266693d+00, -2.9322430d+00, -2.9691801d+00,
     + -3.0306778d+00, -3.1099335d+00, -3.2001445d+00, -3.2945082d+00,
     + -3.3862218d+00, -3.4684828d+00, -3.5344884d+00, -3.5774360d+00,
     + -3.5921139d+00, -3.5796746d+00, -3.5428616d+00, -3.4844182d+00,
     + -3.4070880d+00, -3.3136143d+00, -3.2067408d+00, -3.0892107d+00,
     + -2.9637677d+00, -2.8331550d+00, -2.7001162d+00, -2.5673948d+00,
     + -2.4376758d+00, -2.3123018d+00, -2.1912727d+00, -2.0745302d+00,
     + -1.9620159d+00, -1.8536714d+00, -1.7494383d+00, -1.6492582d+00,
     + -1.5530729d+00, -1.4608238d+00, -1.3724526d+00, -1.2879009d+00,
     + -1.2071103d+00, -1.1300072d+00, -1.0564567d+00, -9.8630872d-01,
     + -9.1941305d-01, -8.5561959d-01, -7.9477818d-01, -7.3673870d-01,
     + -6.8135100d-01, -6.2846496d-01, -5.7793042d-01, -5.2959726d-01,
     + -4.8331533d-01, -4.3893450d-01, -3.9630463d-01, -3.5527559d-01,
     + -3.1569722d-01, -2.7741941d-01, -2.4029200d-01, -2.0416486d-01,
     + -1.6888786d-01, -1.3431085d-01, -1.0028369d-01, -6.6656260d-02,
     +  1.5042223d+01,  1.5117812d+01  /
c  4Sigma-
      data v4sigm /
     +  3.2064690d+05,  2.6032672d+05,  2.1175419d+05,  1.7241206d+05,
     +  1.4042089d+05,  1.1453901d+05,  9.3621863d+04,  7.6802351d+04,
     +  6.3289512d+04,  5.2448195d+04,  4.3799053d+04,  3.6897866d+04,
     +  3.1413806d+04,  2.7044049d+04,  2.3477780d+04,  2.0396192d+04,
     +  1.7553454d+04,  1.4997037d+04,  1.2839262d+04,  1.1003937d+04,
     +  9.3660347d+03,  7.9287846d+03,  6.6659554d+03,  5.5543736d+03,
     +  4.5776105d+03,  3.7196775d+03,  2.9654343d+03,  2.3030663d+03,
     +  1.7216485d+03,  1.2115975d+03,  7.6467145d+02,  3.7305525d+02,
     +  3.0407325d+01, -2.6921201d+02, -5.3097219d+02, -7.5927238d+02,
     + -9.5823695d+02, -1.1310251d+03, -1.2805390d+03, -1.4093168d+03,
     + -1.5195324d+03, -1.6131378d+03, -1.6912593d+03, -1.7548167d+03,
     + -1.8047298d+03, -1.8419186d+03, -1.8672194d+03, -1.8811344d+03,
     + -1.8840825d+03, -1.8764822d+03, -1.8587523d+03, -1.8313723d+03,
     + -1.7950642d+03, -1.7506105d+03, -1.6987939d+03, -1.6403971d+03,
     + -1.5762476d+03, -1.5073528d+03, -1.4347649d+03, -1.3595364d+03,
     + -1.2827193d+03, -1.2053104d+03, -1.1280833d+03, -1.0517562d+03,
     + -9.7704721d+02, -9.0467430d+02, -8.3526938d+02, -7.6911949d+02,
     + -7.0642546d+02, -6.4738813d+02, -5.9220831d+02, -5.4102157d+02,
     + -4.9370233d+02, -4.5005972d+02, -4.0990289d+02, -3.7304098d+02,
     + -3.3928359d+02, -3.0844226d+02, -2.8032898d+02, -2.5475574d+02,
     + -2.3153454d+02, -2.1047737d+02, -1.9139624d+02, -1.7410313d+02,
     + -1.5841004d+02, -1.4412897d+02, -1.3109017d+02, -1.1919694d+02,
     + -1.0837084d+02, -9.8533412d+01, -8.9606222d+01, -8.1510821d+01,
     + -7.4168767d+01, -6.7501614d+01, -6.1430917d+01, -5.5878233d+01,
     + -5.0774031d+01, -4.6084441d+01, -4.1784505d+01, -3.7849267d+01,
     + -3.4253770d+01, -3.0973058d+01, -2.7982174d+01, -2.5256163d+01,
     + -2.2770066d+01, -2.0498928d+01, -1.8420424d+01, -1.6522763d+01,
     + -1.4796786d+01, -1.3233331d+01, -1.1823241d+01, -1.0557355d+01,
     + -9.4265148d+00, -8.4215598d+00, -7.5333311d+00, -6.7526690d+00,
     + -6.0704141d+00, -5.4774069d+00, -4.9644880d+00, -4.5224978d+00,
     + -4.1422769d+00, -3.8146659d+00, -3.5305051d+00, -3.2807984d+00,
     + -3.0603031d+00, -2.8675298d+00, -2.7011528d+00, -2.5598459d+00,
     + -2.4422831d+00, -2.3471386d+00, -2.2730863d+00, -2.2188002d+00,
     + -2.1829544d+00, -2.1642228d+00, -2.1612795d+00, -2.1727985d+00,
     + -2.1971671d+00, -2.2316252d+00, -2.2731264d+00, -2.3186238d+00,
     + -2.3650708d+00, -2.4094207d+00, -2.4486269d+00, -2.4796427d+00,
     + -2.4994213d+00, -2.5049162d+00, -2.4930806d+00, -2.4608679d+00,
     + -2.4053643d+00, -2.3267123d+00, -2.2281111d+00, -2.1128923d+00,
     + -1.9843880d+00, -1.8459300d+00, -1.7008502d+00, -1.5524805d+00,
     + -1.4041526d+00, -1.2591987d+00, -1.1209504d+00, -9.9273966d-01,
     + -8.7789841d-01, -7.7898424d-01, -6.9545778d-01, -6.2600538d-01,
     + -5.6931342d-01, -5.2406827d-01, -4.8895629d-01, -4.6266385d-01,
     + -4.4387732d-01, -4.3128306d-01, -4.2356744d-01, -4.1941684d-01,
     + -4.1751761d-01, -4.1655612d-01, -4.1521874d-01, -4.1219184d-01,
     + -4.0616179d-01, -3.9581495d-01, -3.7983770d-01, -3.5691639d-01,
     + -3.2573739d-01, -2.8498708d-01, -2.3335182d-01, -1.6951797d-01,
     +  1.5042223d+01,  1.5117812d+01  /
*
*  set vv0 term to zero
      vv0 = 0.d0
*
*  spline fits
      if (ifirst .eq. 0) then
*  spline fit of the coefficients for the PE curves
*  evaluate derivative at first point
        der1=(v2pi(2)-v2pi(1))/(rr(2)-rr(1))
        call dspline(rr,v2pi,npts,der1,0d0,cs2p)
*
        der1=(v4pi(2)-v4pi(1))/(rr(2)-rr(1))
        call dspline(rr,v4pi,npts,der1,0d0,cs4p)
*
        der1=(v2sigm(2)-v2sigm(1))/(rr(2)-rr(1))
        call dspline(rr,v2sigm,npts,der1,0d0,cs2s)
*
        der1=(v4sigm(2)-v4sigm(1))/(rr(2)-rr(1))
        call dspline(rr,v4sigm,npts,der1,0d0,cs4s)
        ifirst = 1
      endif
*
*  determine splined coefficients for PE curves at r=R
      call dsplint(rr,v2pi,cs2p,npts,r,vvx)
      v(1) = vvx
*  fix long-range behavior of PE curve as c6/r^6 from last point
      if (r.gt.rr(npts)) then
        c6 = v2pi(npts) * rr(npts)**6
        v(1) = c6 / r**6
      endif
*
      call dsplint(rr,v4pi,cs4p,npts,r,vvx)
      v(2) = vvx
*  fix long-range behavior of PE curve as c6/r^6 from last point
      if (r.gt.rr(npts)) then
        c6 = v4pi(npts) * rr(npts)**6
        v(2) = c6 / r**6
      endif
*
      call dsplint(rr,v2sigm,cs2s,npts,r,vvx)
      v(3) = vvx
*  fix long-range behavior of PE curve as c6/r^6 from last point
      if (r.gt.rr(npts)) then
        c6 = v2sigm(npts) * rr(npts)**6
        v(3) = c6 / r**6
      endif
*
      call dsplint(rr,v4sigm,cs4s,npts,r,vvx)
      v(4) = vvx
*  fix long-range behavior of PE curve as c6/r^6 from last point
      if (r.gt.rr(npts)) then
        c6 = v4sigm(npts) * rr(npts)**6
        v(4) = c6 / r**6
      endif
*
*  IN THIS VERSION, SET SPIN-ORBIT MATRIX ELEMENTS TO THEIR
*  ASYMPTOTIC VALUES AT ALL R
      a = 382.4d0
      apar = a / 2.0d0
      aperp = a / 2.0d0
      v(5) = apar
      v(6) = aperp
*
      call dcopy(6,v,1,vvl,1)
* convert to hartree
      econv=1.d0/219474.6d0
      call dscal(6,econv,vvl,1)
      return
      end
*===================================eof====================================
